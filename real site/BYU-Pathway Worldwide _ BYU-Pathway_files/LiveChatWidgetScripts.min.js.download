/* LiveChatInitializer.min.js:start */
var __awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=u[e[0]&2?"return":e[0]?"throw":"next"])&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[0,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Microsoft;(function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.logEvent=function(t,i){switch(t){case n.LogLevel.DEBUG:n.TelemetryClient.debug(i,n.ScenarioType.ACS_ADAPTER);break;case n.LogLevel.WARN:n.TelemetryClient.warn(i,n.ScenarioType.ACS_ADAPTER);break;case n.LogLevel.ERROR:n.TelemetryClient.error(i,n.ScenarioType.ACS_ADAPTER);break;case n.LogLevel.INFO:default:n.TelemetryClient.info(i,n.ScenarioType.ACS_ADAPTER)}},t}();n.ACSAdapterLogger=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))})(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.isInternetConnected=function(){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,$.get({url:n.ScriptPaths.getInternetConnectivityTestFile(),cache:!1})];case 1:return(t=r.sent(),t===n.Constants.internetConnectionTestUrlText)?[2,!0]:[3,3];case 2:return i=r.sent(),[3,3];case 3:return[2,!1]}})})},t}();n.ConnectivityManager=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.configRequestIds=[];this.getChatTokenRequestIds=[];this.getChatTranscriptRequestIds=[];this.sendEmailTranscriptRequestIds=[];this.sessionInitRequestIds=[];this.sessionCloseRequestIds=[];this.submitPostChatRequestIds=[];this.secondaryChannelEventRequestInfos=[]}return t.prototype.setRuntimeId=function(n){this.runtimeId=n},t.prototype.addConfigRequestId=function(n){this.configRequestIds.push(n)},t.prototype.addGetChatTokenRequestId=function(n){this.getChatTokenRequestIds.push(n)},t.prototype.addGetChatTranscriptRequestId=function(n){this.getChatTranscriptRequestIds.push(n)},t.prototype.addSendEmailTranscriptRequestId=function(n){this.sendEmailTranscriptRequestIds.push(n)},t.prototype.addSessionInitRequestId=function(n){this.sessionInitRequestIds.push(n)},t.prototype.addSessionCloseRequestId=function(n){this.sessionCloseRequestIds.push(n)},t.prototype.addSubmitPostChatRequestId=function(n){this.submitPostChatRequestIds.push(n)},t.prototype.setWebChatVersion=function(n){this.webChatVersion=n},t.prototype.setIc3SdkVersion=function(n){this.ic3SdkVersion=n},t.prototype.setOcSdkVersion=function(n){this.ocSdkVersion=n},t.prototype.setWidgetState=function(n){this.widgetState=n},t.prototype.addSecondaryChannelEventRequestId=function(n){this.secondaryChannelEventRequestInfos.push(n)},t.prototype.setDebugButtonDisplay=function(t){var i,r;t===void 0&&(t=!1);i=n.Util.getDebugButton();n.Util.isNullOrUndefined(i)||(r=this.getDebugMode(t),i.style.display=r?"flex":"none")},t.prototype.getDebugMode=function(t){var i,r,u;return t===void 0&&(t=!1),i=t?!0:n.ConfigurationManager.IsDebugMode,r=n.Util.getDebugModeFromScript(),n.Util.isNullOrUndefined(r)||(i=r),u=n.Util.getDebugModeFromUrl(),n.Util.isNullOrUndefined(u)||(i=u),i},t.prototype.getDebugText=function(){this.debugText||(this.debugText=document.createElement("div"),this.debugText.className=n.Constants.HTMLConstants.debugText,document.body.appendChild(this.debugText));var t="";this.runtimeId&&(t="Run Time Id: "+this.runtimeId+" \n");this.configRequestIds&&this.configRequestIds.length>0&&(t+="Config request Id: "+this.getChatTokenRequestIds+" \n");this.getChatTokenRequestIds&&this.getChatTokenRequestIds.length>0&&(t+="Chat token request Id: "+this.getChatTokenRequestIds+" \n");this.sessionInitRequestIds&&this.sessionInitRequestIds.length>0&&(t+="Session init request Id: "+this.sessionInitRequestIds+" \n");this.sessionCloseRequestIds&&this.sessionCloseRequestIds.length>0&&(t+="Session close request Id: "+this.sessionCloseRequestIds+" \n");this.webChatVersion&&(t+="Web Chat Version: "+this.webChatVersion+" \n");this.ocSdkVersion&&(t+="OC SDK Version: "+this.ocSdkVersion+" \n");this.debugText.innerText=t;this.debugButton.innerText="Refresh"},t.prototype.getDebugButton=function(){return this.debugButton||(this.debugButton=document.createElement("div"),this.debugButton.className=n.Constants.HTMLConstants.debugButton,this.debugButton.innerText=n.Constants.LCWDebugInfo,this.debugButton.onclick=this.getDebugText.bind(this)),this.debugButton},t.prototype.addDebugButtonIfNotPresent=function(t){t===void 0&&(t=!1);this.getDebugMode(t)&&(n.Util.isNullOrUndefined(document.body)?document.addEventListener(n.Constants.HTMLConstants.DOMContentLoaded,function(){document.body.appendChild(this.getDebugButton())}):document.body.appendChild(this.getDebugButton()))},t}();n.DebugInformation=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.PersistData=function(n,t,i){var r=JSON.stringify(i);n.setItem(t,r)},n.GetData=function(n,t){var i=n.getItem(t);return JSON.parse(i)},n.RemoveData=function(n,t){n.removeItem(t)},n}();n.BrowserDataStore=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.checkStorageAvailability=function(){try{sessionStorage;localStorage}catch(t){console.error("Third-party cookies must be allowed to access Live Chat");n.LCWErrorTypes.raiseErrorEventNoStorageClean(n.LCWErrorCode.LCW_CHAT_WIDGET_SCRIPT_FAILED_TO_LOAD,t);$j.getJSON(n.ScriptPaths.LiveChatWidgetConfigPath,function(i){n.ConfigurationManager.AriaTelemetryKey=i.ariaTelemetryKey;n.TelemetryClient.error({Event:n.TelemetryEvent.ThirdPartyCookiesBlocked,ExeceptionDetails:t})})}},t.PersistData=function(i,r,u,f){var e=t.getDataStoreFromContext(i,r),o=t.getStoreKey(r,i),s=t.addTTLToData(u,f);n.BrowserDataStore.PersistData(e,o,s)},t.GetData=function(i,r){var f=t.getDataStoreFromContext(i,r),e=t.getStoreKey(r,i),u=n.BrowserDataStore.GetData(f,e);return t.isDataValid(u)?t.extractData(u):(t.RemoveData(i,r),undefined)},t.RemoveData=function(i,r){n.BrowserDataStore.RemoveData(t.getDataStoreFromContext(i,r),t.getStoreKey(r,i))},t.UpdateDataTTL=function(i,r,u){var e=t.getDataStoreFromContext(i,r),o=t.getStoreKey(r,i),f=n.BrowserDataStore.GetData(e,o);return n.Util.isNullOrUndefined(f)?!1:t.UpdateData(i,r,f.data,u)},t.UpdateData=function(i,r,u,f){var o=!1,s=t.getDataStoreFromContext(i,r),h=t.getStoreKey(r,i),c=n.BrowserDataStore.GetData(s,h),e;return n.Util.isNullOrUndefined(c)||(e={data:u,ttl:c.ttl},n.Util.isNullOrUndefined(f)||(e=t.addTTLToData(e.data,f)),n.BrowserDataStore.PersistData(s,h,e),o=!0),o},t.UpsertData=function(n,i,r,u){var f=t.UpdateData(n,i,r,u);f===!1&&t.PersistData(n,i,r,u)},t.getStoreKey=function(t,i){var r="",u,f,e,o;return i&n.DataContextType.EnvironmentContext&&(u=n.Bootstrapper.environmentVersion,!n.Util.isNullOrUndefined(u)&&u.length>0&&(r+=u+n.Constants.WidgetDataStoreKeySeparator)),i&n.DataContextType.OrganizationContext&&(f=n.Bootstrapper.orgId,!n.Util.isNullOrUndefined(f)&&f.length>0&&(r+=f+n.Constants.WidgetDataStoreKeySeparator)),i&n.DataContextType.WidgetContext&&(e=n.Bootstrapper.widgetId,!n.Util.isNullOrUndefined(e)&&e.length>0&&(r+=e+n.Constants.WidgetDataStoreKeySeparator)),i&n.DataContextType.UserContext&&(o=n.Bootstrapper.jwtSubId,!n.Util.isNullOrUndefined(o)&&o.length>0&&(r+=o+n.Constants.UserDataStoreKeySeparator)),r+t},t.getDataStoreFromContext=function(i,r){return t.checkStorageAvailability(),(i&n.DataContextType.UserContext||r===n.WidgetDataKeys.OngoingChat)&&n.Util.canStoreDataInLocalStorage()?localStorage:sessionStorage},t.addTTLToData=function(t,i){var r=n.Constants.InfiniteTTLForStorage;return i===n.Constants.InfiniteTTLForStorage||n.Util.isNullOrUndefined(i)||(r=(new Date).getTime()+i),{data:t,ttl:r}},t.extractData=function(t){return n.Util.isNullOrUndefined(t)?undefined:t.data},t.isDataValid=function(t){if(n.Util.isNullOrUndefined(t)||t.ttl===n.Constants.InfiniteTTLForStorage)return!0;var i=(new Date).getTime();return i<t.ttl},t}();n.ContextSpecificDataStore=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t,i;(function(n){n[n.Script=0]="Script";n[n.StyleSheet=1]="StyleSheet"})(t=n.ResourceType||(n.ResourceType={}));i=function(){function i(n){this.counter=0;this.resources=n}return i.prototype.loadResources=function(){var r=this,t,u;n.Util.isNullOrUndefined(this.resources)||this.counter>=this.resources.length||(t=!0,this.resources[this.counter]&&this.resources[this.counter].preload&&(t=this.resources[this.counter].preload()),t?(u=function(){r.executeCurrentCallback(t);r.counter++;r.loadResources()},i.LoadResource(this.resources[this.counter],u)):(this.executeCurrentCallback(t),this.counter++,this.loadResources()))},i.prototype.executeCurrentCallback=function(t){if(this.resources[this.counter].callback)try{this.resources[this.counter].callback(t)}catch(i){n.TelemetryClient.error({Event:n.TelemetryEvent.ResourceLoadFailed,ExceptionDetails:i,ResourcePath:this.resources[this.counter].path})}},i.CreateResource=function(i,r,u){var o=null,a=function(t){n.TelemetryClient.error({Event:n.TelemetryEvent.ResourceLoadFailed,ExceptionDetails:t,ResourcePath:r.path})},v=function(){n.TelemetryClient.debug({Event:n.TelemetryEvent.ResourceLoaded,ResourcePath:r.path});u()},e,f,s,c,h,l;switch(r.resourceType){case t.Script:e=document.createElement("script");e.src=r.path;e.type="text/javascript";e.onload=v;e.onerror=a;o=e;break;case t.StyleSheet:f=document.createElement("link");f.href=r.path;f.rel="stylesheet";f.type="text/css";f.onload=v;f.onerror=a;o=f}if(o.id=i,!n.Util.isNullOrUndefined(r.resourceMetadata)&&!n.Util.isNullOrUndefined(r.resourceMetadata.dataAttributes))for(s=0,c=Object.keys(r.resourceMetadata.dataAttributes);s<c.length;s++)h=c[s],r.resourceMetadata.dataAttributes.hasOwnProperty(h)&&(l=r.resourceMetadata.dataAttributes[h],n.Util.isPrimitiveString(l)&&(o.dataset[h]=l));return o},i.LogResourceLoadEvent=function(t,i){n.TelemetryClient.info({Event:n.TelemetryEvent.ResourceLoaded,ResourcePath:t.path,ElapsedTimeInMilliseconds:i})},i.LoadResource=function(t,r){var u=t.path;if(n.Util.isNullOrUndefined(t.resourceMetadata)||n.Util.isNullOrUndefined(t.resourceMetadata.id)||(u=t.resourceMetadata.id),t.forceLoad||!document.getElementById(u)){var e=n.Util.timer(),o=function(){i.LogResourceLoadEvent(t,e.milliSecondsElapsed);r()},f=i.CreateResource(u,t,o);try{document.getElementsByTagName("head")[0].appendChild(f)}catch(h){document.getElementsByTagName("body")[0].appendChild(f)}}else{n.TelemetryClient.debug({Event:n.TelemetryEvent.ResourceLoaded,ResourcePath:t.path});try{r()}catch(s){n.TelemetryClient.error({Event:n.TelemetryEvent.ResourceLoadFailed,ResourcePath:t.path,ExceptionDetails:s})}}},i.Load=function(n){var t=new i(n);t.loadResources()},i}();n.ResourceLoader=i})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b;(function(n){n.Bridged="bridged";n.Unbridged="unbridged"})(t=n.DeliveryMode||(n.DeliveryMode={})),function(n){n.IE="IE";n.CHROME="Chrome";n.FIREFOX="Firefox";n.SAFARI="Safari";n.EDGE="Edge";n.EDGE_CHROMIUM="Edg";n.OPERA="Opera";n.UNKNOWN="Unknown"}(i=n.BrowserVendor||(n.BrowserVendor={})),function(n){n[n.Chrome=0]="Chrome";n[n.Firefox=1]="Firefox";n[n.Ie=2]="Ie";n[n.Edge=3]="Edge";n[n.Safari=4]="Safari";n[n.None=5]="None"}(r=n.Browser||(n.Browser={})),function(n){n.Desktop="Desktop";n.Mobile="Mobile";n.Tablet="Tablet"}(u=n.DeviceType||(n.DeviceType={})),function(n){n.WINDOWS="Windows";n.MACOSX="Mac OS X";n.WINDOWS_PHONE="Windows Phone";n.WINDOWS_RT="Windows RT";n.IOS="iOS";n.ANDROID="Android";n.LINUX="Linux";n.UNKNOWN="Unknown"}(f=n.OperatingSystem||(n.OperatingSystem={})),function(n){n.prod="prod";n.dogfood="df";n.int="int";n.test="test"}(e=n.EnvironmentVersion||(n.EnvironmentVersion={})),function(n){n[n.None=0]="None";n[n.UserContext=1]="UserContext";n[n.WidgetContext=2]="WidgetContext";n[n.OrganizationContext=4]="OrganizationContext";n[n.EnvironmentContext=8]="EnvironmentContext"}(o=n.DataContextType||(n.DataContextType={})),function(n){n.ConversationData="conversationData";n.ConfigData="configData";n.SystemConfigurationData="SystemConfigurationData";n.PreChatResponse="PreChatResponseData";n.OngoingChat="OngoingChat"}(s=n.WidgetDataKeys||(n.WidgetDataKeys={})),function(n){n[n.SessionInitNotStarted=0]="SessionInitNotStarted";n[n.SessionInitStarted=1]="SessionInitStarted";n[n.SessionInitComplete=2]="SessionInitComplete"}(h=n.SessionInitState||(n.SessionInitState={})),function(n){n[n.Voice=19237e4]="Voice";n[n.Video=19238e4]="Video";n[n.Cobrowse=19239e4]="Cobrowse"}(c=n.SecondaryChannelType||(n.SecondaryChannelType={})),function(n){n[n.Minimized=0]="Minimized";n[n.Maximized=1]="Maximized";n[n.Closed=2]="Closed";n[n.PopOutWindow=3]="PopOutWindow"}(l=n.WidgetState||(n.WidgetState={})),function(n){n[n.Prechat=0]="Prechat";n[n.Postchat=1]="Postchat";n[n.ChatReconnect=2]="ChatReconnect"}(a=n.SurveyType||(n.SurveyType={})),function(n){n[n.ConfigRequest=0]="ConfigRequest";n[n.GetChatTokenRequest=1]="GetChatTokenRequest";n[n.GetChatTranscriptRequest=2]="GetChatTranscriptRequest";n[n.SendEmailTranscriptRequest=3]="SendEmailTranscriptRequest";n[n.SessionInitRequest=4]="SessionInitRequest";n[n.SessionCloseRequest=5]="SessionCloseRequest";n[n.SubmitPostChatRequest=6]="SubmitPostChatRequest";n[n.SecondaryChannelEventRequest=7]="SecondaryChannelEventRequest"}(v=n.RequestType||(n.RequestType={})),function(n){n[n.Typing=0]="Typing";n[n.ClearTyping=1]="ClearTyping"}(y=n.BotMessageType||(n.BotMessageType={})),function(n){n[n.WidgetUseOutsideOperatingHour=705]="WidgetUseOutsideOperatingHour"}(p=n.OmnichannelErrorCodes||(n.OmnichannelErrorCodes={})),function(n){n.NoCalling="NoCalling";n.VideoAndVoiceCalling="VideoAndVoiceCalling";n.VoiceOnly="VoiceOnly"}(w=n.CallingOptions||(n.CallingOptions={})),function(n){n[n.NoCalling=19235e4]="NoCalling";n[n.VideoAndVoiceCalling=192350001]="VideoAndVoiceCalling";n[n.VoiceOnly=192350002]="VoiceOnly"}(b=n.CallingOptionsOptionSetNumber||(n.CallingOptionsOptionSetNumber={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var g=function(){function n(){}return n}(),t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d;n.LiveChatConfig=g;t=function(){function n(){}return n}();n.LiveChatContext=t;i=function(){function n(n,t){this.OptionSetSelectedValue=n;this.OptionSetConfigValue=t}return n}();n.WidgetOptionSetMapping=i;r=function(){function n(n,t){this.CallingOptionSetSelectedValue=n;this.CallingOptionSetConfigValue=t}return n}();n.WidgetCallingOptionSetMapping=r;u=function(){function t(){this.sessionInitState=n.SessionInitState.SessionInitNotStarted}return t}();n.Conversation=u;f=function(){function n(){}return n}();n.Token=f;e=function(){function n(){}return n}();n.VoiceVideoCallToken=e;o=function(){function n(){}return n}();n.AttachmentConfiguration=o;s=function(){function n(){}return n}();n.FetchChatTokenResponse=s;h=function(){function n(){}return n}();n.FetchChatTranscriptResponse=h;c=function(){function t(){}return Object.defineProperty(t.prototype,"portalcontactid",{get:function(){return this.fetchPortalContactId()},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return n.Util.toJSONWithGetters(this)},t}();n.InitContext=c;l=function(){function n(){}return n}();n.EmailRequestBody=l;a=function(){function n(){}return n}();n.Location=a;v=function(){function n(){}return n}();n.LiveChatWidgetLocation=v;y=function(){function n(){}return n.LCWReadyEvent="lcw:ready",n.LCWStartChatEvent="lcw:startChat",n.LCWCloseChatEvent="lcw:closeChat",n.LCWThreadUpdateEvent="lcw:threadUpdate",n.LCWOnEndConversationEvent="lcw:onEndConversation",n.LCWErrorEvent="lcw:error",n.LCWChangeTitle="changeTitle",n.LCWOnMinimizedEvent="lcw:onMinimize",n.LCWOnClosedEvent="lcw:onClose",n.LCWOnPopoutClose="lcw:onPopoutClose",n.LCWOnMaximizedEvent="lcw:onMaximize",n.LCWOnMessageReceived="lcw:onMessageReceived",n.LCWOnPopoutMessageReceived="lcw:onPopoutMessageReceived",n.LCWOnMessageSent="lcw:onMessageSent",n.LCWOnPopoutMessageSent="lcw:onPopoutMessageSent",n.LCWPlayAudioNotification="playAudioNotification",n.LCWOnGetQueueAvailabilityEvent="lcw:getQueueAvailability",n.LCWChatQueued="lcw:chatQueued",n.LCWChatRetrieved="lcw:chatRetrieved",n}();n.LCWEvents=y;p=function(){function t(){}return t.getBotMessage=function(t){switch(t){case n.BotMessageType.Typing:return{isTyping:!0};default:return null}},t}();n.BotMessageFactory=p;w=function(){function n(){}return n}();n.DataMaskingRule=w;b=function(){function n(){}return n}();n.ProactiveChatNotificationConfig=b;k=function(){function n(){}return n}();n.SecondaryChannelEventBody=k;d=function(){function n(){}return n.authTokenRequest="authTokenRequest",n.authTokenResponse="authTokenResponse",n.redirectPageRequest="redirectPageRequest",n.startPopoutChatResponse="startPopoutChatResponse",n.closePopoutChatMessage="closePopoutChatMessage",n.portalContactIdRequest="portalContactIdRequest",n.portalContactIdResponse="portalContactIdResponse",n.initContextParamsRequest="initContextParamsRequest",n.initContextParamsResponse="initContextParamsResponse",n}();n.IframeMessages=d})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var s=function(){function t(){}return t.LiveChatScriptId="Microsoft_Omnichannel_LCWidget",t.DisableTelemetryAttributeName="data-disable-telemetry",t.AppIdAttributeName="data-app-id",t.OrgIdAttributeName="data-org-id",t.OrgUrlAttributeName="data-org-url",t.HostNameAttributeName="hostname",t.ReconnectIdAttributeName="oc.reconnectid",t.OpenChatInPopOutWindowAttributeName="data-open-in-window",t.EnableNewLineMarkdownSupport="data-enable-newline",t.EnableMakrdownMessageFormatting="data-enable-markdown",t.SuggestedActionLayout="data-suggested-action-layout",t.SrcUrlAttributeName="src",t.IdAttributeName="id",t.EnvironmentVersionAttributeName="data-lcw-version",t.LiveChatWidgetHideChatButton="data-hide-chat-button",t.LiveChatWidgetHideMinimizeButton="data-hide-minimize-button",t.LiveChatWidgetEnableCustomCloseButtonText="data-custom-close-button-text",t.EnableAutofill="data-enable-lcw-autofill",t.BypassCache="data-bypass-cache",t.RenderOnMobileDevice="data-render-mobile",t.WidgetFontFamily="data-font-family-override",t.WidgetColorOverride="data-color-override",t.DebugModeAttributeName="data-lcw-debug",t.DefaultFileAttachmentName="Untitled.txt",t.CustomerDialogColor="#E8E8E8",t.CustomerFontColor="black",t.AgentDialogColor="#2266E3",t.AgentFontColor="white",t.ChannelId="lcw",t.LiveChatWidget="LiveChatWidget",t.CustomerTag="FromCustomer",t.TelemetryPrefix="LCW",t.LocalStorageTestKey="Microsoft.Omnichannel.LiveChatWidget.LocalStorageTestKey",t.URLDelimiter="&",t.EndURLSeparator="?",t.ChatHTMLPath="/htmls/chat.html",t.Equal="=",t.TruePascal="True",t.True="true",t.False="false",t.UserDataStoreKeySeparator="_",t.WidgetDataStoreKeySeparator="_",t.InfiniteTTLForStorage=-1,t.ScriptUnminifiedExtension=".js",t.JsonUnminifiedExtension=".json",t.ScriptMinifiedExtension=".min.js",t.CssUnminifiedExtension=".css",t.CssMinifiedExtension=".min.css",t.GifContentType="image/gif",t.DefaultLocale="en-us",t.DefaultLocaleLCID="1033",t.LocaleFile="locales/",t.UserMessageTag="user",t.SystemMessageTag="system",t.AgentEndConversationMessageTag="agentendconversation",t.HistoryMessageTag="history",t.QueuePositionMessageTag="queueposition",t.AverageWaitTimeMessageTag="averagewaittime",t.AdaptiveCardType="adaptivecard",t.InternalMode="internal",t.Microsoft="Microsoft",t.Omnichannel="Omnichannel",t.BotFramework="BotFramework",t.WebChat="WebChat",t.React="React",t.LCWDebugInfo="LCW Debug Info",t.Loader="Loader",t.Dynamic365="Dynamic365",t.Undefined="undefined",t.Portal="Portal",t.ContactId="contactId",t.User="User",t.String="string",t.ChatMessagesJson="chatMessagesJson",t.DotNet=".NET",t.IC3Adapter="IC3Adapter",t.ChatAdapter="ChatAdapter",t.LiveChatV1=1,t.LiveChatV2=2,t.Markdown="markdown",t.ActionType="actionType",t.MarkdownIt="markdownit",t.MarkdownItForInline="markdownitForInline",t.SlackMarkdownIt="slack-markdown-it",t.Zero="zero",t.Default="default",t.ProactiveChatInviteTimeout=6e4,t.GuidPattern="xx-x-4m-ym-xxx",t.DataMaskingMiddlewareId="DataMasking",t.MaxMessageSizeMiddlewareId="MaxMessageSize",t.HTMLTextMiddlewareId="HTMLText",t.ConversationEndMiddlewareId="ConversationEnd",t.ChannelDataMiddlewareId="ChannelData",t.AttachmentUploadValidatorMiddlewareId="PostActivityValidator",t.SanitizationMiddlewareId="Sanitization",t.GifUploadMiddlewareId="GifUpload",t.WebChatDailyBuildFlag="daily",t.WebChatLocalBuildFlag="local",t.Meta="meta",t.Viewport="viewport",t.ScaleFordevice="width=device-width, initial-scale=1",t.WebChatIEPolyfillsScript="ie11_polyfills.js",t.WebChatIEPolyfillsScriptFullPath="../scripts/"+t.WebChatIEPolyfillsScript,t.Target="target",t.Blank="_blank",t.TargetRelationship="rel",t.TargetRelationshipAttributes="noopener noreferrer",t.SpanAttributeName="span",t.CustomerDisplayName="Customer",t.DefaultUserId="teamsvisitor",t.Style="style",t.TextCss="text/css",t.MSLiveChatWidget="MSLiveChatWidget",t.PersistentChatConversationMode="192350001",t.AttachmentProcessingMiddlewareId="AttachmentProcessing",t.AudioNotificationPath="../audios/new-message-notification.mp3",t.AttachmentFileNameAttribute="fileName",t.Date="date",t.AuthFunctionTimeout=1e4,t.AuthFunctionFailureString="Failed to find method in outer scope within timeout",t.AuthTokenExpiryBufferTimeInSeconds=10,t.msfpEmbedScript='<script src="../lib/Embed.min.js" type="text/javascript"><\/script><link rel="stylesheet" type="text/css" href="https://mfpembedcdnwus2.azureedge.net/mfpembedcontwus2/Embed.css" /><script type = "text/javascript" >function renderSurvey(parentElementId,surveyurl,FirstName, LastName, locale){var se = new SurveyEmbed(surveyurl,"https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/","true");var context = {"First Name": FirstName,"Last Name": LastName,"locale": locale,"showmultilingual":"false"};se.renderInline(parentElementId, context);}<\/script>',t.postChatSurveyIdentifierPlacement="##SurveyIdentifier##",t.formsProEmbedSurveyLoadTime=300,t.postChatRenderTimeOnThreadUpdate=500,t.invalidMsfpEmbedScriptException="invalid msfpEmbedScript value",t.CloseCalling="closeCalling",t.ElevateToVoiceVideo="ElevateToVoiceVideo",t.CallAdded="callAdded",t.LocalVideoStreamAdded="localVideoStreamAdded",t.LocalVideoStreamRemoved="localVideoStreamRemoved",t.RemoteVideoStreamAdded="remoteVideoStreamAdded",t.RemoteVideoStreamRemoved="remoteVideoStreamRemoved",t.CallDisconnected="callDisconnected",t.ParticipantDisconnected="participantDisconnected",t.IncomingCallEnded="incomingCallEnded",t.Mute="mute",t.SelfVideo="selfVideo",t.RemoteVideo="remoteVideo",t.resizeEvent="resize",t.unloadEvent="unload",t.beforeunloadEvent="beforeunload",t.urlRegex=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/gi,t.SystemConfigExpiryTimeForStorage=9e5,t.CacheRefreshTimerGracePeriod=.9,t.supportedLocales=["ar-sa","bg-bg","ca-es","cs-cz","da-dk","de-de","el-gr","en-us","es-es","et-ee","eu-es","fi-fi","fr-fr","gl-es","he-il","hi-in","hr-hr","hu-hu","id-id","it-it","ja-jp","kk-kz","ko-kr","lt-lt","lv-lv","ms-my","nb-no","nl-nl","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sr-cyrl-cs","sr-latn-cs","sv-se","th-th","tr-tr","uk-ua","vi-vn","zh-cn","zh-hk","zh-tw"],t.OptionSetMapping=[new n.WidgetOptionSetMapping("19236001","#BF0900"),new n.WidgetOptionSetMapping("192360017","#00818A"),new n.WidgetOptionSetMapping("19236002","#315FA2"),new n.WidgetOptionSetMapping("19236003","#358717"),new n.WidgetOptionSetMapping("19236004","#000000"),new n.WidgetOptionSetMapping("192350001","#D24204"),new n.WidgetOptionSetMapping("192350002","#AD5889"),new n.WidgetOptionSetMapping("192350003","#767676"),new n.WidgetOptionSetMapping("192350004","#6A1E7A"),new n.WidgetOptionSetMapping("192350005","#927200"),new n.WidgetOptionSetMapping("192350006","#A42B1A"),new n.WidgetOptionSetMapping("192350007","#691B88"),new n.WidgetOptionSetMapping("1025","ar-sa"),new n.WidgetOptionSetMapping("1026","bg-bg"),new n.WidgetOptionSetMapping("1027","ca-es"),new n.WidgetOptionSetMapping("1029","cs-cz"),new n.WidgetOptionSetMapping("1030","da-dk"),new n.WidgetOptionSetMapping("1031","de-de"),new n.WidgetOptionSetMapping("1032","el-gr"),new n.WidgetOptionSetMapping("1033","en-us"),new n.WidgetOptionSetMapping("3082","es-es"),new n.WidgetOptionSetMapping("1061","et-ee"),new n.WidgetOptionSetMapping("1069","eu-es"),new n.WidgetOptionSetMapping("1035","fi-fi"),new n.WidgetOptionSetMapping("1036","fr-fr"),new n.WidgetOptionSetMapping("1110","gl-es"),new n.WidgetOptionSetMapping("1037","he-il"),new n.WidgetOptionSetMapping("1081","hi-in"),new n.WidgetOptionSetMapping("1050","hr-hr"),new n.WidgetOptionSetMapping("1038","hu-hu"),new n.WidgetOptionSetMapping("1057","id-id"),new n.WidgetOptionSetMapping("1040","it-it"),new n.WidgetOptionSetMapping("1041","ja-jp"),new n.WidgetOptionSetMapping("1087","kk-kz"),new n.WidgetOptionSetMapping("1042","ko-kr"),new n.WidgetOptionSetMapping("1063","lt-lt"),new n.WidgetOptionSetMapping("1062","lv-lv"),new n.WidgetOptionSetMapping("1086","ms-my"),new n.WidgetOptionSetMapping("1044","nb-no"),new n.WidgetOptionSetMapping("1043","nl-nl"),new n.WidgetOptionSetMapping("1045","pl-pl"),new n.WidgetOptionSetMapping("1046","pt-br"),new n.WidgetOptionSetMapping("2070","pt-pt"),new n.WidgetOptionSetMapping("1048","ro-ro"),new n.WidgetOptionSetMapping("1049","ru-ru"),new n.WidgetOptionSetMapping("1051","sk-sk"),new n.WidgetOptionSetMapping("1060","sl-si"),new n.WidgetOptionSetMapping("3098","sr-cyrl-cs"),new n.WidgetOptionSetMapping("2074","sr-latn-cs"),new n.WidgetOptionSetMapping("1053","sv-se"),new n.WidgetOptionSetMapping("1054","th-th"),new n.WidgetOptionSetMapping("1055","tr-tr"),new n.WidgetOptionSetMapping("1058","uk-ua"),new n.WidgetOptionSetMapping("1066","vi-vn"),new n.WidgetOptionSetMapping("2052","zh-cn"),new n.WidgetOptionSetMapping("3076","zh-hk"),new n.WidgetOptionSetMapping("1028","zh-tw"),new n.WidgetOptionSetMapping("192236011","BottomLeft"),new n.WidgetOptionSetMapping("192236010","BottomRight")],t.CallingOptionSetMapping=[new n.WidgetCallingOptionSetMapping("192350000","NoCalling"),new n.WidgetCallingOptionSetMapping("192350001","VideoAndVoiceCalling"),new n.WidgetCallingOptionSetMapping("192350002","VoiceOnly"),],t.MessageTypes=(u=function(){function n(){}return n}(),u.USER="UserMessage",u.SWIFT="SwiftCard",u.SYSTEM="SystemMessage",u.WELCOME="Welcome",u.TRANSLATE="Translate",u.IMAGE="LwcImage",u.FILE="LwcFile",u.ADAPTIVECARD="card",u.THREAD="Thread",u),t.VisibilityEventTypes=(h=function(){function n(){}return n}(),h.Minimize="collapse",h.Close="hide",h.Maximize="expand",h.Show="show",h),t.KeyCodes=(r=function(){function n(){}return n}(),r.KEY_TAB=9,r.KEY_ESC=27,r.KEY_ENTER=13,r.KEY_SPACE=32,r.KEY_ARROW_LEFT=37,r.KEY_ARROW_RIGHT=39,r.KEY_SLASH=191,r.KEY_A=65,r.KEY_S=83,r.KEY_D=68,r.KEY_U=85,r.KEY_C=67,r.KEY_M=77,r.KEY_O=79,r.KEY_F=70,r.KEY_F5=116,r.KEY_R=82,r),t.ChatButtonInitStyle=(f=function(){function n(){}return n}(),f.leftString="left",f.rightString="right",f.position="fixed",f.bottomPosition="0px",f.leftPosition="0px",f.rightPosition="0px",f.bottomLeftPosition="BottomLeft",f.bottomRightPosition="BottomRight",f.cursor="pointer",f),t.HTMLConstants=(i=function(){function n(){}return n}(),i.div="div",i.body="body",i.debugText="oclcw-debug-text",i.debugButton="oclcw-debug-button",i.DOMContentLoaded="DOMContentLoaded",i.CustomEvent="CustomEvent",i.arialiveRegion="oclcw-arialive-region",i.visuallyHidden="oclcw-visually-hidden",i.ariaLive="aria-live",i.assertive="assertive",i.role="role",i.alert="alert",i.error="error",i.chat="chat",i.none="none",i.block="block",i.star="star",i.selectOnMouseDown="onmousedown",i.selectOnChange="onchange",i.selectOnBlur="onblur",i.selectSize="size",i.preChatMaxDropdownSize="10",i),t.IFrameConstants=(o=function(){function n(){}return n}(),o.defaultWidth=360,o.defaultHeight=560,o.sidePosition=20,o.bottomPosition=20,o.frameEdgeBuffer=5,o),t.PopOutChatConstants=(e=function(){function n(){}return n}(),e.isPopOutModeAttributeName="is-popout-mode",e.isPopOutModeAttributeValue="true",e.isCustomPopOutModeAttributeName="is-custom-popout-mode",e.isCustomPopOutModeAttributeValue="true",e.popoutWindowBlankHref="about:blank",e.target="Omnichannel Chat",e.location=0,e),t.AttachmentIconStyle=(s=function(){function n(){}return n}(),s.iconSize=12,s.defaultPadding="0 0 0 10px",s.imagePadding="8px 0 2px 8px",s.RTLDefaultPadding="0 10px 0 0",s.RTLImagePadding="8px 8px 2px 0",s),t.UnreadMessagesNotificationConstants=(c=function(){function n(){}return n}(),c.maxValue=99,c),t.supportedAdaptiveCardContentTypes=["application/vnd.microsoft.card.adaptive","application/vnd.microsoft.card.audio","application/vnd.microsoft.card.hero","application/vnd.microsoft.card.receipt","application/vnd.microsoft.card.thumbnail","application/vnd.microsoft.card.signin","application/vnd.microsoft.card.oauth",],t.internetConnectionTestUrl="public/connecttest.txt",t.internetConnectionTestUrlText="Omnichannel Connect Test",t;var u,h,r,f,i,o,e,s,c}(),t,i,r,u,f,e,o;n.Constants=s;t=function(){function n(){}return n.DefaultButtonsMarginTop="21px",n.ErrorConditionButtonsMarginTop="1px",n.EnabledSendButtonTextColor="#FFFFFF",n.DisabledSendButtonBackgroundColor="#F3F2F1",n.DisabledSendButtonTextColor="#A19F9D",n.ErrorConditionDefaultColor="#A4262C",n.DefaultTextAreaBorderColor="#8A8886",n.ChatTranscriptDownloadFile="ChatTranscripts.html",n.ChatTranscriptsBodyColor="#F5F5F5",n.TranscriptMessageEmojiMessageType="http://schema.skype.com/emoji",n.EmailRegex="(?:[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-zA-Z0-9-]*[a-zA-Z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])",n.DummyDomains="^[0 - 9p{ L }][0 - 9p{ L }-.]{ 1, 61 }[0 - 9p{ L }].[0 - 9p{ L }][p{ L } -]* [0 - 9p{ L }] + $",n.RegExForBaseUrl=/.*\/\/[^\/]+\//,n.Giu="giu",n}();n.TranscriptConstants=t;i=function(){function n(){}return n.UnknownFileType="application/octet-stream",n}();n.MimeTypes=i;r=function(){function n(){}return n.LTR="ltr",n.RTL="rtl",n}();n.TextDirection=r;u=function(){function n(){}return n.Embed="192350000",n.Link="192350001",n}();n.MSFPSurveyMode=u;f=function(){function t(){}return t.WidgetOrganization=n.DataContextType.WidgetContext|n.DataContextType.OrganizationContext,t.UserWidgetOrganization=n.DataContextType.UserContext|t.WidgetOrganization,t.EnvironmentWidgetOrganization=n.DataContextType.EnvironmentContext|t.WidgetOrganization,t}();n.DataContextTypes=f;e=function(){function n(){}return n.Status403Forbidden=403,n.Status413PayloadTooLarge=413,n}();n.HTTPErrorCodes=e;o=function(){function n(){}return n.User="User",n.Bot="Bot",n}();n.UserTypeToBeSurveyed=o})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.selectedLogLevels=function(n){var t=[];return n.forEach(function(n){t.push(n.toUpperCase())}),t},t.newGuid=function(){for(var r,u=n.Constants.GuidPattern,t="",i=0;i<u.length;i++){r=Math.floor(Math.random()*Date.now());switch(u[i]){case"x":t+=r.toString(16).substring(0,4);break;case"m":t+=r.toString(16).substring(0,3);break;case"y":t+=(r&3|8).toString(16);break;default:t+=u[i]}}return t},t.isNullOrEmptyString=function(n){return t.isNullOrUndefined(n)||n===""},t.isNullOrUndefinedOrEmptyArray=function(n){return t.isNullOrUndefined(n)||n.length===0},t.isNullOrUndefined=function(n){return n===null||n===undefined},t.isPrimitiveString=function(n){return typeof n=="string"},t.getCurrentUrl=function(){return window.location.href},t.getCurrentHost=function(){return window.location.hostname},t.getUtcDateString=function(n,t,i){var r=new Date(n.getTime()+n.getTimezoneOffset()*6e4);return t?i?r.toLocaleDateString(t,i):r.toLocaleDateString(t):r.toLocaleDateString()},t.getBaseUrl=function(n){var i=/.*\/\/[^\/]+\//.exec(n);if(!t.isNullOrUndefined(i))return i[0]},t.isRelativeUrl=function(n){return!(!t.isNullOrEmptyString(n)&&n.indexOf("://")>=0)},t.getDirectoryPathFromUrl=function(n){var t="",i=n.lastIndexOf("/");return i>=0&&(t=n.substring(0,i+1)),t},t.capitalizeString=function(n){if(!t.isNullOrUndefined(n)&&n!=="")return n.replace(/^\w/,function(n){return n.toUpperCase()})},t.isLoaderLoaded=function(){return t.isNullOrUndefined(window[n.Constants.Microsoft][n.Constants.Omnichannel][n.Constants.LiveChatWidget][n.Constants.Loader])?!1:!0},t.timer=function(){var n=(new Date).getTime();return{get milliSecondsElapsed(){return(new Date).getTime()-n}}},t.toJSONWithGetters=function(n){for(var t,i,r={},u=0,f=Object.keys(n);u<f.length;u++)t=f[u],i=n[t],i&&typeof i=="object"?r[t]=JSON.parse(JSON.stringify(n[t])):i!==undefined&&(r[t]=i);return r},t.canStoreDataInLocalStorage=function(){var t=n.Constants.LocalStorageTestKey;try{return localStorage.setItem(t,""),localStorage.removeItem(t),!0}catch(i){return!1}},t.transformLiveChatWidgetLocation=function(t){var i=new n.LiveChatWidgetLocation;return i.name=t.msdyn_name,i.location=t.msdyn_domainvalue,i},t.transformLiveChatWidgetLocations=function(n){var r,i;if(!t.isNullOrUndefined(n))for(r=new Array(n.length),i=0;i<n.length;i++)r[i]=t.transformLiveChatWidgetLocation(n[i]);return r},t.getDebugModeFromUrl=function(){var u=window.location.search.substring(1),i,n,r;if(!t.isNullOrUndefined(u))for(i=u.split("&"),n=0;n<i.length;n++)if(r=i[n].split("="),r[0].toLowerCase()==="debug")return r[1].toLowerCase()==="true"},t.getDebugModeFromScript=function(){var i=document.querySelector("script#"+n.Constants.LiveChatScriptId),t=i.getAttribute(n.Constants.DebugModeAttributeName);if(t&&t.trim().length!==0)return t.trim().toLowerCase()==="true"},t.getDebugButton=function(){var t=document.getElementsByClassName(n.Constants.HTMLConstants.debugButton);if(t&&t[0])return t[0]},t.getInitContextParamsForPopout=function(i,r){return __awaiter(this,void 0,void 0,function(){var u,f;return __generator(this,function(e){switch(e.label){case 0:return n.Bootstrapper.isPopOutMode?n.Bootstrapper.isCustomPopOutMode?window.opener?[4,t.getInitContextParamForPopoutFromOuterScope(window.opener,i,r)]:[3,2]:[3,4]:[3,8];case 1:return u=e.sent(),[3,3];case 2:u=null;e.label=3;case 3:return[2,u];case 4:return window.opener.parent?[4,t.getInitContextParamForPopoutFromOuterScope(window.opener.parent,i,r)]:[3,6];case 5:return f=e.sent(),[3,7];case 6:f=null;e.label=7;case 7:return[2,f];case 8:return[2]}})})},t.getInitContextParamForPopoutFromOuterScope=function(n,t,i){return __awaiter(this,void 0,void 0,function(){var u,f,e,r;return __generator(this,function(o){switch(o.label){case 0:return e=new Promise(function(n,t){f=n;setTimeout(function(){return t("Failed to find method in outer scope")},5e3)}).catch(function(n){return console.warn(n)}),r=function(n){n.data&&n.data.messageName==i&&(u=n.data.payload,f())},window.addEventListener("message",r,!1),n.postMessage({messageName:t},"*"),[4,e];case 1:return o.sent(),window.removeEventListener("message",r,!1),[2,u]}})})},t.createCustomEvent=function(i,r){var f=t.isNullOrUndefined(r)?undefined:{detail:r},u=null;try{u=new CustomEvent(i,f)}catch(e){u=document.createEvent(n.Constants.HTMLConstants.CustomEvent);u.initCustomEvent(i,!0,!0,f)}return u},t.raiseCustomEvent=function(n,i){var r=t.createCustomEvent(n,i);window.parent&&window.parent.postMessage({messageName:n,payload:i},"*");try{window.dispatchEvent(r)}catch(u){console.error("Failed to raise custom event: ",u)}},t.getCssResources=function(){return[{path:n.ScriptPaths.LiveChatWidgetAllStylePath,resourceType:n.ResourceType.StyleSheet}]},t.getPopOutWindowCssResources=function(){return[{path:n.ScriptPaths.LiveChatPopOutWindowStylePath,resourceType:n.ResourceType.StyleSheet}]},t.getLibResources=function(){return[{path:n.ScriptPaths.LiveChatWidgetLibsPath,resourceType:n.ResourceType.Script}]},t.setAriaLiveAlert=function(i){var r=document.getElementById(n.Constants.HTMLConstants.arialiveRegion);r||(r=document.createElement("div"),r.id=n.Constants.HTMLConstants.arialiveRegion,r.className=n.Constants.HTMLConstants.visuallyHidden,r.setAttribute(n.Constants.HTMLConstants.ariaLive,n.Constants.HTMLConstants.assertive),r.setAttribute(n.Constants.HTMLConstants.role,n.Constants.HTMLConstants.alert),document.body.appendChild(r));t.isNullOrEmptyString(i)&&(i="");r.innerText=i},t.getLocaleDirection=function(t){return n.LocaleConstants.RTL_LOCALES.indexOf(t)===-1?n.TextDirection.LTR:n.TextDirection.RTL},t.isMaskingforCustomer=function(n){return t.isNullOrUndefined(n)||Object.keys(n).length==0||t.isNullOrUndefined(n.dataMaskingRules)||Object.keys(n.dataMaskingRules).length==0?!1:!t.isNullOrUndefined(n.setting)&&!t.isNullOrUndefined(n.setting.msdyn_maskforcustomer)?n.setting.msdyn_maskforcustomer:!0},t.getQueryParameters=function(n){var u={},i,r;return t.isNullOrEmptyString(n)||(i=n.split("?"),i.length>1&&(n=i[1]),r=n.split("&"),r.length>0&&r.forEach(function(n){var t=n.split("=");t.length===2&&(u[t[0]]=t[1])})),u},t.redirectPage=function(t){var i;i={messageName:n.IframeMessages.redirectPageRequest,newUrl:t};window.parent.postMessage(i,"*")},t.getUrlQueryString=function(){return window.location.search.substring(1)},t.setupCacheRefreshTimer=function(){t.isNullOrUndefined(n.Bootstrapper.cacheTimer)&&(n.Bootstrapper.cacheTimer=setInterval(function(){n.ContextSpecificDataStore.UpdateDataTTL(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.ConversationData,n.ConfigurationManager.ConfigExpiryTime);n.ContextSpecificDataStore.UpdateDataTTL(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.OngoingChat,n.ConfigurationManager.ConfigExpiryTime);n.TelemetryClient.info({Event:n.TelemetryEvent.CacheDurationRefreshed})},n.ConfigurationManager.ConfigExpiryTime*n.Constants.CacheRefreshTimerGracePeriod),n.TelemetryClient.info({Event:n.TelemetryEvent.CacheDurationTimerCreated}))},t.clearCacheRefreshTimer=function(){t.isNullOrUndefined(n.Bootstrapper.cacheTimer)||(clearInterval(n.Bootstrapper.cacheTimer),n.Bootstrapper.cacheTimer=null,n.TelemetryClient.info({Event:n.TelemetryEvent.CacheDurationTimerRemoved}))},t.setSessionKeys=function(i){n.ContextSpecificDataStore.UpsertData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.ConversationData,i,n.ConfigurationManager.ConfigExpiryTime);n.ContextSpecificDataStore.UpsertData(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.OngoingChat,!0,n.ConfigurationManager.ConfigExpiryTime);t.setupCacheRefreshTimer()},t}();n.Util=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.scriptPathWithValidExtension=function(t){var i=t;return!t.endsWith(n.Constants.ScriptMinifiedExtension)&&t.endsWith(n.Constants.ScriptUnminifiedExtension)&&(i=t.substring(0,t.length-n.Constants.ScriptUnminifiedExtension.length)+n.Constants.ScriptMinifiedExtension),i},t.cssPathWithValidExtension=function(t){var i=t;return!t.endsWith(n.Constants.CssMinifiedExtension)&&t.endsWith(n.Constants.CssUnminifiedExtension)&&(i=t.substring(0,t.length-n.Constants.CssUnminifiedExtension.length)+n.Constants.CssMinifiedExtension),i},t.LocalizationFilePath=function(n){return t.addScriptRoot(t.LocalizationJsFolder+n+t.JavascriptSuffix)},Object.defineProperty(t,"ScriptRootPath",{set:function(n){t.scriptRootPath=n.trim();t.styleRootPath=t.scriptRootPath.replace("scripts/","styles/");t.configRootPath=t.scriptRootPath.replace("scripts/","configs/");t.libRootPath=t.scriptRootPath.replace("scripts/","lib/");t.imagesRootPath=t.scriptRootPath.replace("scripts/","images/")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LiveChatWidgetConfigPath",{get:function(){return t.addConfigRoot(n.Bootstrapper.environmentVersion.toLowerCase()+n.Constants.JsonUnminifiedExtension)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LiveChatWidgetClientSdkPath",{get:function(){return t.addScriptRoot(t.scriptPathWithValidExtension(t.LiveChatWidgetClientSdkScript))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LiveChatWidgetAllStylePath",{get:function(){return this.addStyleRoot(t.cssPathWithValidExtension(t.LiveChatWidgetAllStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LiveChatPopOutWindowStylePath",{get:function(){return this.addStyleRoot(t.cssPathWithValidExtension(t.LiveChatPopOutWindowStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"JQueryLibraryPath",{get:function(){return this.addLibRoot(t.JqueryLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CallingLibraryPath",{get:function(){return this.addLibRoot(t.CallingLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BluebirdLibraryPath",{get:function(){return this.addLibRoot(t.BluebirdLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Purify",{get:function(){return this.addLibRoot(t.PurifyLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LiveChatWidgetLibsPath",{get:function(){return this.addLibRoot(t.LiveChatWidgetLibsFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OCSDKPath",{get:function(){return this.OCSDKPathTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatPath",{get:function(){return this.WebChatPathTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatDailyPath",{get:function(){return this.WebChatPathDailyBuild},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatLocalPath",{get:function(){return this.WebChatPathLocalBuild},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatIC3AdapterPath",{get:function(){return this.addLibRoot(t.WebChatIC3AdapterLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatACSAdapterPath",{get:function(){return this.addLibRoot(t.WebChatACSAdapterLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AppInsightsPath",{get:function(){return this.addLibRoot(t.AppInsightsLibraryFile)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IC3ClientPath",{get:function(){return this.IC3ClientTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AMSClientSDKPath",{get:function(){return this.AMSClientSDKPathTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LoadingImagePath",{get:function(){return this.addImagesRoot(t.LoadingImageFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorImagePath",{get:function(){return this.addImagesRoot(t.ErrorImageFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CloseButtonPath",{get:function(){return this.addImagesRoot(t.CloseButtonFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MinimizeChatButtonPath",{get:function(){return this.addImagesRoot(t.MinimizeChatButtonFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TranscriptDownloadIconPath",{get:function(){return this.addImagesRoot(t.TranscriptDownloadIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorNotificationPath",{get:function(){return this.addImagesRoot(t.ErrorNotificationFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TranscriptEmailIconPath",{get:function(){return this.addImagesRoot(t.TranscriptEmailIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"InAppChatIconPath",{get:function(){return this.addImagesRoot(t.InAppChatIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"InAppTranscriptDownloadIconPath",{get:function(){return this.addImagesRoot(t.InAppTranscriptDownloadIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"InAppTranscriptEmailIconPath",{get:function(){return this.addImagesRoot(t.InAppTranscriptEmailIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AudioNotificationOnIconPath",{get:function(){return this.addImagesRoot(t.AudioNotificationOnIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AudioNotificationOffIconPath",{get:function(){return this.addImagesRoot(t.AudioNotificationOffIconFileName)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ChatReconnectPopupIconPath",{get:function(){return this.addImagesRoot(t.ChatReconnectPopupIcon)},enumerable:!0,configurable:!0}),t.getInternetConnectivityTestFile=function(){return t.scriptRootPath+"../"+n.Constants.internetConnectionTestUrl},t.addScriptRoot=function(n){if(t.scriptRootPath)return t.scriptRootPath+n},t.addStyleRoot=function(n){if(t.styleRootPath)return t.styleRootPath+n},t.addConfigRoot=function(n){if(t.configRootPath)return t.configRootPath+n},t.addLibRoot=function(n){if(t.libRootPath)return t.libRootPath+n},t.addImagesRoot=function(n){if(t.imagesRootPath)return t.imagesRootPath+n},t.LiveChatWidgetClientSdkScript="LiveChatClientSdk.js",t.JqueryLibraryFile="jquery-3.4.1.min.js",t.BluebirdLibraryFile="bluebird-3.5.0.min.js",t.PurifyLibraryFile="purify.min.js",t.CallingLibraryFile="CallingBundle.js",t.LoadingImageFileName="loading.gif",t.ErrorImageFileName="error.svg",t.CloseButtonFileName="closeButton.svg",t.MinimizeChatButtonFileName="minimizeChatButton.svg",t.TranscriptDownloadIconFileName="transcriptDownloadIcon.svg",t.TranscriptEmailIconFileName="transcriptEmailIcon.svg",t.AudioNotificationOnIconFileName="lcwAudioOn.svg",t.AudioNotificationOffIconFileName="lcwAudioOff.svg",t.InAppChatIconFileName="inAppChatIcon.svg",t.InAppTranscriptDownloadIconFileName="inAppTranscriptDownloadIcon.svg",t.InAppTranscriptEmailIconFileName="inAppTranscriptEmailIcon.svg",t.ErrorNotificationFileName="errorNotification.svg",t.LiveChatWidgetAllStyle="LiveChatWidgetAll.min.css",t.LiveChatWidgetLibsFile="LiveChatWidgetLibs.min.js",t.LocalizationJsFolder="locale/",t.LiveChatPopOutWindowStyle="PopOutWindow.min.css",t.JavascriptSuffix=".js",t.ChatReconnectPopupIcon="ChatReconnectPopupIcon.png",t.WebChatACSAdapterLibraryFile="chat-adapter-0.0.35-beta.3.js",t.WebChatIC3AdapterLibraryFile="botframework-webchat-adapter-ic3.production.min.js",t.AppInsightsLibraryFile="appinsights.js",t.OCSDKPathTemplate="https://ocsdk-prod.azureedge.net/release/{VERSION}/SDK.min.js",t.WebChatPathTemplate="https://cdn.botframework.com/botframework-webchat/{VERSION}/webchat.js",t.WebChatPathDailyBuild="https://github.com/microsoft/BotFramework-WebChat/releases/download/daily/webchat.js",t.WebChatPathLocalBuild="https://cdn.botframework.com/botframework-webchat/4.14.1/webchat.js",t.WebChatIC3AdapterTemplate="https://webchatic3.blob.core.windows.net/webchat-ic3adapter/{VERSION}/botframework-webchat-adapter-ic3.production.min.js",t.IC3ClientTemplate="https://comms.omnichannelengagementhub.com/release/{VERSION}/Scripts/SDK/SDK.min.js",t.AMSClientSDKPathTemplate="https://comms.omnichannelengagementhub.com/ams/{VERSION}/SDK.min.js",t}();n.ScriptPaths=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){this.defaultLCID="1033";this.polyfillJavascriptMethods();this.initializeLCWRuntimeId();this.initializeGlobalVariables();this.initializeBootStrappingPromise();this.initializeScriptPath();this.loadInitLibraries();this.AddMetaData();this.addCustomFontFamily()}return Object.defineProperty(i,"LiveChatConfiguration",{get:function(){return this.lcConfig===null&&t.TelemetryClient.error({Event:t.TelemetryEvent.LiveChatConfigNotFound,CloudType:i.environmentVersion,ExceptionDetails:null}),this.lcConfig},enumerable:!0,configurable:!0}),i.prototype.AddMetaData=function(){var n=document.createElement(t.Constants.Meta);n.name=t.Constants.Viewport;n.content=t.Constants.ScaleFordevice;document.head.appendChild(n)},i.prototype.addCustomFontFamily=function(){var i=document.querySelector("script#"+t.Constants.LiveChatScriptId);if(i.getAttribute(t.Constants.WidgetFontFamily)){var r="#"+t.Constants.MSLiveChatWidget+" * { font-family: "+decodeURIComponent(i.getAttribute(t.Constants.WidgetFontFamily))+" !important}",u=document.head,n=document.createElement(t.Constants.Style);n.type=t.Constants.TextCss;n.appendChild(document.createTextNode(r));u.appendChild(n)}},Object.defineProperty(i,"LiveChatContext",{get:function(){return this.lcContext===null&&(this.lcConfig===null&&t.TelemetryClient.error({Event:t.TelemetryEvent.LiveChatConfigNotFound,CloudType:i.environmentVersion,ExceptionDetails:null}),this.lcContext=new t.LiveChatContext,this.lcContext.locale=this.lcConfig.chatWidgetLocale,this.lcContext.widgetId=this.widgetId),this.lcContext},enumerable:!0,configurable:!0}),i.prototype.polyfillJavascriptMethods=function(){String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return this.substr(t||0,n.length)===n});String.prototype.endsWith||(String.prototype.endsWith=function(n,t){return(t===undefined||t===null||t>this.length)&&(t=this.length),this.substring(t-n.length,t)===n})},i.prototype.initializeLCWRuntimeId=function(){i.lcwRuntimeId=t.Util.newGuid()},i.prototype.initializeGlobalVariables=function(){var f=document.querySelector("script#"+t.Constants.LiveChatScriptId),u=f.getAttribute(t.Constants.EnvironmentVersionAttributeName),n,r;u&&u.trim().length!==0||(u=t.EnvironmentVersion.prod);i.environmentVersion=u.trim().toLowerCase();n=f.getAttribute(t.Constants.EnableAutofill);n&&n.trim().length!==0||(n=t.Constants.False);i.enableAutofill=n.trim().toLowerCase()===t.Constants.True;r=f.getAttribute(t.Constants.BypassCache);r&&r.trim().length!==0||(r=t.Constants.False);i.bypassChatConfigCache=r.trim().toLowerCase()===t.Constants.True},i.prototype.initializeScriptPath=function(){var i=document.querySelector("script#"+t.Constants.LiveChatScriptId),n=i.getAttribute("src");n=n.substring(0,n.lastIndexOf("/")+1);t.Util.isRelativeUrl(n)&&(n=t.Util.getDirectoryPathFromUrl(t.Util.getCurrentUrl())+n);t.ScriptPaths.ScriptRootPath=n;window.Microsoft_Omnichannel_LCWidget_Chat_Iframe_Window||(t.ScriptPaths.ScriptRootPath=n.replace("script","WebChatControl/script"))},i.prototype.shouldLoadBluebird=function(){return window.Promise===undefined},i.prototype.shouldLoadJQuery=function(){return window.jQuery===undefined},i.prototype.initializeBootStrappingPromise=function(){this.shouldLoadBluebird()?i.bootStrappingPromise=null:t.Util.isNullOrUndefined(i.bootStrappingPromise)&&(i.bootStrappingPromise=new Promise(function(n,t){i.bootStrappingPromiseResolver=n;i.bootStrappingPromiseRejecter=t}))},i.prototype.initialize=function(n){var tt=this,u,r,v,y,p,w,f,e,o,s,b,h,k,g,c,nt,d,l,a;$j=n===!0?jQuery.noConflict(!0):jQuery;u=[];r=document.querySelector("script#"+t.Constants.LiveChatScriptId);t.Util.isNullOrUndefined(r)?u.push({Event:t.TelemetryEvent.BootscriptFormatInvalid,CloudType:i.environmentVersion,ExceptionDetails:null}):(v=r.getAttribute(t.Constants.AppIdAttributeName),v&&v.trim().length!==0||u.push({Event:t.TelemetryEvent.BootscriptFormatInvalid,CloudType:i.environmentVersion,ExceptionDetails:{ErrorDetails:"AppId Invalid"}}),i.widgetId=v,y=r.getAttribute(t.Constants.OrgIdAttributeName),y&&y.trim().length!==0||u.push({Event:t.TelemetryEvent.BootscriptFormatInvalid,CloudType:i.environmentVersion,ExceptionDetails:{ErrorDetails:"OrgId Invalid"}}),i.orgId=y,p=r.getAttribute(t.Constants.OrgUrlAttributeName),p&&p.trim().length!==0||u.push({Event:t.TelemetryEvent.BootscriptFormatInvalid,CloudType:i.environmentVersion,ExceptionDetails:{ErrorDetails:"OrgURL not found"}}),i.orgUrl=p,w=r.getAttribute(t.Constants.HostNameAttributeName),w&&w.trim().length!==0||u.push({Event:t.TelemetryEvent.BootscriptFormatInvalid,CloudType:i.environmentVersion,ExceptionDetails:{ErrorDetails:"hostName not found"}}),i.hostName=w,f=r.getAttribute(t.Constants.DisableTelemetryAttributeName),f&&f.trim().length!==0||(f=t.Constants.False),i.disableTelemetry=f.trim().toLowerCase()===t.Constants.True,e=r.getAttribute(t.Constants.LiveChatWidgetHideChatButton),e&&e.trim().length!==0||(e=t.Constants.False),i.lcwHideChatButton=e.trim().toLowerCase()===t.Constants.True,o=r.getAttribute(t.Constants.EnableNewLineMarkdownSupport),o&&o.trim().length>0&&o!==t.Constants.Default&&(i.enableNewlineSupport=o.trim().toLowerCase()===t.Constants.True?t.Constants.True:t.Constants.False),s=r.getAttribute(t.Constants.LiveChatWidgetHideMinimizeButton),s&&s.trim().length!==0||(s=t.Constants.False),i.lcwHideMinimizeButton=s.trim().toLowerCase()===t.Constants.True,b=r.getAttribute(t.Constants.LiveChatWidgetEnableCustomCloseButtonText),t.Util.isNullOrEmptyString(b)||b.trim().length===0||(i.lcwEnableCustomCloseButtonText=b),h=r.getAttribute(t.Constants.RenderOnMobileDevice),h&&h.trim().length!==0||(h=t.Constants.False),i.renderOnMobileDevice=h.trim().toLowerCase()===t.Constants.True,k=r.getAttribute(t.Constants.WidgetColorOverride),k&&k.trim().length!==0&&(i.widgetThemeColor=k),g=r.getAttribute(t.Constants.WidgetFontFamily),g&&(i.widgetFontFamily=g),c=r.getAttribute(t.Constants.OpenChatInPopOutWindowAttributeName),c&&c.trim().length!==0||(c=t.Constants.False),nt=r.getAttribute(t.Constants.SuggestedActionLayout),nt&&(i.suggestedActionLayout=nt),i.openChatInPopOutWindow=c.trim().toLowerCase()===t.Constants.True,d=r.getAttribute(t.Constants.SrcUrlAttributeName),d&&d.trim().length!==0||u.push({Event:t.TelemetryEvent.BootscriptFormatInvalid,CloudType:i.environmentVersion,ExceptionDetails:{ErrorDetails:"srcUrl Invalid"}}),i.srcUrl=d,l=r.getAttribute(t.Constants.PopOutChatConstants.isPopOutModeAttributeName),l&&l.trim().length!==0||(l=t.Constants.False),i.isPopOutMode=l.trim().toLowerCase()===t.Constants.True,a=r.getAttribute(t.Constants.PopOutChatConstants.isCustomPopOutModeAttributeName),a&&a.trim().length!==0||(a=t.Constants.False),i.isCustomPopOutMode=a.trim().toLowerCase()===t.Constants.True,i.isPopOutMode&&this.loadPopOutWindowCSS(),t.ConfigurationManager.initialize().then(function(){return u.forEach(function(n){return t.TelemetryClient.error(n)})}).then(function(){return tt.loadLibraries()}).catch(function(n){i.bootStrappingPromiseRejecter();t.TelemetryClient.error({Event:t.TelemetryEvent.InvalidConfiguration,CloudType:i.environmentVersion,ExceptionDetails:n})}))},i.prototype.loadPopOutWindowCSS=function(){var n=[];n=n.concat(t.Util.getPopOutWindowCssResources());t.ResourceLoader.Load(n)},i.prototype.loadInitLibraries=function(){var n=[];n=n.concat(t.Util.getCssResources());n=n.concat([{path:t.ScriptPaths.BluebirdLibraryPath,preload:this.shouldLoadBluebird,resourceType:t.ResourceType.Script,callback:this.initializeBootStrappingPromise.bind(this)},{path:t.ScriptPaths.JQueryLibraryPath,preload:this.shouldLoadJQuery,callback:this.initialize.bind(this),resourceType:t.ResourceType.Script}]);t.ResourceLoader.Load(n)},i.prototype.loadLibraries=function(){this.loadAppInsightslibrary();var n=[],i=this.getWebChatPath(t.ConfigurationManager.WebChatSdkVersion);n=n.concat([{path:i,resourceType:t.ResourceType.Script},{path:t.ScriptPaths.Purify,resourceType:t.ResourceType.Script},{path:t.ScriptPaths.WebChatIC3AdapterPath,resourceType:t.ResourceType.Script},]);!this.checkIsBrowserIE()&&t.ConfigurationManager.ShouldLoadAcsChatAdapter&&(n=n.concat([{path:t.ScriptPaths.AMSClientSDKPath.replace("{VERSION}",t.ConfigurationManager.AMSClientVersion),resourceType:t.ResourceType.Script},{path:t.ScriptPaths.WebChatACSAdapterPath,resourceType:t.ResourceType.Script}]));n=n.concat([{path:t.ScriptPaths.OCSDKPath.replace("{VERSION}",t.ConfigurationManager.OmnichannelSdkVersion),resourceType:t.ResourceType.Script}]);t.ResourceLoader.Load(n);window.addEventListener("oc:sdk:load",this.onOCSdkLoad.bind(this))},i.prototype.loadAppInsightslibrary=function(){var n=[];n=n.concat([{path:t.ScriptPaths.AppInsightsPath,resourceType:t.ResourceType.Script}]);try{t.ResourceLoader.Load(n)}catch(i){}},i.prototype.getWebChatPath=function(n){if(this.checkIsBrowserIE())return t.ScriptPaths.WebChatLocalPath;switch(n){case t.Constants.WebChatDailyBuildFlag:return t.ScriptPaths.WebChatDailyPath;case t.Constants.WebChatLocalBuildFlag:return t.ScriptPaths.WebChatLocalPath;default:return t.ScriptPaths.WebChatPath.replace("{VERSION}",n)}},i.prototype.checkIsBrowserIE=function(){var n=window.navigator.userAgent;return n.indexOf("Trident")>-1},i.prototype.onOCSdkLoad=function(){var n=this,r={orgUrl:i.orgUrl,orgId:i.orgId,widgetId:i.widgetId,channelId:t.Constants.ChannelId};t.OmnichannelProxy.getInstance().initialize(r).then(function(){return t.ConfigurationHelper.getInstance().getLiveChatConfigAndApply()}).then(function(n){return t.ConfigurationHelper.getInstance().validateLiveChatConfig(n)}).then(function(n){return t.ConfigurationHelper.getInstance().validateWidgetLocations(n)}).then(function(n){return t.ConfigurationHelper.getInstance().saveLiveChatConfig(n)}).then(function(){return n.loadLocalizationFiles(i.lcConfig.chatWidgetLocaleLCID)}).then(function(){return i.bootStrappingPromiseResolver()})},i.prototype.loadLocalizationFiles=function(i){var r=this,u={path:t.ScriptPaths.LocalizationFilePath(this.defaultLCID),resourceType:t.ResourceType.Script},f={path:t.ScriptPaths.LocalizationFilePath(i),resourceType:t.ResourceType.Script};return i!==this.defaultLCID?Promise.all([new Promise(function(n){t.ResourceLoader.LoadResource(u,function(){n()})}),new Promise(function(n){t.ResourceLoader.LoadResource(f,function(){n()})})]).then(function(){var t=n.Omnichannel.LiveChatWidget;t.Locale=Object.assign({},t["Locale_"+r.defaultLCID],t["Locale_"+i])}):new Promise(function(i){t.ResourceLoader.LoadResource(u,function(){var t=n.Omnichannel.LiveChatWidget;t.Locale=Object.assign({},t["Locale_"+r.defaultLCID]);i()})})},i.lcwEnableCustomCloseButtonText="",i.enableNewlineSupport=t.Constants.Default,i.environmentVersion=t.EnvironmentVersion.prod,i.lcConfig=null,i.jwtSubId="",i.authToken="",i.bootStrappingPromise=null,i.lcwLoadToChatButtonShowTimer=t.Util.timer(),i.debugInfo=new t.DebugInformation,i.lcContext=null,i}();t.Bootstrapper=i})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={}));window.isMock||function(){new Microsoft.Omnichannel.LiveChatWidget.Bootstrapper}("docReady",window),function(n){var t;(function(n){var t;(function(n){var i,t,r;(function(n){n.CONFIG_VALIDATION="LCW_ConfigValidationEvents";n.LOAD="LCW_LoadEvents";n.ACTIONS="LCW_ActionEvents";n.SDK="LCW_SDKEvents";n.IC3_CLIENT="LCW_IC3ClientEvents";n.OCSDK="LCW_OCSDKEvents";n.WEBCHAT="LCW_WebChatEvents";n.CALLING="LCW_Calling";n.UNDEFINED="LCW_Undefined";n.ACS_ADAPTER="LCW_ACSAdapterEvents"})(i=n.ScenarioType||(n.ScenarioType={})),function(n){n.BootscriptFormatInvalid="BootscriptFormatInvalid";n.ResourceLoaded="ResourceLoaded";n.ResourceLoadFailed="ResourceLoadFailed";n.InvalidConfiguration="InvalidConfiguration";n.GetWidgetConfigStarted="GetWidgetConfigStarted";n.GetWidgetConfigSuccess="GetWidgetConfigSuccess";n.GetWidgetConfigFailure="GetWidgetConfigFailure";n.LiveChatConfigNotFound="LiveChatConfigNotFound";n.WebChatLoaded="WebChatLoaded";n.PrechatWidgetLoaded="PrechatWidgetLoaded";n.PostchatWidgetLoaded="PostchatWidgetLoaded";n.PrechatSubmitted="PrechatSubmitted";n.PostchatSubmitted="PostchatSubmitted";n.PostChatFormsProRenderFailed="PostChatFormsProRenderFailed";n.LCWChatButtonClicked="LCWChatButtonClicked";n.LCWChatButtonShow="LCWChatButtonShow";n.InitStarted="InitStarted";n.InitSuccess="InitSuccess";n.InitFailure="InitFailure";n.WidgetLoadComplete="WidgetLoadComplete";n.WidgetLoadFailed="WidgetLoadFailed";n.InvalidDomain="InvalidDomain";n.ValidDomain="ValidDomain";n.InvalidAuthClientMethod="InvalidAuthClientMethod";n.AuthClientProviderException="AuthClientProviderException";n.AuthClientMethodException="AuthClientMethodException";n.StartChatMethodException="StartChatMethodException";n.CloseChatMethodException="CloseChatMethodException";n.StartProactiveChatMethodException="StartProactiveChatMethodException";n.SetContextProviderMethodException="SetContextProviderMethodException";n.SetAuthProviderMethodException="SetAuthProviderMethodException";n.RemoveContextProviderMethodException="RemoveContextProviderMethodException";n.RemoveAuthTokenProviderMethodException="RemoveAuthTokenProviderMethodException";n.AuthClientEmptyTokenException="AuthClientEmptyTokenException";n.ContextProviderException="ContextProviderException";n.StringNotFound="StringNotFound";n.GetContextProviderSDKCall="GetContextProviderSDKCall";n.SetContextProviderSDKCall="SetContextProviderSDKCall";n.RemoveContextProviderSDKCall="RemoveContextProviderSDKCall";n.GetAuthTokenProviderSDKCall="GetAuthTokenProviderSDKCall";n.SetAuthTokenProviderSDKCall="SetAuthTokenProviderSDKCall";n.RemoveAuthTokenProviderSDKCall="RemoveAuthTokenProviderSDKCall";n.StartChatSDKCall="StartChatCall";n.EndChatSDKCall="EndChatCall";n.DataMaskingRuleApplied="DataMaskingRuleApplied";n.LocationDetectionFlagNotFound="LocationDetectionFlagNotFound";n.LocationDetectionSuccess="LocationDetectionSuccess";n.LocationDetectionFailed="LocationDetectionFailed";n.InvalidAdaptiveCardFormat="InvalidAdaptiveCardFormat";n.StartProactiveChatSDKCall="StartProactiveChatSDKCall";n.ProactiveChatNotEnabled="ProactiveChatNotEnabled";n.ProactiveChatOffered="ProactiveChatOffered";n.ProactiveChatAccepted="ProactiveChatAccepted";n.ProactiveChatRejected="ProactiveChatRejected";n.IncomingProactiveChatScreenLoaded="IncomingProactiveChatScreenLoaded";n.ProactiveChatInvitationTimedOut="ProactiveChatInvitationTimedOut";n.ChatAlreadyTriggered="ChatAlreadyTriggered";n.IFrameMessageHandlerError="IFrameMessageHandlerError";n.GetAuthTokenFromOuterScope="GetAuthTokenFromOuterScope";n.ThirdPartyCookiesBlocked="ThirdPartyCookiesBlocked";n.QueuePositionMessageRecieved="QueuePositionMessageRecieved";n.AverageWaitTimeMessageRecieved="AverageWaitTimeMessageRecieved";n.AudioNotificationError="AudioNotificationError";n.CacheDurationRefreshed="CacheDurationRefreshed";n.CacheDurationTimerCreated="CacheDurationTimerCreated";n.CacheDurationTimerRemoved="CacheDurationTimerRemoved";n.IC3ClientEvent="IC3ClientEvent";n.JoinConversationSuccess="JoinConversationSuccess";n.IC3ThreadUpdateEvent="ThreadEventReceived";n.ACSChatAdapterLoadEvent="ACSChatAdapterLoadEvent";n.ACSLiveChatVersionInitializationFailed="ACSLiveChatVersionInitializationFailed";n.OCSDKEvent="OCSDKEvent";n.OCSDKInitializationSuccess="OCSDKInitializationSuccess";n.OCSDKInitializationFailure="OCSDKInitializationFailure";n.GetSystemConfigStarted="GetSystemConfigStarted";n.GetSystemConfigSuccess="GetSystemConfigSuccess";n.GetSystemConfigFailure="GetSystemConfigFailure";n.FetchChatTokenStarted="FetchChatTokenStarted";n.FetchChatTokenSuccess="FetchChatTokenSuccess";n.FetchChatTokenFailure="FetchChatTokenFailure";n.SessionInitStarted="SessionInitStarted";n.SessionInitSuccess="SessionInitSuccess";n.SessionInitFailure="SessionInitFailure";n.SessionCloseSuccess="SessionCloseSuccess";n.SessionCloseFailure="SessionCloseFailure";n.SessionCloseStarted="SessionCloseStarted";n.SubmitPostChatSuccess="SubmitPostChatSuccess";n.SubmitPostChatFailure="SubmitPostChatFailure";n.SubmitPostChatStarted="SubmitPostChatStarted";n.FetchChatTranscriptStarted="FetchChatTranscriptStarted";n.FetchChatTranscriptSuccess="FetchChatTranscriptSuccess";n.FetchChatTranscriptFailure="FetchChatTranscriptFailure";n.EmailChatTranscriptStarted="EmailChatTranscriptStarted";n.EmailChatTranscriptSuccess="EmailChatTranscriptSuccess";n.EmailChatTranscriptFailure="EmailChatTranscriptFailure";n.ValidateAuthChatRecordFailed="ValidateAuthChatRecordFailed";n.ValidateAuthChatRecordSuccess="ValidateAuthChatRecordSuccess";n.SecondaryChannelEventStarted="SecondaryChannelEventStarted";n.SecondaryChannelEventSuccess="SecondaryChannelEventSuccess";n.SecondaryChannelEventFailure="SecondaryChannelEventFailure";n.VideoCallAcceptButtonClick="VideoCallAcceptButtonClick";n.VoiceCallAcceptButtonClick="VoiceCallAcceptButtonClick";n.VideoCallRejectButtonClick="VideoCallRejectButtonClick";n.VoiceCallRejectButtonClick="VoiceCallRejectButtonClick";n.ToggleMuteButtonClick="ToggleMuteButtonClick";n.ToggleCameraButtonClick="ToggleCameraButtonClick";n.EndCallButtonClick="EndCallButtonClick";n.CallingSDKInitSuccess="CallingSDKInitSuccess";n.CallingSDKInitFailed="CallingSDKInitFailed";n.CallingSDKLoadSuccess="CallingSDKLoadSuccess";n.CallingSDKLoadFailed="CallingSDKLoadFailed";n.GetReconnectableChatsFailed="GetReconnectableChatsFailed";n.GetReconnectAvailabilityFailed="GetReconnectAvailabilityFailed";n.ProcessingHTMLTextMiddlewareFailed="ProcessingHTMLTextMiddlewareFailed";n.ProcessingConversationEndMiddlewareFailed="ProcessingHTMLTextMiddlewareFailed";n.ProcessingSanitizationMiddlewareFailed="ProcessingSanitizationMiddlewareFailed";n.GetLWIDetailsFailed="GetLWIDetailsFailed";n.GetSurveyInviteLinkFailed="GetSurveyInviteLinkFailed";n.GetSurveyInviteLinkSucceeded="GetSurveyInviteLinkSucceeded";n.FormatTagsMiddlewareJSONStringifyFailed="FormatTagsMiddlewareJSONStringifyFailed";n.ChatReconnectPopUp="ChatReconnectPopUp";n.SendTypingIndicatorSucceeded="SendTypingIndicatorSucceeded";n.SendTypingIndicatorFailed="SendTypingIndicatorFailed";n.GetAgentAvailabilityInitiated="GetAgentAvailabilityInitiated";n.InitializeAMSClientSucceeded="InitializeAMSClientSucceeded";n.InitializeAMSClientFailed="InitializeAMSClientFailed";n.UploadAttachmentSucceeded="UploadAttachmentSucceeded";n.UploadAttachmentFailed="UploadAttachmentFailed";n.DownloadAttachmentSucceeded="DownloadAttachmentSucceeded";n.DownloadAttachmentFailed="DownloadAttachmentFailed";n.GetFileIdsFromChatMetadataSucceeded="GetFileIdsFromChatMetadataSucceeded";n.GetFileIdsFromChatMetadataFailed="GetFileIdsFromChatMetadataFailed";n.CreateChatMetadataForFileIdsSucceeded="CreateChatMetadataForFileIdsSucceeded";n.CreateChatMetadataForFileIdsFailed="CreateChatMetadataForFileIdsFailed";n.GetFileMetadataFromChatMetadataSucceeded="GetFileMetadataFromChatMetadataSucceeded";n.GetFileMetadataFromChatMetadataFailed="GetFileMetadataFromChatMetadataFailed";n.CreateChatMetadataForFileMetadataSucceeded="CreateChatMetadataForFileMetadataSucceeded";n.CreateChatMetadataForFileMetadataFailed="CreateChatMetadataForFileMetadataFailed"}(t=n.TelemetryEvent||(n.TelemetryEvent={}));r=function(){function n(){}return n.map=function(n){switch(n){case t.InvalidConfiguration:case t.GetWidgetConfigStarted:case t.GetWidgetConfigSuccess:case t.GetWidgetConfigFailure:case t.LiveChatConfigNotFound:case t.AuthClientMethodException:case t.StringNotFound:case t.LocationDetectionFlagNotFound:case t.BootscriptFormatInvalid:case t.InvalidDomain:case t.ValidDomain:case t.InvalidAuthClientMethod:case t.InvalidAdaptiveCardFormat:case t.GetContextProviderSDKCall:case t.GetSystemConfigSuccess:case t.GetSystemConfigFailure:case t.SetContextProviderSDKCall:case t.ContextProviderException:case t.RemoveContextProviderSDKCall:case t.GetAuthTokenProviderSDKCall:case t.SetAuthTokenProviderSDKCall:case t.AuthClientProviderException:case t.RemoveAuthTokenProviderSDKCall:case t.StartChatSDKCall:case t.ProactiveChatNotEnabled:case t.StartProactiveChatSDKCall:return i.CONFIG_VALIDATION;case t.ResourceLoaded:case t.ResourceLoadFailed:case t.WebChatLoaded:case t.PrechatWidgetLoaded:case t.PostchatWidgetLoaded:case t.InitStarted:case t.InitSuccess:case t.InitFailure:case t.WidgetLoadComplete:case t.WidgetLoadFailed:case t.IncomingProactiveChatScreenLoaded:case t.OCSDKInitializationSuccess:case t.OCSDKInitializationFailure:case t.LCWChatButtonShow:return i.LOAD;case t.PrechatSubmitted:case t.PostchatSubmitted:case t.LCWChatButtonClicked:case t.LocationDetectionSuccess:case t.LocationDetectionFailed:case t.ProactiveChatOffered:case t.ProactiveChatAccepted:case t.ProactiveChatRejected:case t.ProactiveChatInvitationTimedOut:case t.ChatAlreadyTriggered:case t.SubmitPostChatSuccess:case t.SubmitPostChatFailure:case t.ProcessingHTMLTextMiddlewareFailed:case t.DataMaskingRuleApplied:case t.UploadAttachmentSucceeded:case t.UploadAttachmentFailed:case t.DownloadAttachmentSucceeded:case t.DownloadAttachmentFailed:case t.GetFileIdsFromChatMetadataSucceeded:case t.GetFileIdsFromChatMetadataFailed:case t.CreateChatMetadataForFileIdsSucceeded:case t.CreateChatMetadataForFileIdsFailed:case t.GetFileMetadataFromChatMetadataSucceeded:case t.GetFileMetadataFromChatMetadataFailed:case t.CreateChatMetadataForFileMetadataSucceeded:case t.CreateChatMetadataForFileMetadataFailed:return i.ACTIONS;case t.StartChatMethodException:case t.CloseChatMethodException:case t.StartProactiveChatMethodException:case t.SetContextProviderMethodException:case t.SetAuthProviderMethodException:case t.RemoveContextProviderMethodException:case t.RemoveAuthTokenProviderMethodException:return i.SDK;case t.VideoCallAcceptButtonClick:case t.VoiceCallAcceptButtonClick:case t.VideoCallRejectButtonClick:case t.VoiceCallRejectButtonClick:case t.ToggleMuteButtonClick:case t.ToggleCameraButtonClick:case t.EndCallButtonClick:case t.CallingSDKInitSuccess:case t.CallingSDKInitFailed:case t.CallingSDKLoadSuccess:case t.CallingSDKLoadFailed:return i.CALLING;default:return i.CONFIG_VALIDATION}},n.mapEventToScenario=function(t){return n.map(t)},n}();n.TelemetryConstants=r})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t,i;(function(n){n.INFO="INFO";n.DEBUG="DEBUG";n.WARN="WARN";n.ERROR="ERROR"})(t=n.LogLevel||(n.LogLevel={}));i=function(){function i(){}return Object.defineProperty(i,"consoleLogLevels",{get:function(){return i._consoleEnable},set:function(n){i._consoleEnable=n},enumerable:!0,configurable:!0}),Object.defineProperty(i,"telemetryLogLevels",{get:function(){return i._telemeteryEnable},set:function(n){i._telemeteryEnable=n},enumerable:!0,configurable:!0}),i.info=function(r,u){u===void 0&&(u=n.ScenarioType.UNDEFINED);i.logInternal(t.INFO,n.TelemetryHelper.parseInput(r,u))},i.debug=function(r,u){u===void 0&&(u=n.ScenarioType.UNDEFINED);i.logInternal(t.DEBUG,n.TelemetryHelper.parseInput(r,u))},i.warn=function(r,u){u===void 0&&(u=n.ScenarioType.UNDEFINED);i.logInternal(t.WARN,n.TelemetryHelper.parseInput(r,u))},i.error=function(r,u){u===void 0&&(u=n.ScenarioType.UNDEFINED);i.logInternal(t.ERROR,n.TelemetryHelper.parseInput(r,u))},i.log=function(t,r,u){u===void 0&&(u=n.ScenarioType.UNDEFINED);i.logInternal(t,n.TelemetryHelper.parseInput(r,u))},i.consoleLog=function(i,r){var u=r&&Object.keys(r).length>0?r:"";try{if(n.Bootstrapper.environmentVersion!=n.EnvironmentVersion.prod)switch(i){case t.INFO:console.info(n.Constants.LiveChatWidget,u);break;case t.DEBUG:console.debug(n.Constants.LiveChatWidget,u);break;case t.WARN:console.warn(n.Constants.LiveChatWidget,u);break;case t.ERROR:console.error(n.Constants.LiveChatWidget,u);break;default:console.debug(n.Constants.LiveChatWidget,u)}}catch(f){console.error("An unexpected error occurred in the Telemetry client: "+f)}},i.logInternal=function(t,r){i.consoleLogLevels&&i.consoleLogLevels.indexOf(t)!==-1&&i.consoleLog(t,r.payload);var u=n.TelemetryHelper.buildTelemetryEvent(t,r);i.telemetryLogLevels&&i.telemetryLogLevels.indexOf(t)!==-1&&n.TelemetryManager.sendTelemetry(r.scenarioType,u)},i}();n.TelemetryClient=i})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getChatId=function(){if(n.Util.isLoaderLoaded()){var t=window[n.Constants.Microsoft][n.Constants.Omnichannel][n.Constants.LiveChatWidget][n.Constants.Loader].currentConversation;if(!n.Util.isNullOrUndefined(t))return t.chatId}return""},t.getConversationId=function(){if(n.Util.isLoaderLoaded()){var t=window[n.Constants.Microsoft][n.Constants.Omnichannel][n.Constants.LiveChatWidget][n.Constants.Loader].currentConversation;if(!n.Util.isNullOrUndefined(t))return t.conversationId}return""},t.getCurrentRequestId=function(){return n.Util.isLoaderLoaded()?window[n.Constants.Microsoft][n.Constants.Omnichannel][n.Constants.LiveChatWidget][n.Constants.Loader].currentRequestId:""},t.buildTelemetryEvent=function(i,r){switch(r.scenarioType){case n.ScenarioType.LOAD:return t.conformToLoadContract(i,r);case n.ScenarioType.IC3_CLIENT:return t.conformToIC3ClientContract(i,r);case n.ScenarioType.WEBCHAT:return t.conformToWebChatContract(i,r);case n.ScenarioType.OCSDK:return t.conformToOCSDKContract(i,r);case n.ScenarioType.ACTIONS:return t.conformToActionsContract(i,r);case n.ScenarioType.CALLING:return t.conformToCallingContract(i,r);case n.ScenarioType.ACS_ADAPTER:return t.conformToACSAdapterContract(i,r);default:case n.ScenarioType.CONFIG_VALIDATION:return t.conformToConfigValidationContract(i,r)}},t.populateBasicProperties=function(i){return{WidgetId:n.Bootstrapper.widgetId,ChatId:t.getChatId(),ChannelId:n.Constants.ChannelId,ConversationId:t.getConversationId(),OrganizationId:n.Bootstrapper.orgId,LCWRuntimeId:n.Bootstrapper.lcwRuntimeId,CurrentRequestId:t.getCurrentRequestId(),LogLevel:i}},t.populate=function(n,i,r){var f=t.populateBasicProperties(n,i),u=f;return r(u),u},t.conformToActionsContract=function(n,i){var r=i.payload;return t.populate(n,r,function(n){n.Event=r.Event;n.ActionType=r.ActionType;n.ElapsedTimeInMilliseconds=r.ElapsedTimeInMilliseconds;n.ExceptionDetails=JSON.stringify(r.ExceptionDetails)})},t.conformToWebChatContract=function(n,i){var r=i.payload;return t.populate(n,r,function(n){n.Event=r.type;n.EventInfo=r.name;n.Dimensions=r.dimensions;n.Data=r.data;n.Duration=r.duration;n.ExceptionDetails=JSON.stringify(r.error)})},t.conformToConfigValidationContract=function(i,r){var u=r.payload;return t.populate(i,u,function(t){t.Event=u.Event;t.RequestId=u.RequestId;t.LCWVersion=n.Bootstrapper.environmentVersion;t.CloudType=u.CloudType;t.Domain=n.Bootstrapper.hostName;t.ElapsedTimeInMilliseconds=u.ElapsedTimeInMilliseconds;t.ExceptionDetails=JSON.stringify(u.ExceptionDetails);t.Language=n.Bootstrapper.lcConfig?n.Bootstrapper.lcConfig.chatWidgetLocaleLCID||"":""})},t.conformToLoadContract=function(n,i){var r=i.payload;return t.populate(n,r,function(n){n.Event=r.Event;n.ResourcePath=r.ResourcePath;n.WidgetState=r.WidgetState;n.ChatState=r.ChatState;n.ChatType=r.ChatType;n.ElapsedTimeInMilliseconds=r.ElapsedTimeInMilliseconds;n.ExceptionDetails=JSON.stringify(r.ExceptionDetails)})},t.conformToIC3ClientContract=function(i,r){var u=r.payload;return t.populate(i,u,function(t){t.Event=u.Event;t.IC3ClientVersion=n.ConfigurationManager.IC3ClientVersion;t.SubscriptionId=u.SubscriptionId;t.EndpointUrl=u.EndpointUrl;t.EndpointId=u.EndpointId;t.ErrorCode=u.ErrorCode;t.ElapsedTimeInMilliseconds=u.ElapsedTimeInMilliseconds;t.ExceptionDetails=JSON.stringify(u.ExceptionDetails);t.ShouldBubbleToHost=u.ShouldBubbleToHost;t.Description=u.Description})},t.conformToACSAdapterContract=function(n,i){var r=i.payload;return t.populate(n,r,function(n){n.Description=r.Description;n.ACSUserId=r.ACSUserId;n.ChatThreadId=r.ChatThreadId;n.ChatMessageId=r.ChatMessageId;n.TimeStamp=r.TimeStamp;n.Event=r.Event;n.ErrorCode=r.ErrorCode;n.ExceptionDetails=r.ExceptionDetails})},t.conformToCallingContract=function(n,i){var r=i.payload;return t.populate(n,r,function(n){n.CallId=r.CallId;n.Event=r.Event;n.ElapsedTimeInMilliseconds=r.ElapsedTimeInMilliseconds;n.ExceptionDetails=JSON.stringify(r.ExceptionDetails);n.Description=r.Description})},t.conformToOCSDKContract=function(i,r){var u=r.payload;return t.populate(i,u,function(t){t.RequestId=u.RequestId;t.Event=u.Event;t.OCSDKVersion=n.ConfigurationManager.OmnichannelSdkVersion;t.TransactionId=u.TransactionId;t.ElapsedTimeInMilliseconds=u.ElapsedTimeInMilliseconds;t.ExceptionDetails=JSON.stringify(u.ExceptionDetails)})},t.parseInput=function(t,i){return{scenarioType:i==n.ScenarioType.UNDEFINED?n.TelemetryConstants.mapEventToScenario(t.Event):i,payload:t}},t}();n.TelemetryHelper=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return Object.defineProperty(t,"logger",{get:function(){if(n.Util.isNullOrUndefined(t._logger)&&!n.Util.isNullOrEmptyString(n.ConfigurationManager.AriaTelemetryKey)&&!n.Bootstrapper.disableTelemetry){var i={disableCookiesUsage:!0};n.Util.isNullOrEmptyString(n.ConfigurationManager.CollectorUriForTelemetry)||(i.collectorUri=n.ConfigurationManager.CollectorUriForTelemetry);t._logger=AWTLogManager.initialize(n.ConfigurationManager.AriaTelemetryKey,i)}return t._logger},enumerable:!0,configurable:!0}),t.sendTelemetry=function(i,r){var s,u,e,o,f;if(t.logger&&i!=n.ScenarioType.UNDEFINED){for(u=new AWTEventProperties,u.setName(i),e=0,o=Object.keys(r);e<o.length;e++)f=o[e],s=typeof r[f]=="object"?JSON.stringify(r[f]):r[f],u.setProperty(f,s);u.setPropertyWithPii(n.ConfigurationManager.AriaTelemetryApplicationName,n.Constants.LiveChatWidget,AWTPiiKind.GenericData);t.logger.logEvent(u)}},t}();n.TelemetryManager=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.RTL_LOCALES=["1025","1037"],n}();n.LocaleConstants=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.logClientSdkTelemetryEvent=function(t,i){switch(t){case n.LogLevel.DEBUG:n.TelemetryClient.debug(i,n.ScenarioType.IC3_CLIENT);break;case n.LogLevel.WARN:n.TelemetryClient.warn(i,n.ScenarioType.IC3_CLIENT);break;case n.LogLevel.ERROR:n.TelemetryClient.error(i,n.ScenarioType.IC3_CLIENT);break;case n.LogLevel.INFO:default:n.TelemetryClient.info(i,n.ScenarioType.IC3_CLIENT)}},t}();n.IC3ClientSdkLogger=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t,r,i;(function(n){n[n.LCW_CONTEXTPROVIDER_METHOD_FAIL=1]="LCW_CONTEXTPROVIDER_METHOD_FAIL";n[n.LCW_AUTHTOKENPROVIDER_METHOD_FAIL=2]="LCW_AUTHTOKENPROVIDER_METHOD_FAIL";n[n.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED=3]="LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED";n[n.LCW_AUTHTOKENPROVIDER_INVALID_TOKEN_RECEIVED=4]="LCW_AUTHTOKENPROVIDER_INVALID_TOKEN_RECEIVED";n[n.LCW_CHAT_WIDGET_SCRIPT_FAILED_TO_LOAD=7]="LCW_CHAT_WIDGET_SCRIPT_FAILED_TO_LOAD";n[n.LCW_CHAT_WIDGET_GET_AUTH_TOKEN_FROM_OUTER_SCOPE_FAILED=8]="LCW_CHAT_WIDGET_GET_AUTH_TOKEN_FROM_OUTER_SCOPE_FAILED";n[n.LCW_AGENT_AVAILABILITY_FAIL=9]="LCW_AGENT_AVAILABILITY_FAIL"})(t=n.LCWErrorCode||(n.LCWErrorCode={}));r=function(){function r(){}return r.raiseErrorEventNoStorageClean=function(t,i){var u={error:i,errorCode:t,errorDescription:r.LCWErrors[t]};n.Util.raiseCustomEvent(n.LCWEvents.LCWErrorEvent,u)},r.raiseErrorEvent=function(t,i){r.raiseErrorEventNoStorageClean(t,i);r.LCWFatalErrors.indexOf(t)!==-1&&(n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.ConfigData),n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.EnvironmentWidgetOrganization,n.WidgetDataKeys.SystemConfigurationData),n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.ConversationData),n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.OngoingChat),n.Util.clearCacheRefreshTimer())},r.LCWErrors=(i={},i[t.LCW_CONTEXTPROVIDER_METHOD_FAIL]="Context provider method execution failed",i[t.LCW_AUTHTOKENPROVIDER_METHOD_FAIL]="Auth token provider method execution failed",i[t.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED]="Auth token provider didn't provide any token",i[t.LCW_AUTHTOKENPROVIDER_INVALID_TOKEN_RECEIVED]="Auth token provider provided invalid token",i[t.LCW_CHAT_WIDGET_SCRIPT_FAILED_TO_LOAD]="Live chat widget scripts failed to load",i[t.LCW_CHAT_WIDGET_GET_AUTH_TOKEN_FROM_OUTER_SCOPE_FAILED]="Failed to find auth function on the web page",i),r.LCWFatalErrors=[t.LCW_CHAT_WIDGET_SCRIPT_FAILED_TO_LOAD,t.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,t.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,t.LCW_AUTHTOKENPROVIDER_INVALID_TOKEN_RECEIVED,t.LCW_CHAT_WIDGET_GET_AUTH_TOKEN_FROM_OUTER_SCOPE_FAILED],r}();n.LCWErrorTypes=r})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.shouldShowWelcomeScreen=function(){return n.ConfigurationManager.FeaturesConfig.ShowWelcomeScreen},t.shouldShowPrechatScreen=function(){return n.ConfigurationManager.FeaturesConfig.ShowPrechatScreen},t.shouldEnableFileAttachment=function(){return n.ConfigurationManager.FeaturesConfig.ShowFileAttachmentButton},t.shouldEnableCallingAsEscalateChannel=function(){return n.ConfigurationManager.FeaturesConfig.CallingAsEscalateChannel},t.shouldEnableInlinePlaying=function(){return n.ConfigurationManager.FeaturesConfig.InlinePlaying},t.shouldEnableNewLineMarkdownSupport=function(){return n.Bootstrapper.enableNewlineSupport===n.Constants.Default?n.ConfigurationManager.FeaturesConfig.NewLineMarkdownSupport:n.Bootstrapper.enableNewlineSupport===n.Constants.True},t.shouldEnableMarkdownMessageFormatting=function(){return n.Bootstrapper.lcConfig&&n.Bootstrapper.lcConfig.enableMarkdown&&n.ConfigurationManager.FeaturesConfig.MakrdownMessageFormatting},t}();n.FeaturesManager=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.initialize=function(){n.TelemetryClient.consoleLogLevels=n.Util.selectedLogLevels(t.ConsoleLogLevels);n.TelemetryClient.telemetryLogLevels=n.Util.selectedLogLevels(t.TelemetryLogLevels);var i=new Promise(function(i){var r=n.ContextSpecificDataStore.GetData(n.DataContextType.EnvironmentContext,n.WidgetDataKeys.SystemConfigurationData),u;if(t.UseCachedConfig&&!n.Util.isNullOrUndefined(r)){t._configuration=r;i();return}u=n.Util.timer();$j.getJSON(n.ScriptPaths.LiveChatWidgetConfigPath,function(r){t._configuration=r;t._configuration.appInsightsKey!=null&&t._configuration.appInsightsKey!=""&&(window.Microsoft_Omnichannel_LCWidget_AppInsightsKey=t._configuration.appInsightsKey);n.ContextSpecificDataStore.PersistData(n.DataContextType.EnvironmentContext,n.WidgetDataKeys.SystemConfigurationData,r,n.Constants.SystemConfigExpiryTimeForStorage);n.TelemetryClient.info({Event:n.TelemetryEvent.GetSystemConfigSuccess,ElapsedTimeInMilliseconds:u.milliSecondsElapsed});i()})});return i.then(function(){n.TelemetryClient.consoleLogLevels=n.Util.selectedLogLevels(t.ConsoleLogLevels);n.TelemetryClient.telemetryLogLevels=n.Util.selectedLogLevels(t.TelemetryLogLevels)})},Object.defineProperty(t,"configuration",{get:function(){return this._configuration||this.defaultConfiguration},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FeaturesConfig",{get:function(){return t.configuration.ocfeaturesState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AriaTelemetryKey",{get:function(){return t.configuration.ariaTelemetryKey},set:function(n){t.configuration.ariaTelemetryKey=n},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CollectorUriForTelemetry",{get:function(){return t.configuration.collectorUriForTelemetry},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AriaTelemetryApplicationName",{get:function(){return t.configuration.ariaTelemetryApplicationName},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TelemetryLogLevels",{get:function(){return t.configuration.telemetryLogLevels},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ConsoleLogLevels",{get:function(){return t.configuration.consoleLogLevels},enumerable:!0,configurable:!0}),Object.defineProperty(t,"InitTimeout",{get:function(){return t.configuration.initTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(t,"InitRetryCount",{get:function(){return t.configuration.initRetryCount},enumerable:!0,configurable:!0}),Object.defineProperty(t,"InitTimeBetweenRetry",{get:function(){return t.configuration.initTimeBetweenRetry},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTokenTimeout",{get:function(){return t.configuration.getChatTokenTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTokenRetryCount",{get:function(){return t.configuration.getChatTokenRetryCount},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTokenTimeBetweenRetry",{get:function(){return t.configuration.getChatTokenTimeBetweenRetry},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTranscriptTimeout",{get:function(){return t.configuration.getChatTranscriptTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTranscriptRetryCount",{get:function(){return t.configuration.getChatTranscriptRetryCount},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTranscriptTimeBetweenRetry",{get:function(){return t.configuration.getChatTokenTimeBetweenRetry},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BufferInvalidationTimeForToken",{get:function(){return t.configuration.bufferInvalidationTimeForToken},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TokenRefreshTime",{get:function(){return t.configuration.tokenRefreshTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ConfigExpiryTime",{get:function(){return t.configuration.configExpiryTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OmnichannelSdkVersion",{get:function(){return t.configuration.omnichannelSdkVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatSdkVersion",{get:function(){return t.configuration.webChatSdkVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatIC3AdapterVersion",{get:function(){return t.configuration.webChatIC3AdapterVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IC3ClientVersion",{get:function(){return t.configuration.ic3ClientVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AMSClientVersion",{get:function(){return t.configuration.amsClientVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"UseCachedConfig",{get:function(){return t.configuration.useCachedConfig},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsDebugMode",{get:function(){return t.configuration.enableDebug},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsTypingIndicatorEnabled",{get:function(){return t.configuration.enableTypingIndicator},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BootstrapperPromiseStateCheckInterval",{get:function(){return t.configuration.bootstrapperPromiseStateCheckInterval},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ChatAdapterFirstMessagePollingInterval",{get:function(){return t.configuration.chatAdapterFirstMessagePollingInterval},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LoaderPromiseStateCheckInterval",{get:function(){return t.configuration.loaderPromiseStateCheckInterval},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MaxGetChatTokenRetriesOnFailure",{get:function(){return t.configuration.maxGetChatTokenRetriesOnFailure},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MaxGetChatTranscriptRetriesOnFailure",{get:function(){return t.configuration.maxGetChatTranscriptRetriesOnFailure},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GetChatTokenTimeBetweenRetriesOnFailure",{get:function(){return t.configuration.getChatTokenTimeBetweenRetriesOnFailure},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShouldOverrideWebChatStyles",{get:function(){return t.configuration.shouldOverrideWebChatStyles},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WebChatStyles",{get:function(){return t.configuration.webChatStyles},enumerable:!0,configurable:!0}),Object.defineProperty(t,"popOutWindowWidthScaleFactor",{get:function(){return t.configuration.popOutWindowWidthScaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t,"popOutWindowHeightScaleFactor",{get:function(){return t.configuration.popOutWindowHeightScaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MaxCharactersLimit",{get:function(){return t.configuration.maxCharactersLimit},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PersistentChatTokenUpdateTime",{get:function(){return t.configuration.persistentChatTokenUpdateTime},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShouldLoadAcsChatAdapter",{get:function(){return t.configuration.loadAcsChatAdapter},enumerable:!0,configurable:!0}),t.defaultConfiguration={ariaTelemetryKey:null,collectorUriForTelemetry:null,ariaTelemetryApplicationName:"OmniChannelProd_Web",consoleLogLevels:["DEBUG","ERROR","INFO","WARN"],telemetryLogLevels:["DEBUG","ERROR","INFO","WARN"],ocfeaturesState:{ShowWelcomeScreen:!0,ShowPrechatScreen:!0,ShowFileAttachmentButton:!0,CallingAsEscalateChannel:!0,NewLineMarkdownSupport:!1,InlinePlaying:!0,MakrdownMessageFormatting:!0},initTimeout:1e4,initRetryCount:35,initTimeBetweenRetry:1500,getChatTokenTimeout:6e4,getChatTokenRetryCount:35,getChatTokenTimeBetweenRetry:1500,getChatTranscriptTimeout:1e4,getChatTranscriptRetryCount:5,getChatTranscriptTimeBetweenRetry:1500,bufferInvalidationTimeForToken:120,tokenRefreshTime:36e5,configExpiryTime:9e5,omnichannelSdkVersion:"0.1.2-main.5d0988c",webChatSdkVersion:"4.14.1",webChatIC3AdapterVersion:"0.1.0-master.2dba07b",ic3ClientVersion:"2021.08.14.1",amsClientVersion:"0.1.0-main.ef0152f",useWebChat:!1,useCachedConfig:!1,enableDebug:!1,enableTypingIndicator:!1,bootstrapperPromiseStateCheckInterval:50,chatAdapterFirstMessagePollingInterval:1e3,loaderPromiseStateCheckInterval:50,maxGetChatTokenRetriesOnFailure:3,maxGetChatTranscriptRetriesOnFailure:1,getChatTokenTimeBetweenRetriesOnFailure:1e4,shouldOverrideWebChatStyles:!1,persistentChatTokenUpdateTime:216e5,popOutWindowWidthScaleFactor:.3,popOutWindowHeightScaleFactor:.7,webChatStyles:{rootHeight:"84.8%",backgroundColor:"White",bubbleBackground:"White",bubbleBorderRadius:8,bubbleBorderWidth:0,bubbleFromUserBackground:"#F1F1F4",bubbleFromUserBorderRadius:8,bubbleFromUserBorderWidth:1,bubbleFromUserTextColor:"Black",bubbleImageHeight:240,bubbleMaxWidth:480,bubbleMinHeight:40,bubbleMinWidth:250,receivedMesageTextColor:"White",bubbleTextColor:"Black",sendBoxTextWrap:!0,sendBoxMaxHeight:96,sendBoxBackground:"#F1F1F4",hideUploadButton:!1,fontSizeSmall:"60%"},maxCharactersLimit:6e3,loadAcsChatAdapter:!0},t}();n.ConfigurationManager=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){}return i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.getLiveChatConfigAndApply=function(){var i=this;return new Promise(function(r,u){var o=t.Bootstrapper.bypassChatConfigCache,h=!o&&t.ConfigurationManager.UseCachedConfig,e=null,f,s;if(h&&(e=i.tryGetAndApplyConfigFromCache()),e){r(e);return}f=n.Omnichannel.LiveChatWidget.Util.newGuid();t.Bootstrapper.debugInfo.addConfigRequestId(f);s=t.Util.timer();t.OmnichannelProxy.getInstance().getChatConfiguration(f,o).then(function(n){var u,e,o;n.headers&&n.headers[t.Constants.Date]?(u=Date.parse(n.headers[t.Constants.Date])/1e3,e=Date.now()/1e3,t.Bootstrapper.timeDifference=u-e,n.timeDifference=u-e):(n.timeDifference=0,t.Bootstrapper.timeDifference=0);o=i.transformConfigAndApply(n);t.ContextSpecificDataStore.PersistData(t.DataContextTypes.WidgetOrganization,t.WidgetDataKeys.ConfigData,o,t.ConfigurationManager.ConfigExpiryTime);t.TelemetryClient.info({Event:t.TelemetryEvent.GetSystemConfigSuccess,RequestId:f,ElapsedTimeInMilliseconds:s.milliSecondsElapsed});r(o)}).catch(function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.GetSystemConfigFailure,RequestId:f,CloudType:t.Bootstrapper.environmentVersion,ExceptionDetails:n});u(n)})})},i.prototype.validateLiveChatConfig=function(n){return new Promise(function(i,r){t.Util.isNullOrUndefined(n)?r(new Error("Live Chat Config is null")):i(n)})},i.prototype.validateWidgetLocations=function(n){var i=this;return new Promise(function(r,u){var e=t.Bootstrapper.hostName?t.Bootstrapper.hostName:window.location.host,f;!t.Util.isNullOrUndefinedOrEmptyArray(n.validLocations)&&t.Util.isNullOrUndefined(i.getValidLocationForCurrentDomain(n.validLocations,e))?(f=new Error("No valid locations matched current domain"),t.TelemetryClient.error({Event:t.TelemetryEvent.InvalidDomain,CloudType:t.Bootstrapper.environmentVersion,ExceptionDetails:f}),u(f)):t.TelemetryClient.info({Event:t.TelemetryEvent.ValidDomain,CloudType:t.Bootstrapper.environmentVersion});r(n)})},i.prototype.saveLiveChatConfig=function(n){t.Bootstrapper.lcConfig=n},i.prototype.tryGetAndApplyConfigFromCache=function(){var i=t.ContextSpecificDataStore.GetData(t.DataContextTypes.WidgetOrganization,t.WidgetDataKeys.ConfigData),n;return t.Util.isNullOrUndefined(i)?null:(n=i,t.Bootstrapper.widgetThemeColor?(n.chatButtonColor=t.Bootstrapper.widgetThemeColor,n.bubbleColor=t.Bootstrapper.widgetThemeColor,n.chatTitleColor=t.Bootstrapper.widgetThemeColor):t.Bootstrapper.widgetThemeColor=n.chatButtonColor,t.Bootstrapper.timeDifference=i.timeDifference,i)},i.prototype.getValidLocationForCurrentDomain=function(n,i){var r,u,f;if(t.Util.isNullOrUndefined(n)||t.Util.isNullOrEmptyString(i))return null;for(r=0;r<n.length;r++)if(u=n[r],f=new RegExp(u.location),i.match(f))return u;return null},i.prototype.transformConfigAndApply=function(n){var i=new t.LiveChatConfig;return i.chatButtonIconUrl=n.LiveWSAndLiveChatEngJoin.msdyn_avatarurl,i.isDownloadTranscriptEnabled=this.getDownloadTranscriptFlag(n.LiveWSAndLiveChatEngJoin.msdyn_enablechattranscriptdownload),i.isEmailTranscriptEnabled=this.getEmailTranscriptFlag(n.LiveWSAndLiveChatEngJoin.msdyn_enablechattranscriptemail),i.autoDetectLanguage=this.getAutoDetectLocaleFlag(n.LiveWSAndLiveChatEngJoin.msdyn_autodetectlanguage),i.outOfOperatingHours=this.getOutOfOperatingHoursFlag(n.LiveWSAndLiveChatEngJoin.OutOfOperatingHours),i.outsideOperatingHoursTitle=this.getOutsideOperatingHoursTitle(n.LiveChatConfigOperatingHoursSettings),i.defaultLocale=t.Constants.DefaultLocale,i.enableMarkdown=this.getEnableMarkdownFlag(n.msdyn_enablemarkdown),i.autoDetectLanguage?(i.chatWidgetLocale=t.Constants.supportedLocales.indexOf(document.documentElement.lang.toLowerCase())>-1?document.documentElement.lang.toLowerCase():t.Constants.supportedLocales.indexOf(navigator.language.toLowerCase())==-1?i.defaultLocale:navigator.language.toLowerCase(),i.chatWidgetLocaleLCID=i.chatWidgetLocale?this.getValueReverse(t.Constants.OptionSetMapping,i.chatWidgetLocale.toLowerCase()):t.Constants.DefaultLocaleLCID):(i.chatWidgetLocaleLCID=n.ChatWidgetLanguage&&n.ChatWidgetLanguage.msdyn_localeid?n.ChatWidgetLanguage.msdyn_localeid:t.Constants.DefaultLocaleLCID,i.chatWidgetLocale=n.ChatWidgetLanguage&&n.ChatWidgetLanguage.msdyn_localeid?this.getValue(t.Constants.OptionSetMapping,n.ChatWidgetLanguage.msdyn_localeid):i.defaultLocale,t.Util.isNullOrUndefined(i.chatWidgetLocale)&&(i.chatWidgetLocale=i.defaultLocale)),this.populateOfflineProps(i,n),i.chatButtonPosition=this.getValue(t.Constants.OptionSetMapping,n.LiveWSAndLiveChatEngJoin.msdyn_widgetposition),i.hideWidget=!this.getWidgetVisibility(n.LiveWSAndLiveChatEngJoin.ShowWidget),i.outsideOperatingHoursSubtitle=this.getOutsideOperatingHoursSubtitle(n.LiveChatConfigOperatingHoursSettings),i.isPreChatEnabled=n.LiveWSAndLiveChatEngJoin.msdyn_prechatenabled==="true"||n.LiveWSAndLiveChatEngJoin.msdyn_prechatenabled===!0,i.isPostChatEnabled=n.LiveWSAndLiveChatEngJoin.msdyn_postconversationsurveyenable==="true"||n.LiveWSAndLiveChatEngJoin.msdyn_postconversationsurveyenable===!0,i.postChatSurveyMode=n.LiveWSAndLiveChatEngJoin.msdyn_postconversationsurveymode,i.postChatBotSurveyMode=n.LiveWSAndLiveChatEngJoin.msdyn_postconversationsurveybotsurveymode,i.isVisualNotificationsEnabled=this.getVisualNotificationsFlag(n.LiveWSAndLiveChatEngJoin.msdyn_widgetvisualnotification),i.postChatSurveyIdentifier=n.LiveWSAndLiveChatEngJoin.msfp_sourcesurveyidentifier,i.postChatSurveyOwnerId=n.LiveWSAndLiveChatEngJoin.postConversationSurveyOwnerId,i.postChatBotSurveyIdentifier=n.LiveWSAndLiveChatEngJoin.msfp_botsourcesurveyidentifier,i.postChatBotSurveyOwnerId=n.LiveWSAndLiveChatEngJoin.postConversationBotSurveyOwnerId,i.validLocations=t.Util.transformLiveChatWidgetLocations(n.LiveWSAndLiveChatEngJoin.LiveChatEngAndLiveChatLocJoin),i.requestVisitorLocation=this.getLocationDetectionFlag(n.LiveWSAndLiveChatEngJoin.msdyn_requestvisitorlocation),i.isReconnectEnabled=n.LiveWSAndLiveChatEngJoin.msdyn_enablechatreconnect&&(n.LiveWSAndLiveChatEngJoin.msdyn_enablechatreconnect==="true"||n.LiveWSAndLiveChatEngJoin.msdyn_enablechatreconnect===!0),i.reconnectRedirectionURL=n.LiveWSAndLiveChatEngJoin.msdyn_redirectionurl,n.LiveChatConfigAuthSettings&&(i.authClientFunction=n.LiveChatConfigAuthSettings.msdyn_javascriptclientfunction),i.isPersistentChat=n.LiveWSAndLiveChatEngJoin.msdyn_conversationmode&&n.LiveWSAndLiveChatEngJoin.msdyn_conversationmode===t.Constants.PersistentChatConversationMode,i.timeDifference=n.timeDifference,i.isPreChatEnabled&&n.LiveWSAndLiveChatEngJoin.PreChatSurvey&&n.LiveWSAndLiveChatEngJoin.PreChatSurvey.trim().length>0&&(i.preChatSurvey=JSON.parse(n.LiveWSAndLiveChatEngJoin.PreChatSurvey)),i.isAudioNotificationEnabled=!1,t.Util.isNullOrUndefined(n.LiveWSAndLiveChatEngJoin.msdyn_widgetsoundnotification)||(i.isAudioNotificationEnabled=n.LiveWSAndLiveChatEngJoin.msdyn_widgetsoundnotification.trim().toLowerCase()==="true"),i.disableEmoticon=!0,i.audioNotificationUrl=t.Constants.AudioNotificationPath,i.canUploadFile=t.FeaturesManager.shouldEnableFileAttachment()?this.getFileAttachmentsFlag(n.LiveWSAndLiveChatEngJoin.msdyn_enablefileattachmentsforcustomers):!1,t.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&(i.callingOptions=this.getCallingValue(t.Constants.CallingOptionSetMapping,n.LiveWSAndLiveChatEngJoin.msdyn_callingoptions)),i.enableCalling=t.FeaturesManager.shouldEnableCallingAsEscalateChannel()?n.LiveWSAndLiveChatEngJoin.msdyn_callingoptions===t.CallingOptionsOptionSetNumber.VideoAndVoiceCalling||n.LiveWSAndLiveChatEngJoin.msdyn_callingoptions===t.CallingOptionsOptionSetNumber.VoiceOnly:!1,i.shouldEnableVerboseLevelACSCallingLogs=n.ShouldEnableVerboseLevelACSCallingLogs,i.fileExtensions=n.allowedFileExtensions,i.fileSize=n.maxUploadFileSize,n.DataMaskingInfo&&(i.maskingInfo=n.DataMaskingInfo),n.maskingRules&&(i.maskingInfo||(i.maskingInfo={dataMaskingRules:{},setting:{msdyn_maskforagent:null,msdyn_maskforcustomer:null}}),Array.isArray(n.maskingRules)&&n.maskingRules.forEach(function(n){i.maskingInfo.dataMaskingRules[n.ruleId]=n.regex})),i.isProactiveChatEnabled=!1,t.Util.isNullOrUndefined(n.LiveWSAndLiveChatEngJoin.msdyn_proactivechatenabled)||(n.LiveWSAndLiveChatEngJoin.msdyn_proactivechatenabled===!0||n.LiveWSAndLiveChatEngJoin.msdyn_proactivechatenabled==="true")&&(i.isProactiveChatEnabled=!0),n.LiveChatVersion&&(i.liveChatVersionNumber=n.LiveChatVersion),i},i.prototype.getValue=function(n,t){for(var i=0;i<n.length;i++)if(n[i].OptionSetSelectedValue===t)return n[i].OptionSetConfigValue;return null},i.prototype.getWidgetThemeColor=function(n,i){return t.Bootstrapper.widgetThemeColor||(t.Bootstrapper.widgetThemeColor=this.getValue(n,i)),t.Bootstrapper.widgetThemeColor},i.prototype.getCallingValue=function(n,t){for(var i=0;i<n.length;i++)if(n[i].CallingOptionSetSelectedValue===t)return n[i].CallingOptionSetConfigValue;return null},i.prototype.getValueReverse=function(n,t){for(var i=0;i<n.length;i++)if(n[i].OptionSetConfigValue===t)return n[i].OptionSetSelectedValue;return null},i.prototype.getOutsideOperatingHoursTitle=function(n){return n&&!t.Util.isNullOrEmptyString(n.msdyn_offlinetitle)?n.msdyn_offlinetitle:null},i.prototype.getOutsideOperatingHoursSubtitle=function(n){return n&&!t.Util.isNullOrEmptyString(n.msdyn_offlinesubtitle)?n.msdyn_offlinesubtitle:null},i.prototype.transformMaskingRules=function(n){var i=[];return t.Util.isNullOrUndefined(n)||Object.keys(n).forEach(function(t){i.push({ruleId:t,regex:n[t]})}),i},i.prototype.transformMaskingInfo=function(n){var r=n.setting,i;return!t.Util.isNullOrUndefined(r)&&(i=!1,i=r.msdyn_maskforcustomer,!i)?null:this.transformMaskingRules(n.dataMaskingRules)},i.prototype.getVisualNotificationsFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.trim().toLowerCase()==="true"},i.prototype.getWidgetVisibility=function(n){return t.Util.isNullOrUndefined(n)||n.trim().toLowerCase()!=="false"},i.prototype.getFileAttachmentsFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.toLowerCase().trim()==="true"},i.prototype.getAutoDetectLocaleFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.toLowerCase().trim()==="true"},i.prototype.getDownloadTranscriptFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.toLowerCase().trim()==="true"},i.prototype.getEmailTranscriptFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.toLowerCase().trim()==="true"},i.prototype.getEnableMarkdownFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.toLowerCase().trim()==="true"},i.prototype.getLocationDetectionFlag=function(n){return t.Util.isNullOrUndefined(n)?(t.TelemetryClient.info({Event:t.TelemetryEvent.LocationDetectionFlagNotFound,CloudType:t.Bootstrapper.environmentVersion,ExceptionDetails:{ErrorDetails:"requestlocationdetection config parameter missing"}}),!1):n.toLowerCase().trim()==="true"},i.prototype.getOutOfOperatingHoursFlag=function(n){return!t.Util.isNullOrUndefined(n)&&n.toLowerCase().trim()==="true"},i.prototype.populateOfflineProps=function(n,i){n.offlineChatButtonTitle=i.LiveWSAndLiveChatEngJoin.msdyn_offlinewidgettitle;n.offlineChatButtonSubtitle=i.LiveWSAndLiveChatEngJoin.msdyn_offlinewidgetsubtitle;n.offlineChatTitleColor=this.getValue(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_offlinewidgetthemecolor);n.offlineBubbleColor=this.getValue(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_offlinewidgetthemecolor);n.offlineChatButtonColor=this.getValue(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_offlinewidgetthemecolor);n.offlineChatAvatarUrl=i.LiveWSAndLiveChatEngJoin.msdyn_offlineavatarurl;this.getOutOfOperatingHoursFlag(i.LiveWSAndLiveChatEngJoin.OutOfOperatingHours)?(n.chatButtonTitle=n.offlineChatButtonTitle,n.chatButtonSubtitle=n.offlineChatButtonSubtitle,n.chatTitleColor=this.getWidgetThemeColor(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_offlinewidgetthemecolor),n.bubbleColor=n.offlineBubbleColor,n.chatButtonColor=n.offlineChatButtonColor,n.chatAvatarUrl=n.offlineChatAvatarUrl):(n.chatButtonTitle=i.LiveWSAndLiveChatEngJoin.msdyn_widgettitle,n.chatButtonSubtitle=i.LiveWSAndLiveChatEngJoin.msdyn_widgetsubtitle,n.chatTitleColor=this.getWidgetThemeColor(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_widgetthemecolor),n.bubbleColor=this.getWidgetThemeColor(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_widgetthemecolor),n.chatButtonColor=this.getWidgetThemeColor(t.Constants.OptionSetMapping,i.LiveWSAndLiveChatEngJoin.msdyn_widgetthemecolor),n.chatAvatarUrl=i.LiveWSAndLiveChatEngJoin.msdyn_avatarurl)},i}();t.ConfigurationHelper=i})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.logClientSdkTelemetryEvent=function(t,i){switch(t){case n.LogLevel.DEBUG:n.TelemetryClient.debug(i,n.ScenarioType.OCSDK);break;case n.LogLevel.WARN:n.TelemetryClient.warn(i,n.ScenarioType.OCSDK);break;case n.LogLevel.ERROR:n.TelemetryClient.error(i,n.ScenarioType.OCSDK);break;case n.LogLevel.INFO:default:n.TelemetryClient.info(i,n.ScenarioType.OCSDK)}},t}();n.OmnichannelSDKLogger=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){this.defaultError=new Error("Omnichannel proxy not initialized")}return i.getInstance=function(){return this._instance||(this._instance=new i),this._instance},i.prototype.initialize=function(i,r){try{return this.proxy=n.CRM.Omnichannel.SDK.SDKProvider.getSDK(i,r,new t.OmnichannelSDKLogger),Promise.resolve()}catch(u){return Promise.reject("proxy init failed")}},i.prototype.getChatConfiguration=function(n,t){var i=this;return t===void 0&&(t=!1),new Promise(function(r,u){i.proxy?i.proxy.getChatConfig(n,t).then(function(n){r(n)}).catch(function(n){u(n)}):u(i.defaultError)})},i.prototype.getLWIDetails=function(n,t){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.getLWIDetails(n,t).then(function(n){i.lwiDetails=n;r(i.lwiDetails)}).catch(function(n){u(n)}):u(i.defaultError)})},i.prototype.getChatToken=function(n,t){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.getChatToken(n,t).then(function(n){i.chatConfig=n;r(i.chatConfig)}).catch(function(n){u(n)}):u(i.defaultError)})},i.prototype.validateAuthChatRecord=function(n,i){var r=this;return new Promise(function(u,f){r.proxy?r.proxy.validateAuthChatRecord(n,i).then(function(){u()}).catch(function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.ValidateAuthChatRecordFailed,ExceptionDetails:n});f(n)}):(t.TelemetryClient.error({Event:t.TelemetryEvent.ValidateAuthChatRecordFailed,ExceptionDetails:r.defaultError}),f(r.defaultError))})},i.prototype.getReconnectableChats=function(n){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.getReconnectableChats(n).then(function(n){r(n)}).catch(function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.GetReconnectableChatsFailed,ExceptionDetails:n});u(n)}):(t.TelemetryClient.error({Event:t.TelemetryEvent.GetReconnectableChatsFailed,ExceptionDetails:i.defaultError}),u(i.defaultError))})},i.prototype.getReconnectAvailability=function(n){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.getReconnectAvailability(n).then(function(n){r(n)}).catch(function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.GetReconnectAvailabilityFailed,ExceptionDetails:n});u(n)}):(t.TelemetryClient.error({Event:t.TelemetryEvent.GetReconnectAvailabilityFailed,ExceptionDetails:i.defaultError}),u(i.defaultError))})},i.prototype.sessionInit=function(n,i){var r=this;return new Promise(function(u,f){r.proxy?r.proxy.sessionInit(n,i).then(function(){u()}).catch(function(n){t.Util.isNullOrUndefined(n)||n.response.headers.errorcode!==t.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour?f(n):t.Bootstrapper.LiveChatConfiguration.hideWidget=!0}):f(r.defaultError)})},i.prototype.sessionClose=function(n,t){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.sessionClose(n,t).then(function(){r()}).catch(function(n){u(n)}):u(i.defaultError)})},i.prototype.submitPostChatResponse=function(n,t){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.submitPostChatResponse(n,t).then(function(){r()}).catch(function(n){u(n)}):u(i.defaultError)})},i.prototype.getSurveyInviteLink=function(n,i,r){var u=this;return new Promise(function(f,e){u.proxy?u.proxy.getSurveyInviteLink(n,i,r).then(function(n){t.TelemetryClient.info({Event:t.TelemetryEvent.GetSurveyInviteLinkSucceeded});f(n)}).catch(function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.GetSurveyInviteLinkFailed,ExceptionDetails:n});e(n)}):(t.TelemetryClient.error({Event:t.TelemetryEvent.GetSurveyInviteLinkFailed,ExceptionDetails:u.defaultError}),e(u.defaultError))})},i.prototype.getChatTranscripts=function(n,t,i,r){var u=this;return new Promise(function(f,e){u.proxy?u.proxy.getChatTranscripts(n,t,i,r).then(function(n){f(n)}).catch(function(n){e(n)}):e(u.defaultError)})},i.prototype.emailTranscript=function(n,t,i){var r=this;return new Promise(function(u,f){r.proxy?r.proxy.emailTranscript(n,t,i).then(function(){u()}).catch(function(n){f(n)}):f(r.defaultError)})},i.prototype.makeSecondaryChannelEventRequest=function(n,t,i){var r=this;return new Promise(function(u,f){r.proxy?r.proxy.makeSecondaryChannelEventRequest(n,t,i).then(function(){u()}).catch(function(n){f(n)}):f(r.defaultError)})},i.prototype.sendTypingIndicator=function(n,i,r){var u=this;return new Promise(function(f,e){u.proxy?u.proxy.sendTypingIndicator(n,i,r).then(function(){f()}).catch(function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.SendTypingIndicatorFailed,ExceptionDetails:n});e(n)}):(t.TelemetryClient.error({Event:t.TelemetryEvent.SendTypingIndicatorFailed,ExceptionDetails:u.defaultError}),e(u.defaultError))})},i.prototype.getAgentAvailability=function(n,t){var i=this;return new Promise(function(r,u){i.proxy?i.proxy.getAgentAvailability(n,t).then(function(n){r(n)}).catch(function(n){u(n)}):u(i.defaultError)})},i}();t.OmnichannelProxy=i})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={}));
/* LiveChatInitializer.min.js:end */


/* LiveChatLoader.min.js:start */
var __awaiter=this&&this.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=u[e[0]&2?"return":e[0]?"throw":"next"])&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[0,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Microsoft;(function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.logCallingSdkTelemetryEvent=function(t,i){switch(t){case n.LogLevel.DEBUG:n.TelemetryClient.debug(i,n.ScenarioType.CALLING);break;case n.LogLevel.WARN:n.TelemetryClient.warn(i,n.ScenarioType.CALLING);break;case n.LogLevel.ERROR:n.TelemetryClient.error(i,n.ScenarioType.CALLING);break;case n.LogLevel.INFO:default:n.TelemetryClient.info(i,n.ScenarioType.CALLING)}},t}();n.CallingSDKLogger=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))})(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getAudioNotificationAction=function(t){t===void 0&&(t=!1);return{src:t?n.ScriptPaths.AudioNotificationOnIconPath:n.ScriptPaths.AudioNotificationOffIconPath,title:t?n.Loader.Locale.AUDIO_NOTIFICATION_OFF_TOOLTIP_MESSAGE:n.Loader.Locale.AUDIO_NOTIFICATION_ON_TOOLTIP_MESSAGE,alt:"",name:n.DefaultActions.AudioNotification,id:n.HtmlIdNames.audioNotificationButton,onclick:this.toggleAudioNotification.bind(this)}},t.toggleAudioNotification=function(){},t}();n.AudioNotificationAction=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getDownloadTranscriptAction=function(t){t===void 0&&(t=!1);return{src:t?n.ScriptPaths.InAppTranscriptDownloadIconPath:n.ScriptPaths.TranscriptDownloadIconPath,title:n.Loader.Locale.DOWNLOAD_TRANSCRIPT_TOOLTIP_MESSAGE,alt:"",name:n.DefaultActions.DownloadTranscript,id:n.HtmlIdNames.downloadTranscriptButton,onclick:this.triggerDownload.bind(this)}},t.triggerDownload=function(){return __awaiter(this,void 0,void 0,function(){var e=this,r,u,f,t,i;return __generator(this,function(o){switch(o.label){case 0:return(r=n.Loader.currentConversation.chatId,u=n.Loader.currentConversation.token.chatToken,f=n.Util.newGuid(),t={currentLiveChatVersion:n.Loader.liveChatConfig.liveChatVersionNumber},!n.Loader.liveChatConfig.authClientFunction)?[3,2]:[4,n.AuthManager.acquireTokenFromAuthMethod()];case 1:i=o.sent();n.Util.isNullOrEmptyString(i)||(t.authenticatedUserToken=i);o.label=2;case 2:return n.OmnichannelProxy.getInstance().getChatTranscripts(f,r,u,t).then(function(t){var i;if(typeof t===n.Constants.String&&(t=JSON.parse(t)),n.Util.isNullOrUndefined(t[n.Constants.ChatMessagesJson]))n.NotificationHandler.notifyError(n.NotificationScenarios.DownloadTranscriptError,n.Loader.Locale.DOWNLOAD_TRANSCRIPT_FAILED_ERROR_MESSAGE);else{var u=btoa(encodeURIComponent(e.beautifyChatTranscripts(t[n.Constants.ChatMessagesJson]))),f=decodeURIComponent(atob(u)),r=new Blob([f],{type:"text/html;charset=utf-8"});navigator.appVersion.toString().indexOf(n.Constants.DotNet)>0?window.navigator.msSaveBlob(r,n.TranscriptConstants.ChatTranscriptDownloadFile):(i=document.createElement("a"),document.body.appendChild(i),i.setAttribute(n.HtmlAttributeNames.download,n.TranscriptConstants.ChatTranscriptDownloadFile),i.setAttribute(n.HtmlAttributeNames.href,URL.createObjectURL(r)),i.setAttribute(n.HtmlAttributeNames.ariaLabel,n.Loader.Locale.DOWNLOAD_TRANSCRIPT_TOOLTIP_MESSAGE),i.click())}}).catch(function(){n.NotificationHandler.notifyError(n.NotificationScenarios.DownloadTranscriptError,n.Loader.Locale.DOWNLOAD_TRANSCRIPT_FAILED_ERROR_MESSAGE)}),[2]}})})},t.beautifyChatTranscripts=function(i){var s=JSON.parse(i).reverse(),l=n.Loader.currentConversation.conversationStartTime,h="<body bgcolor='"+n.TranscriptConstants.ChatTranscriptsBodyColor+"'>",f="<\/div>",c="<div class='transcripts' style='width:80%;margin-left:10%;'>",e="",r=1,u="",o=0;return s.forEach(function(i){var l="6px",p="40px",s="User",w="U",b=!1,k=n.Constants.DefaultFileAttachmentName,h=n.Constants.CustomerDialogColor,a=n.Constants.CustomerFontColor,v,y,d,g;i.tags&&i.tags.toLowerCase().indexOf(n.Constants.SystemMessageTag)!==-1||i.isControlMessage&&i.isControlMessage===!0||i.contentType&&i.contentType.toLowerCase()===n.Constants.AdaptiveCardType||i.deliveryMode&&i.deliveryMode.toLowerCase()===n.Constants.InternalMode||(i.from&&(i.from.application?(s=i.from.application.displayName,h=n.Constants.AgentDialogColor,a=n.Constants.AgentFontColor,b=!0):i.from.guest?(s=i.from.guest.displayName,h=n.Constants.CustomerDialogColor):i.from.user&&(s=i.from.user.displayName,h=n.Constants.CustomerDialogColor),s=t.processDisplayName(s),w=t.constructIconName(s),i.attachments&&i.attachments.length>0&&i.attachments[0].name&&(k=i.attachments[0].name,i.content=n.Loader.Locale.DEFAULT_ATTACHMENT_MESSAGE+" "+k)),v=t.processCreatedDateTime(i.createdDateTime,o),y="",s!==u&&(p="0px",v="<b>"+s+" <\/b> "+t.processCreatedDateTime(i.createdDateTime,o),y="<div class='circle' style='display:inline-block;float:left;margin-right:5px;width:35px;height:35px;border-radius:20px;color:black;line-height:35px;text-align:center;background:"+h+";'>                                    <font tabindex ='"+r+"' color ="+a+" style='font-family:Segoe UI,SegoeUI,Helvetica Neue,Helvetica,Arial,sans-serif;'>                                        "+w+"                                    <\/font>                                    <\/div>",r++),s!==u&&(u===""&&(l="0px"),u!==""&&(l="20px")),d="<div style='margin-right:-2px;margin-top:"+l+";margin-bottom:-2px;margin-left:42px;top:-2px;position:relative;'>                                            <font tabindex ='"+r+"' size = '1px' color='#000000' style='font-family:Segoe UI,SegoeUI,Helvetica Neue,Helvetica,Arial,sans-serif;font-weight:500;'>                                                "+v+"                                            <\/font>                                        <\/div>",r++,g="<div class='dialogbox' style='font-family:Segoe UI,SegoeUI,Helvetica Neue,Helvetica,Arial,sans-serif;word-break:break-word;min-height:20px;max-width:80%;display:inline-block;margin-left:"+p+";padding: 10px; background-color:"+h+"; border-radius: 0px 12px 12px 12px; left: 3px; top: 2px; '>",e=e+c+y+d+g+"<font tabindex= '"+r+++"' color ="+a+">"+t.processContent(i.content,b)+"<\/font>"+f+f,u=s,o++)}),"<!DOCTYPE html><html><meta charset='UTF-8'>"+h+"<div class='allTranscripts' style='max-width:60%;min-width:30%;margin-left:20%;background-color:#FFFFFF;'>"+e+f+"<\/body><\/html>"},t.processDisplayName=function(n){var t=n.match(".+:.+");return n.indexOf("teamsvisitor")>=0&&t&&t.length>0&&(n="Customer"),n},t.constructIconName=function(n){if(!n)return"";var i="C",t=n.split(" ");return t.length>1?i=t[0][0]+t[1][0]:t.length==1&&(i=t[0][0]),i},t.processCreatedDateTime=function(t,i){var f=new Date(t),e=f.toLocaleTimeString(n.Bootstrapper.LiveChatConfiguration.chatWidgetLocale,{hour:"2-digit",minute:"2-digit"}),r=e.split(" "),u="";return(r&&r.length>1&&(u=r[0]+" "+r[1]),i==0)?f.toLocaleDateString("en-us")+" "+u:u},t.processContent=function(t,i){if(t.toString().toLowerCase().indexOf(n.TranscriptConstants.TranscriptMessageEmojiMessageType)>=0){var r=t.match('<img src="http.*://.+/objects/.+/views.+">');r&&r.length>0&&t.toString().toLowerCase().indexOf(r[0])>=0&&(t=t.replace(r[0],""))}return!i&&t.toString().toLowerCase().indexOf("a href")>=0&&t.toString().toLowerCase().indexOf("target")>=0&&(t=t.slice(0,t.toString().indexOf("target"))+" style='color:white' "+t.slice(t.toString().indexOf("target"))),n.FeaturesManager.shouldEnableMarkdownMessageFormatting()&&(t=n.WebChat.renderMarkDown(t)),t},t}();n.DownloadTranscriptAction=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getEmailTranscriptAction=function(t,i){i===void 0&&(i=!1);return{src:i?n.ScriptPaths.InAppTranscriptEmailIconPath:n.ScriptPaths.TranscriptEmailIconPath,title:n.Loader.Locale.EMAIL_TRANSCRIPT_BUTTON_TITLE,alt:n.Loader.Locale.ALT_IMAGE_TRANSCRIPT_EMAIL_ICON,name:n.DefaultActions.EmailTranscript,id:n.HtmlIdNames.emailTranscriptButton,onclick:t?t.bind(this):this.fallbackHandler.bind(this)}},t.fallbackHandler=function(){},t}();n.EmailTranscriptAction=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.getActionBarIcons=function(n){var t=this;return n.map(function(n){return t.getActionIcon(n)})},i.prototype.getActionIcon=function(t){var i=n.BrowserInfo.isEdge(),r=n.BrowserInfo.isChrome();return t.id===n.HtmlIdNames.audioNotificationButton?React.createElement(n.AudioNotification,{url:n.Constants.AudioNotificationPath}):React.createElement("div",{className:n.HtmlClassNames.actionBar+"-"+t.name+"-"+n.HtmlClassNames.actionBarIconContainer,role:i||r?null:n.HtmlAttributeNames.button,onClick:t.onclick.bind(this),onKeyDown:this.keyHandler.bind(this,t),"tooltip-title":t.title,"data-for":t.id},React.createElement(n.ToolTip,{targetId:t.id,delayHide:500}),React.createElement("button",{id:t.id,type:i?n.HtmlAttributeNames.button:null,className:n.HtmlClassNames.actionBar+"-"+t.name+"-"+n.HtmlClassNames.actionBarIconButton,"aria-label":t.title},React.createElement("img",{src:t.src,alt:t.alt,className:n.HtmlClassNames.actionBar+"-"+t.name+"-"+n.HtmlClassNames.actionBarIconImage})))},i.prototype.keyHandler=function(t,i){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&i.onclick()},i.prototype.render=function(){return React.createElement("div",{className:n.HtmlClassNames.actionBar,id:n.HtmlIdNames.actionBar,role:n.HtmlAttributeNames.region},React.createElement("div",{className:n.HtmlClassNames.actionBarIconsContainer,id:n.HtmlIdNames.actionBarIconsContainer},this.getActionBarIcons(this.props.enabledActions)))},i}(React.Component);n.ActionBar=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.EmailTranscript="EmailTranscript",n.DownloadTranscript="DownloadTranscript",n.AudioNotification="AudioNotification",n}();n.DefaultActions=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){var i=t.call(this)||this;return i.emailRegexp=null,i.emailRequestBody=new n.EmailRequestBody,i.state={showInvalidEmailAlert:!1,emailInputValue:"",disableSendButton:!0},i}return __extends(i,t),i.prototype.render=function(){return React.createElement("div",{className:n.HtmlClassNames.emailTranscriptDialogContainer,id:n.HtmlIdNames.emailTranscriptDialogContainer,onKeyDown:this.onEscapeKeyDown.bind(this)},React.createElement("div",{className:n.HtmlClassNames.emailTranscriptDialog},React.createElement("div",{className:n.HtmlClassNames.emailTranscriptDialogContentContainer},React.createElement("h1",{className:n.HtmlClassNames.emailTranscriptDialogTitle},n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_TITLE),React.createElement("p",{className:n.HtmlClassNames.emailTranscriptDialogTextContent},n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_DESCRIPTION),React.createElement("div",{className:n.HtmlClassNames.emailTranscriptDialogTextFieldContainer},React.createElement("input",{className:n.HtmlClassNames.emailTranscriptDialogTextField,id:n.HtmlIdNames.emailTranscriptDialogTextField,"aria-label":n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_INPUT_LABEL,value:this.state.emailInputValue,onChange:this.onInputChange.bind(this),onKeyDown:this.inputKeyDownHandler.bind(this),style:{border:this.state.showInvalidEmailAlert?n.HtmlCssConstants.invalidEmailBorder+n.TranscriptConstants.ErrorConditionDefaultColor:""}}),this.state.showInvalidEmailAlert&&React.createElement("div",{className:n.HtmlClassNames.emailTranscriptDialogInvalidEmail,role:n.Constants.HTMLConstants.alert,tabIndex:-1},n.Loader.Locale.EMAIL_ADDRESS_NOT_VALID_ERROR_MESSAGE))),React.createElement("div",{className:n.HtmlClassNames.emailTranscriptDialogButtons},React.createElement("button",{type:n.HtmlAttributeNames.button,className:n.HtmlClassNames.emailTranscriptDialogActionButtonSend,title:n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_SEND_REQUEST_BUTTON,"aria-label":n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_SEND_REQUEST_BUTTON,disabled:this.state.disableSendButton,style:{marginTop:this.state.showInvalidEmailAlert?n.TranscriptConstants.ErrorConditionButtonsMarginTop:"",backgroundColor:this.state.disableSendButton?n.TranscriptConstants.DisabledSendButtonBackgroundColor:n.Bootstrapper.widgetThemeColor,color:this.state.disableSendButton?n.TranscriptConstants.DisabledSendButtonTextColor:n.TranscriptConstants.EnabledSendButtonTextColor},onClick:this.sendEmailRequestButtonEvents.bind(this,n.Util.newGuid(),n.Loader.currentConversation.chatId,this.state.emailInputValue)},n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_SEND_REQUEST_BUTTON),React.createElement("button",{type:n.HtmlAttributeNames.button,className:n.HtmlClassNames.emailTranscriptDialogActionButtonCancel,title:n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_CANCEL_REQUEST_BUTTON,"aria-label":n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_CANCEL_REQUEST_BUTTON,onClick:this.hideEmailRequest.bind(this),style:{marginTop:this.state.showInvalidEmailAlert?n.TranscriptConstants.ErrorConditionButtonsMarginTop:""}},n.Loader.Locale.EMAIL_TRANSCRIPT_DIALOG_CANCEL_REQUEST_BUTTON))))},i.prototype.componentDidMount=function(){var t,r,u,i;if(n.Utility.preventFocusToMoveOutOfElement(n.HtmlIdNames.emailTranscriptDialogContainer),n.Utility.focusOnElement(n.HtmlIdNames.emailTranscriptDialogTextField),n.Util.isNullOrEmptyString(this.state.emailInputValue)&&(t=n.Loader.initContext.preChatResponse,t))for(r=0,u=Object.keys(t);r<u.length;r++)i=u[r],this.getEmailRegex().test(t[i])&&this.setState({emailInputValue:t[i],disableSendButton:!t[i]||t[i]===""})},i.prototype.inputKeyDownHandler=function(t){var i=t.keyCode;i===13&&this.sendEmailRequestButtonEvents(n.Util.newGuid(),n.Loader.currentConversation.chatId,this.state.emailInputValue)},i.prototype.onEscapeKeyDown=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ESC&&this.hideEmailRequest()},i.prototype.onInputChange=function(n){this.setState({emailInputValue:n.target.value,disableSendButton:!n.target.value||n.target.value===""});this.showInvalidEmailAlert(!1)},i.prototype.hideEmailRequest=function(){this.props.onDialogHide();this.setState({emailInputValue:""});n.Utility.focusOnElement(n.HtmlIdNames.emailTranscriptButton)},i.prototype.showInvalidEmailAlert=function(n){this.setState({showInvalidEmailAlert:n})},i.prototype.sendEmailRequestButtonEvents=function(t,i,r){this.getEmailRegex().test(r)?this.sendEmailRequest(n.Util.newGuid(),n.Loader.currentConversation.chatId,this.state.emailInputValue):this.showInvalidEmailAlert(!0)},i.prototype.getEmailRegex=function(){return this.emailRegexp||(this.emailRegexp=new RegExp(n.TranscriptConstants.EmailRegex)),this.emailRegexp},i.prototype.sendEmailRequest=function(t,i,r){this.hideEmailRequest();n.Bootstrapper.debugInfo.addSendEmailTranscriptRequestId(t);this.emailRequestBody.ChatId=i;this.emailRequestBody.EmailAddress=r;this.emailRequestBody.DefaultAttachmentMessage=n.Loader.Locale.DEFAULT_ATTACHMENT_MESSAGE;this.emailRequestBody.CustomerLocale=n.Bootstrapper.LiveChatConfiguration.chatWidgetLocale;var u=n.Loader.currentConversation.token.chatToken;return n.OmnichannelProxy.getInstance().emailTranscript(t,u,this.emailRequestBody).catch(function(){n.NotificationHandler.notifyError(n.NotificationScenarios.EmailTranscriptError,n.Loader.Locale.SEND_EMAIL_TRANSCRIPT_REQUEST_FAIL_ERROR_MESSAGE)})},i}(React.Component);n.EmailRequestDialog=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){}return i.prototype.init=function(n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(r){switch(r.label){case 0:return(!t.Util.isNullOrUndefined(n)&&!t.Util.isNullOrUndefined(n.token)&&!t.Util.isNullOrEmptyString(n.token.chatToken)&&!t.Util.isNullOrUndefined(n.attachmentConfiguration)&&!t.Util.isNullOrEmptyString(n.attachmentConfiguration.AttachmentServiceEndpoint)&&!t.Util.isNullOrEmptyString(n.chatId))?(i={ams:n.attachmentConfiguration.AttachmentServiceEndpoint},this.omnichannelChatToken={chatId:n.chatId,regionGTMS:i,token:n.token.chatToken},this.amsConfig={framedMode:!0},[4,this.initializeAMSClient(this.amsConfig,this.omnichannelChatToken)]):[3,2];case 1:return r.sent(),[3,3];case 2:t.TelemetryClient.error({Event:t.TelemetryEvent.InitializeAMSClientFailed,ExceptionDetails:{ErrorDescription:"Failed to initialize AMS Client due to invalid arguments."}});r.label=3;case 3:return[2]}})})},i.prototype.uploadFiles=function(n){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(){if(t.Util.isNullOrUndefined(n))return t.TelemetryClient.error({Event:t.TelemetryEvent.UploadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Unable to process upload due to invalid argument"}}),[2];try{return[2,Promise.all(n.map(function(n){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(){return[2,this.uploadFileToAMS(n)]})})}))]}catch(r){t.TelemetryClient.error({Event:t.TelemetryEvent.UploadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Failed to upload attachments to AMS",Error:r}})}return[2]})})},i.prototype.downloadFiles=function(n){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(){if(t.Util.isNullOrUndefined(n))return t.TelemetryClient.error({Event:t.TelemetryEvent.DownloadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Unable to process download due to invalid argument"}}),[2];try{return[2,Promise.all(n.map(function(n){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(){return[2,this.downloadFileFromAMS(n)]})})}))]}catch(r){t.TelemetryClient.error({Event:t.TelemetryEvent.DownloadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Failed to download attachment from AMS",Error:r}})}return[2]})})},i.prototype.getFileIds=function(n){if(!t.Util.isNullOrUndefined(n)&&!t.Util.isNullOrUndefined(n.amsReferences))try{return JSON.parse(n.amsReferences)}catch(i){t.TelemetryClient.error({Event:t.TelemetryEvent.GetFileIdsFromChatMetadataFailed,ExceptionDetails:{ErrorDescription:"Failed to parse File Ids from ChatMessage metadata.",Error:i}})}},i.prototype.createFileIdProperty=function(n){if(!t.Util.isNullOrUndefined(n))try{return{amsReferences:JSON.stringify(n)}}catch(i){t.TelemetryClient.error({Event:t.TelemetryEvent.CreateChatMetadataForFileIdsFailed,ExceptionDetails:{ErrorDescription:"Failed to create ChatMessage metadata for File Ids.",Error:i}})}},i.prototype.getFileMetadata=function(n){if(!t.Util.isNullOrUndefined(n)&&!t.Util.isNullOrUndefined(n.amsMetadata))try{return JSON.parse(n.amsMetadata)}catch(i){t.TelemetryClient.error({Event:t.TelemetryEvent.GetFileMetadataFromChatMetadataFailed,ExceptionDetails:{ErrorDescription:"Failed to parse File metadata from ChatMessage metadata.",Error:i}})}},i.prototype.createFileMetadataProperty=function(n){if(!t.Util.isNullOrUndefined(n))try{return{amsMetadata:JSON.stringify(n)}}catch(i){t.TelemetryClient.error({Event:t.TelemetryEvent.CreateChatMetadataForFileMetadataFailed,ExceptionDetails:{ErrorDescription:"Failed to create ChatMessage metadata for File metadata.",Error:i}})}},i.prototype.uploadFileToAMS=function(n){return __awaiter(this,void 0,void 0,function(){var u,f,r,i,e;return __generator(this,function(o){switch(o.label){case 0:return(o.trys.push([0,8,,9]),u=t.Util.timer(),!(!t.Util.isNullOrEmptyString(n.contentUrl)&&!t.Util.isNullOrEmptyString(n.name)&&!t.Util.isNullOrEmptyString(n.contentType)))?[3,6]:[4,this.amsClient.fetchBlob(n.contentUrl)];case 1:return f=o.sent(),[4,this.ConvertBlobToFile(f,n.name,n.contentType)];case 2:return r=o.sent(),[4,this.amsClient.createObject(this.omnichannelChatToken.chatId,r,this.omnichannelChatToken)];case 3:return(i=o.sent(),!(i!=null&&i.id!=null))?[3,5]:[4,this.amsClient.uploadDocument(i.id,r,this.omnichannelChatToken)];case 4:return o.sent(),t.TelemetryClient.info({ElapsedTimeInMilliseconds:u.milliSecondsElapsed,Event:t.TelemetryEvent.UploadAttachmentSucceeded,Description:"Attachement is successfully uploaded to AMS with Object Id: "+i.id+" and Content-Type: "+n.contentType}),[2,{fileId:i.id,metadata:{contentType:n.contentType,fileName:n.name}}];case 5:return[3,7];case 6:t.TelemetryClient.error({Event:t.TelemetryEvent.UploadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Unable to process upload due to file metadata was invalid."}});o.label=7;case 7:return[3,9];case 8:return e=o.sent(),t.TelemetryClient.error({Event:t.TelemetryEvent.UploadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Failed to upload attachment with Content Type: "+n.contentType,Error:e}}),[3,9];case 9:return[2]}})})},i.prototype.downloadFileFromAMS=function(n){return __awaiter(this,void 0,void 0,function(){var u,i,r,f,e;return __generator(this,function(o){switch(o.label){case 0:return(o.trys.push([0,7,,8]),u=t.Util.timer(),!(!t.Util.isNullOrEmptyString(n.fileId)&&!t.Util.isNullOrUndefined(n.metadata)&&!t.Util.isNullOrEmptyString(n.metadata.fileName)&&!t.Util.isNullOrEmptyString(n.metadata.contentType)&&n.metadata.contentType.indexOf("/")!==-1))?[3,5]:(i={id:n.fileId,type:n.metadata.contentType.split("/").pop()},[4,this.amsClient.getViewStatus(i,this.omnichannelChatToken)]);case 1:return(r=o.sent(),!!t.Util.isNullOrUndefined(r))?[3,4]:[4,this.amsClient.getView(i,r.view_location,this.omnichannelChatToken)];case 2:return f=o.sent(),t.TelemetryClient.info({ElapsedTimeInMilliseconds:u.milliSecondsElapsed,Event:t.TelemetryEvent.DownloadAttachmentSucceeded,Description:"Attachement is successfully downloaded from AMS with Object Id: "+n.fileId+" and Content-Type: "+n.metadata.contentType}),[4,this.ConvertBlobToFile(f,n.metadata.fileName,n.metadata.contentType)];case 3:return[2,o.sent()];case 4:return[3,6];case 5:t.TelemetryClient.error({Event:t.TelemetryEvent.DownloadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Unable to process download due to file metadata was invalid."}});o.label=6;case 6:return[3,8];case 7:return e=o.sent(),t.TelemetryClient.error({Event:t.TelemetryEvent.DownloadAttachmentFailed,ExceptionDetails:{ErrorDescription:"Failed to download attachment with Object Id: "+n.fileId+" and Content-Type: "+n.metadata.contentType,Error:e}}),[3,8];case 8:return[2]}})})},i.prototype.ConvertBlobToFile=function(n,i,r){if(t.Util.isNullOrUndefined(n))throw new Error("Blob is null or undefined");var u=null;try{u=new File([n],i,{type:r})}catch(f){typeof Object.assign!="function"&&(Object.assign=function(n){"use strict";var i,t,r,f,u;if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(n=Object(n),i=1;i<arguments.length;i++)if(t=arguments[i],t!=null)for(r=0,f=t;r<f.length;r++)u=f[r],Object.prototype.hasOwnProperty.call(t,u)&&(n[u]=t[u]);return n});n[t.Constants.AttachmentFileNameAttribute]=i;u=Object.assign(n,{type:r})}return u},i.prototype.initializeAMSClient=function(i,r){return __awaiter(this,void 0,void 0,function(){var e=this,u,f;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,n.CRM.Omnichannel.AMS.SDK.createAMSClient(i).then(function(n){e.amsClient=n})];case 1:return o.sent(),u={chatToken:r},[4,this.amsClient.initialize(u)];case 2:return o.sent(),t.TelemetryClient.info({Event:t.TelemetryEvent.InitializeAMSClientSucceeded,Description:"AMS Client Initialization was successful"}),[3,4];case 3:return f=o.sent(),t.TelemetryClient.error({Event:t.TelemetryEvent.InitializeAMSClientFailed,ExceptionDetails:{ErrorDescription:"Failed to initialize AMS Client",Error:f}}),[3,4];case 4:return[2]}})})},i}();t.AMSFileManager=i})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){var n=t.call(this)||this;return n.state={showVideoCallPopup:!1,showCallPopup:!1,showVoiceCallDialog:!1,showVideoCallDialog:!1,shouldNotShowVideoCallButton:!1,isRemoteVideoEnabled:!1,isLocalVideoEnabled:!1,isMicrophoneMuted:!1,handleCloseConfirmation:n.handleCloseConfirmation.bind(n),heightSet:n.setCallingContainerHeightBasedOnCalling.bind(n)},n}return __extends(i,t),i.prototype.componentDidMount=function(){this.props.liveChatConfig!==null&&(this.props.liveChatConfig.callingOptions===n.CallingOptions.VideoAndVoiceCalling||this.props.liveChatConfig.callingOptions===n.CallingOptions.VoiceOnly)&&this.loadCallingLibraries()},i.prototype.loadCallingLibraries=function(){var t=[];t=t.concat([{path:n.ScriptPaths.CallingLibraryPath,callback:this.load.bind(this),resourceType:n.ResourceType.Script}]);n.ResourceLoader.Load(t)},i.prototype.setCallPopupState=function(){n.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&(this.props.liveChatConfig.callingOptions===n.CallingOptions.VoiceOnly?this.setState({showCallPopup:!0,showVideoCallPopup:!1,heightSet:this.setCallingContainerHeightBasedOnCalling(!1,!1,!0,!1)}):this.props.liveChatConfig.callingOptions===n.CallingOptions.VideoAndVoiceCalling?this.setState({showCallPopup:!1,showVideoCallPopup:!0,heightSet:this.setCallingContainerHeightBasedOnCalling(!1,!1,!1,!0)}):this.setState({showCallPopup:!1,showVideoCallPopup:!1,heightSet:this.setCallingContainerHeightBasedOnCalling(!1,!1,!1,!1)}),this.props.setWebChatHeightBasedOnCalling())},i.prototype.setLocalAndRemoteVideo=function(){if(n.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&this.props.liveChatConfig.callingOptions===n.CallingOptions.VideoAndVoiceCalling){var r=this.getVoiceVideoCallingInstance().isRemoteVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),u=this.getVoiceVideoCallingInstance().isLocalVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),f=this.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),t=!1,i=!1;r===!1&&u===!1?(t=!0,i=!1):(t=!1,i=!0);this.refreshVoiceVideoCallDialog(!1,!1,t,i,f,r,u)}else if(n.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&this.props.liveChatConfig.callingOptions===n.CallingOptions.VoiceOnly){var r=!1,u=!1,f=this.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),t=!0,i=!1;this.refreshVoiceVideoCallDialog(!1,!1,t,i,f,r,u)}},i.prototype.closeCallingDialog=function(){if(n.FeaturesManager.shouldEnableCallingAsEscalateChannel()){var i=document.getElementById(n.HtmlIdNames.callingContainer),t=document.createElement(n.Constants.SpanAttributeName),r=n.HtmlIdNames.endedCall;t.setAttribute(n.Constants.IdAttributeName,r);t.textContent=this.props.locale.END_CALL_MESSAGE;i.appendChild(t);this.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1);setTimeout(function(){i.removeChild(document.getElementById(r))},40)}},i.prototype.clickVoiceCallAccept=function(){var t=this,i;n.TelemetryClient.info({Event:n.TelemetryEvent.VoiceCallAcceptButtonClick,CallId:n.Loader.currentConversation.callId,Description:"Voice call accepted button click"});i=n.SecondaryChannelEvents.Accept;n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||this.props.liveChatConfig.callingOptions!==n.CallingOptions.VoiceOnly?n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||this.props.liveChatConfig.callingOptions!==n.CallingOptions.VideoAndVoiceCalling||this.getVoiceVideoCallingInstance().acceptCall({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId,withVideo:!1}).then(function(){t.setState({showCallPopup:!1,showVideoCallPopup:!1,showVoiceCallDialog:!0,showVideoCallDialog:!1,shouldNotShowVideoCallButton:!1,isRemoteVideoEnabled:!1,isLocalVideoEnabled:!1,isMicrophoneMuted:t.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),heightSet:t.setCallingContainerHeightBasedOnCalling(!0,!1,!1,!1)});t.props.setWebChatHeightBasedOnCalling();n.Loader.handleSecondaryChannelEvent(n.SecondaryChannelType.Voice,i)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)}):this.getVoiceVideoCallingInstance().acceptCall({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId,withVideo:!1}).then(function(){t.setState({showCallPopup:!1,showVideoCallPopup:!1,showVoiceCallDialog:!0,showVideoCallDialog:!1,isRemoteVideoEnabled:!1,isLocalVideoEnabled:!1,shouldNotShowVideoCallButton:!0,isMicrophoneMuted:t.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),heightSet:t.setCallingContainerHeightBasedOnCalling(!0,!1,!1,!1)});n.Loader.handleSecondaryChannelEvent(n.SecondaryChannelType.Voice,i)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)})},i.prototype.clickCallReject=function(){var t=this,i=n.SecondaryChannelEvents.Reject,r;n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||(r=this.getVoiceVideoCallingInstance().isRemoteVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),this.getVoiceVideoCallingInstance().rejectCall({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}).then(function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1);r===!0?(n.TelemetryClient.info({Event:n.TelemetryEvent.VideoCallRejectButtonClick,CallId:n.Loader.currentConversation.callId,Description:"Call rejected button click"}),n.Loader.handleSecondaryChannelEvent(n.SecondaryChannelType.Video,i)):(n.TelemetryClient.info({Event:n.TelemetryEvent.VoiceCallRejectButtonClick,CallId:n.Loader.currentConversation.callId,Description:"Call rejected button click"}),n.Loader.handleSecondaryChannelEvent(n.SecondaryChannelType.Voice,i))},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)}))},i.prototype.clickVideoCallAccept=function(){var t=this,i;n.TelemetryClient.info({Event:n.TelemetryEvent.VideoCallAcceptButtonClick,CallId:n.Loader.currentConversation.callId,Description:"Video call accepted button click"});i=n.SecondaryChannelEvents.Accept;n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||this.getVoiceVideoCallingInstance().acceptCall({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId,withVideo:!0}).then(function(){t.setState({showCallPopup:!1,showVideoCallPopup:!1,showVoiceCallDialog:!1,showVideoCallDialog:!0,isRemoteVideoEnabled:t.getVoiceVideoCallingInstance().isRemoteVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),isLocalVideoEnabled:t.getVoiceVideoCallingInstance().isLocalVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),isMicrophoneMuted:t.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),heightSet:t.setCallingContainerHeightBasedOnCalling(!1,!0,!1,!1)});t.props.setWebChatHeightBasedOnCalling();n.Loader.handleSecondaryChannelEvent(n.SecondaryChannelType.Video,i)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)})},i.prototype.clickStopVoiceVideoCall=function(){var t=this,i;n.TelemetryClient.info({Event:n.TelemetryEvent.EndCallButtonClick,CallId:n.Loader.currentConversation.callId,Description:"End call button click"});n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||(i=n.Loader.currentConversation.token&&n.Loader.currentConversation.token.chatToken?!1:!0,this.getVoiceVideoCallingInstance().stopCall({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId,forEveryone:i}).then(function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)}))},i.prototype.onToggleLocalVideoButtonClick=function(){var t=this;n.TelemetryClient.info({Event:n.TelemetryEvent.ToggleCameraButtonClick,CallId:n.Loader.currentConversation.callId,Description:"Camera toggle button click"});n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||this.getVoiceVideoCallingInstance().toggleLocalVideo({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}).then(function(){var u=t.getVoiceVideoCallingInstance().isRemoteVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),f=t.getVoiceVideoCallingInstance().isLocalVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),e=t.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),i=!1,r=!1;u===!1&&f===!1?(i=!0,r=!1):(i=!1,r=!0);t.refreshVoiceVideoCallDialog(!1,!1,i,r,e,u,f)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)})},i.prototype.onToggleMuteButtonClick=function(){var t=this,i="";n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||this.getVoiceVideoCallingInstance().toggleMute({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}).then(function(r){i=r===n.Constants.Mute?"Toggle mute button clicked to mute call":"Toggle mute button clicked to unmute call";n.TelemetryClient.info({Event:n.TelemetryEvent.ToggleMuteButtonClick,CallId:n.Loader.currentConversation.callId,Description:i});var e=t.getVoiceVideoCallingInstance().isRemoteVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),o=t.getVoiceVideoCallingInstance().isLocalVideoEnabled({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),s=t.getVoiceVideoCallingInstance().isMicrophoneMuted({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId}),u=!1,f=!1;e===!1&&o===!1?(u=!0,f=!1):(u=!1,f=!0);t.refreshVoiceVideoCallDialog(!1,!1,u,f,s,e,o)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)})},i.prototype.refreshVoiceVideoCallDialog=function(n,t,i,r,u,f,e){this.setState({showVideoCallPopup:n,showCallPopup:t,showVoiceCallDialog:i,showVideoCallDialog:r,isMicrophoneMuted:u,isRemoteVideoEnabled:f,isLocalVideoEnabled:e,heightSet:this.setCallingContainerHeightBasedOnCalling(i,r,t,n)});this.props.setWebChatHeightBasedOnCalling()},i.prototype.handleCloseConfirmation=function(){n.Util.isNullOrUndefined(n.Loader.currentConversation.callId)||(this.state.showCallPopup===!0||this.state.showVideoCallPopup===!0?this.clickCallReject():(this.state.showVoiceCallDialog===!0||this.state.showVideoCallDialog===!0)&&this.clickStopVoiceVideoCall())},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.callingContainer,className:n.HtmlClassNames.callingContainer,"aria-live":n.HtmlClassNames.assertive},(this.state.showVoiceCallDialog||this.state.showVideoCallDialog||this.state.showCallPopup||this.state.showVideoCallPopup)&&React.createElement(n.CurrentCall,{locale:this.props.locale,acceptWithVideo:this.state.showVideoCallDialog,isVoiceOnly:this.state.shouldNotShowVideoCallButton,isRemoteVideoEnabled:this.state.isRemoteVideoEnabled,isLocalVideoEnabled:this.state.isLocalVideoEnabled,isMicrophoneMuted:this.state.isMicrophoneMuted,onVoiceVideoCallStopClick:this.clickStopVoiceVideoCall.bind(this),onToggleLocalVideoClick:this.onToggleLocalVideoButtonClick.bind(this),onToggleMuteClick:this.onToggleMuteButtonClick.bind(this),videoCallingEnabled:this.state.showVideoCallPopup,onCallReject:this.clickCallReject.bind(this),onVoiceCallAccept:this.clickVoiceCallAccept.bind(this),onVideoCallAccept:this.clickVideoCallAccept.bind(this),isIncomingCallPopup:this.state.showCallPopup||this.state.showVideoCallPopup}))},i.prototype.isCallingSDKLoaded=function(){return window["Microsoft.Omnichannel.Calling.SDK"]?!0:!1},i.prototype.getVoiceVideoCallingInstance=function(){return window["Microsoft.Omnichannel.Calling.SDK"].VoiceVideoCalling.getInstance()},i.prototype.load=function(){var t=this,i;n.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&this.isCallingSDKLoaded()&&(n.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&(n.Loader.currentConversation.token&&n.Loader.currentConversation.token.chatToken||n.Loader.currentConversation.voiceVideoCallToken&&n.Loader.currentConversation.voiceVideoCallToken.Token)?(i=n.Loader.currentConversation.voiceVideoCallToken&&n.Loader.currentConversation.voiceVideoCallToken.Token?n.Loader.currentConversation.voiceVideoCallToken.Token:n.Loader.currentConversation.token.chatToken,this.getVoiceVideoCallingInstance().load({logger:new n.CallingSDKLogger,shouldEnableVerboseLevelACSCallingLogs:this.props.liveChatConfig.shouldEnableVerboseLevelACSCallingLogs}).then(function(){t.getVoiceVideoCallingInstance().initialize({callClientName:n.Constants.ElevateToVoiceVideo,accesstoken:i,selfVideoHTMLElementId:n.Constants.SelfVideo,remoteVideoHTMLElementId:n.Constants.RemoteVideo}).then(function(){n.TelemetryClient.info({Event:n.TelemetryEvent.CallingSDKInitSuccess,Description:"Voice/Video calling SDK init success"});t.registerEventHandlers()},function(){n.TelemetryClient.error({Event:n.TelemetryEvent.CallingSDKInitFailed,Description:"Voice/Video calling SDK init failed"})});n.TelemetryClient.info({Event:n.TelemetryEvent.CallingSDKLoadSuccess,Description:"Voice/Video calling SDK load Success"})},function(){n.TelemetryClient.error({Event:n.TelemetryEvent.CallingSDKLoadFailed,Description:"Voice/Video calling SDK load failed"})})):n.TelemetryClient.error({Event:n.TelemetryEvent.CallingSDKLoadFailed,Description:"Voice/Video calling SDK load failed because FCB is not enabled"}))},i.prototype.registerEventHandlers=function(){var t=this;this.getVoiceVideoCallingInstance().registerEvent(n.Constants.CallAdded,function(i){var r=i.callId;n.Loader.currentConversation.callId=r;t.setCallPopupState()});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.LocalVideoStreamAdded,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&t.setLocalAndRemoteVideo()});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.LocalVideoStreamRemoved,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&t.setLocalAndRemoteVideo()});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.RemoteVideoStreamAdded,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&t.setLocalAndRemoteVideo()});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.RemoteVideoStreamRemoved,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&t.setLocalAndRemoteVideo()});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.CallDisconnected,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&(t.closeCallingDialog(),n.Loader.handleSecondaryChannelEvent(n.SecondaryChannelType.Voice,n.SecondaryChannelEvents.End));n.Loader.currentConversation.callId=null});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.ParticipantDisconnected,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&n.Loader.currentConversation.token&&n.Loader.currentConversation.token.chatToken&&t.getVoiceVideoCallingInstance().stopCall({callClientName:n.Constants.ElevateToVoiceVideo,callId:n.Loader.currentConversation.callId,forEveryone:!1}).then(function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)},function(){t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)})});this.getVoiceVideoCallingInstance().registerEvent(n.Constants.IncomingCallEnded,function(i){var r=i.callId;n.Loader.currentConversation.callId===r&&t.refreshVoiceVideoCallDialog(!1,!1,!1,!1,!1,!1,!1)})},i.prototype.setCallingContainerHeightBasedOnCalling=function(t,i,r,u){if(t===!0||r===!0||u===!0)document.getElementById(n.HtmlClassNames.callingContainer).className=n.HtmlCssConstants.space+n.HtmlCssConstants.voiceCallOrIncomingPopup;else if(i===!0)document.getElementById(n.HtmlClassNames.callingContainer).className=n.HtmlCssConstants.space+n.HtmlCssConstants.videoCallDialog;else{document.getElementById(n.HtmlClassNames.callingContainer).className=n.HtmlCssConstants.space+n.HtmlCssConstants.noCallDialog;var f=document.getElementById(n.HtmlIdNames.endedCall);!f||(f.style.position=n.HtmlCssConstants.absolute,f.style.opacity="0")}},i}(React.Component);n.CallingContainer=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){var t=document.getElementById(n.HtmlIdNames.chatButtonContainer);t?n.FrameHandler.resizeFrame(window,n.IFrameValues.startChatButton):console.error("Failed to find element: ",n.HtmlIdNames.chatButtonContainer)},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.chatButtonContainer,className:n.HtmlClassNames.chat,style:this.getButtonInitStyle(),onKeyDown:this.keyHandler.bind(this),onClick:this.props.onclick.bind(this,null,!1)},React.createElement("div",{className:n.HtmlClassNames.notificationIcon,id:n.HtmlIdNames.notificationIcon}),React.createElement("div",{id:n.HtmlIdNames.loadingScreen,className:n.HtmlClassNames.loadingScreen,tabindex:-1},React.createElement("div",{className:n.HtmlClassNames.loadingMessage},this.props.locale.LOADING_TEXT)),React.createElement("div",{className:n.HtmlClassNames.chatButton,style:n.Utility.getChatButtonStyle(this.props.liveChatConfig.chatButtonColor),id:n.HtmlIdNames.chatButton,role:"button",tabindex:0},React.createElement("div",{className:n.HtmlClassNames.chatIconContainer,style:this.getIconContainerInitStyle()},React.createElement("img",{className:n.HtmlClassNames.chatIcon,alt:"",src:n.Utility.getChatIconSource(this.props.liveChatConfig.chatButtonIconUrl)}),React.createElement("div",{role:"alert","aria-label":this.getUnreadTextForAriaLabel(),"aria-live":"polite",className:n.Utility.getHtmlClassNameForUnreadMessages(this.props.unreadMessagesCount),style:this.getUnreadMessagesStyle()},React.createElement("span",{"aria-hidden":"true"},n.Utility.getUnreadMessagesCount(this.props.unreadMessagesCount,this.props.locale.UNREAD_MESSAGES_EMBEDDED_TRUNCATED)))),React.createElement("div",{className:n.HtmlClassNames.chatIconTitle},React.createElement("div",{className:n.HtmlClassNames.oclcwt1,"aria-label":this.props.liveChatConfig.chatButtonTitle,title:this.props.liveChatConfig.chatButtonTitle},this.props.liveChatConfig.chatButtonTitle),React.createElement("div",{className:n.HtmlClassNames.oclcwt2,"aria-label":this.props.liveChatConfig.chatButtonSubtitle,title:this.props.liveChatConfig.chatButtonSubtitle},this.props.liveChatConfig.chatButtonSubtitle))))},i.prototype.keyHandler=function(t){(t.keyCode==n.Constants.KeyCodes.KEY_ENTER||t.keyCode==n.Constants.KeyCodes.KEY_SPACE)&&this.props.onclick()},i.prototype.getUnreadMessagesStyle=function(){var t={};return this.props.unreadMessagesCount!=0&&this.props.liveChatConfig.isVisualNotificationsEnabled||(t[n.HtmlCssConstants.display]=n.Constants.HTMLConstants.none),t},i.prototype.getUnreadTextForAriaLabel=function(){var t=n.Utility.getUnreadMessagesCount(this.props.unreadMessagesCount,this.props.locale.UNREAD_MESSAGES_EMBEDDED_TRUNCATED);return t==0?"":t==1?n.Loader.Locale.UNREAD_MESSAGES_POP_OUT_SINGLE_MESSAGE.replace("{0}",t):t<=n.Constants.UnreadMessagesNotificationConstants.maxValue?n.Loader.Locale.UNREAD_MESSAGES_POP_OUT_MULTIPLE_MESSAGES.replace("{0}",t):n.Loader.Locale.UNREAD_MESSAGES_POP_OUT_MULTIPLE_MESSAGES_TRUNCATED},i.prototype.getButtonInitStyle=function(){var t={position:n.Constants.ChatButtonInitStyle.position,bottom:n.Constants.ChatButtonInitStyle.bottomPosition,cursor:n.Constants.ChatButtonInitStyle.cursor};return this.props.liveChatConfig.chatButtonPosition===n.Constants.ChatButtonInitStyle.bottomLeftPosition?t[n.Constants.ChatButtonInitStyle.leftString]=n.Constants.ChatButtonInitStyle.leftPosition:t[n.Constants.ChatButtonInitStyle.rightString]=n.Constants.ChatButtonInitStyle.rightPosition,t},i.prototype.getIconContainerInitStyle=function(){return{backgroundColor:this.props.liveChatConfig.chatButtonColor}},i}(React.Component);n.ChatButton=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i){var r=t.call(this,i)||this;return r.enabledActions=[],r.onFocus=function(){r.state.isFocused||r.setState({isFocused:!0})},r.onBlur=function(n){n.currentTarget.contains(n.relatedTarget)||r.setState({isFocused:!1})},r.state={currentWidgetLoadingState:n.WidgetLoadingState.Complete,currentWidgetState:n.WidgetState.Closed,currentSurveyWidgetState:n.WidgetState.Closed,currentOHWidgetState:n.WidgetState.Closed,surveyType:n.SurveyType.Prechat,showChat:!1,shouldShowChatButton:!1,shouldShowLoadingScreen:!1,shouldShowChatPlaceholder:!1,shouldShowChatReconnectSurvey:!1,shouldShowPrechatSurvey:!1,shouldShowPostchatSurvey:!1,shouldShowOperatingHour:!1,shouldShowProactiveChatInvite:!1,shouldShowPostchatLoadingScreen:!1,welcomePageDisplayStyle:{loadingComponentVisibility:!0,welcomeTextComponentVisibility:!0,alertTextComponentVisibility:!1,minimizeButtonVisibility:!n.Bootstrapper.renderOnMobileDevice,closeButtonVisibility:!1,alertHeaderText:"",alertSubheaderText:""},postchatLoadPageDisplayStyle:{loadingComponentVisibility:!0,textComponentVisibility:!0,alertTextComponentVisibility:!1,minimizeButtonVisibility:!n.Bootstrapper.renderOnMobileDevice,closeButtonVisibility:!0},isRefresh:!1,startProactiveChat:r.startProactiveChat.bind(r),handleChatButtonClick:r.handleChatButtonClick.bind(r),closeSession:r.closeSession.bind(r),unreadMessagesCount:0,handleConversationEnd:r.handleConversationEnd.bind(r),showEmailRequestDialog:!1,showEmailCloseConfirmation:!1,showCloseConfirmation:!1,confirmationDialogDisplayed:!1,closeConfirmationInput:{},isCalledFromRestoreWidgetState:!1,isFocused:!1},r.enabledActions=r.getEnabledActions(),r}return __extends(i,t),i.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:if(window.addEventListener(n.HtmlEventNames.focus,this.handleFocusForPopOutMode.bind(this)),this.prechatController=new n.PrechatController(this.props.liveChatConfig),this.postchatController=new n.PostchatController(this.props.liveChatConfig),this.chatReconnectController=new n.ChatReconnectController,this.persistentChatHandler=new n.PersistentChatHandler,this.operatingHourController=new n.OperatingHourController(this.props.liveChatConfig),this.postchatController.canRenderPostChat())try{this.postchatController.addEmbedPostChatScriptToHead()}catch(i){this.props.liveChatConfig.isPostChatEnabled=!1;n.TelemetryClient.error({Event:n.TelemetryEvent.PostChatFormsProRenderFailed,ExceptionDetails:i})}return this.registerOnUnloadCallback(),this.checkKeycode(),n.Util.setAriaLiveAlert(n.Loader.Locale.LIVE_CHAT_AVAILABLE),n.TelemetryClient.info({Event:n.TelemetryEvent.LCWChatButtonShow,ElapsedTimeInMilliseconds:n.Bootstrapper.lcwLoadToChatButtonShowTimer.milliSecondsElapsed}),[4,this.restoreWidgetStateIfAvailable()];case 1:return t.sent(),[2]}})})},i.prototype.componentDidUpdate=function(t,i){this.state.shouldShowChatPlaceholder&&(n.FrameHandler.setToDefaultSize(window),i.shouldShowChatPlaceholder||n.WebChatControlsUtils.setFocus());window.addEventListener(n.HtmlEventNames.focus,this.handleFocusForPopOutMode.bind(this))},i.prototype.componentWillUnmount=function(){this.removeListeners(window)},i.prototype.getChatAttributes=function(){var i={},t;return!n.Bootstrapper.lcwHideChatButton&&this.state.shouldShowChatButton&&(i=(t={},t[n.HtmlAttributeNames.ariaLive]=n.HtmlClassNames.assertive,t)),i},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.chat,onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this)},!n.Bootstrapper.lcwHideChatButton&&this.state.shouldShowChatButton&&React.createElement(n.ChatButton,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onclick:this.handleChatButtonClick.bind(this),unreadMessagesCount:this.state.unreadMessagesCount}),this.state.currentSurveyWidgetState!==n.WidgetState.Closed&&React.createElement(n.SurveyPlaceholder,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,showComponents:this.showComponents.bind(this),loadWidget:this.loadWidget.bind(this),postReconnectCheckHandler:this.postReconnectCheckHandler.bind(this),closeConversation:this.closeConversation.bind(this),surveyType:this.state.surveyType,shouldShowSurvey:this.state.shouldShowChatReconnectSurvey||this.state.shouldShowPrechatSurvey||this.state.shouldShowPostchatSurvey||this.state.shouldShowPostchatLoadingScreen,changeCurrentSurveyWidgetState:this.changeCurrentSurveyWidgetState.bind(this),hideEmailDialog:this.hideEmailDialog.bind(this),showEmailRequestDialog:this.state.showEmailRequestDialog,enabledActions:this.enabledActions,showCloseConfirmation:this.state.showCloseConfirmation,confirmationDialogDisplayed:this.state.confirmationDialogDisplayed,closeConfirmationInput:this.state.closeConfirmationInput,handleChatClose:this.handleChatClose.bind(this),handleConversationClose:this.handleConversationClose.bind(this),postchatLoadPageDisplayStyle:this.state.postchatLoadPageDisplayStyle,shouldShowPostchatLoadingScreen:this.state.shouldShowPostchatLoadingScreen}),this.state.showChat&&!(this.state.shouldShowChatReconnectSurvey||this.state.shouldShowPrechatSurvey||this.state.shouldShowPostchatSurvey||this.state.shouldShowPostchatLoadingScreen)&&React.createElement("div",{id:n.HtmlIdNames.chatPlaceholderWrapper,style:{display:this.state.shouldShowChatPlaceholder?"block":"none"}},React.createElement(n.ChatPlaceholder,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,changeCurrentWidgetState:this.changeCurrentWidgetState.bind(this),showComponents:this.showComponents.bind(this),closeSession:this.closeSession.bind(this),showHeader:!n.Bootstrapper.renderOnMobileDevice&&!n.Bootstrapper.isPopOutMode,hideEmailDialog:this.hideEmailDialog.bind(this),showEmailRequestDialog:this.state.showEmailRequestDialog,enabledActions:this.enabledActions,showCloseConfirmation:this.state.showCloseConfirmation,confirmationDialogDisplayed:this.state.confirmationDialogDisplayed,closeConfirmationInput:this.state.closeConfirmationInput,handleChatClose:this.handleChatClose.bind(this)})),this.state.shouldShowLoadingScreen&&React.createElement(n.WelcomePage,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.onWelcomePageMinimize.bind(this),onClose:this.onWelcomePageClose.bind(this),welcomePageDisplayStyle:this.state.welcomePageDisplayStyle}),this.state.shouldShowProactiveChatInvite&&React.createElement(n.ProactiveChatPage,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,showComponents:this.showComponents.bind(this),handleChatButtonClick:this.handleChatButtonClick.bind(this)}),this.state.shouldShowOperatingHour&&React.createElement(n.OperatingHourPage,{liveChatConfig:this.props.liveChatConfig,showComponents:this.showComponents.bind(this),locale:this.props.locale,changeCurrentOHWidgetState:this.changeCurrentOHWidgetState.bind(this),onClose:this.onOperatingHourPageClose.bind(this)}))},i.prototype.checkKeycode=function(){var t=this;n.Bootstrapper.isPopOutMode&&(window.addEventListener(n.HtmlEventNames.keydown,function(i){t.state.isRefresh=i.keyCode==n.Constants.KeyCodes.KEY_F5||i.ctrlKey&&i.keyCode==n.Constants.KeyCodes.KEY_R}),window.addEventListener(n.HtmlEventNames.keyup,function(i){t.state.isRefresh=i.keyCode==n.Constants.KeyCodes.KEY_F5||i.ctrlKey&&i.keyCode==n.Constants.KeyCodes.KEY_R}))},i.prototype.registerOnUnloadCallback=function(){var t=this;window.addEventListener(n.Constants.beforeunloadEvent,function(n){return t.handleOnBeforeUnload(n)});window.addEventListener(n.Constants.unloadEvent,function(){if(n.Util.clearCacheRefreshTimer(),n.Bootstrapper.isPopOutMode){t.handleCloseSessionForPopOut();return}if((n.Loader.currentConversation.isChatComplete||n.Loader.currentConversation.sessionInitState!==n.SessionInitState.SessionInitStarted)&&!t.isLoadWithState()){t.closeConversation();return}n.Loader.currentConversation.isChatComplete||n.Loader.currentConversation.sessionInitState==n.SessionInitState.SessionInitNotStarted||t.cacheWidgetState()})},i.prototype.handleOnBeforeUnload=function(t){n.Bootstrapper.isPopOutMode&&(window.navigator.userAgent.search(n.BrowserVendor.FIREFOX)>-1?this.handleCloseSessionForPopOut():(t.preventDefault(),t.returnValue=n.Loader.Locale.CLOSE_CONFIRMATION_POPOUT_WINDOW_DIALOG_DESCRIPTION))},i.prototype.cacheWidgetState=function(){var t=!n.Util.isNullOrUndefined(n.PopoutHandler.popOutWindowOpenRef)&&n.PopoutHandler.popOutWindowOpenRef.closed&&this.state.currentWidgetState===n.WidgetState.PopOutWindow;t&&this.changeCurrentWidgetState(n.WidgetState.Closed);n.Loader.currentConversation.reconnectId=n.Loader.reconnectId;n.Loader.currentConversation.currentWidgetState=this.state.currentWidgetState;n.ContextSpecificDataStore.UpsertData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.ConversationData,n.Loader.currentConversation,n.ConfigurationManager.ConfigExpiryTime);n.ContextSpecificDataStore.UpsertData(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.OngoingChat,!0,n.ConfigurationManager.ConfigExpiryTime)},i.prototype.cachePreChatResponse=function(){n.ContextSpecificDataStore.UpsertData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.PreChatResponse,n.Loader.initContext.preChatResponse,n.ConfigurationManager.ConfigExpiryTime)},i.prototype.isLoadWithState=function(){var t=n.ContextSpecificDataStore.GetData(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.OngoingChat);return!n.Util.isNullOrUndefined(t)},i.prototype.handleChatButtonClick=function(t,r){return t===void 0&&(t=null),r===void 0&&(r=!1),__awaiter(this,void 0,void 0,function(){var f=this,u;return __generator(this,function(e){switch(e.label){case 0:return n.Loader.currentConversation.isChatStarted&&!this.state.shouldShowChatButton&&!this.isLoadWithState()?[2]:(n.Loader.currentConversation.isChatStarted=!0,i.isWindowOpened=r&&!n.Util.isNullOrUndefined(t),i.inPopoutWindow=n.Bootstrapper.openChatInPopOutWindow,n.Util.isNullOrUndefined(t)||(i.inPopoutWindow=t),u=this.chatReconnectController.retrieveReconnectId(),!u)?[3,2]:[4,this.chatReconnectController.reconnectAvailabilityCheck(u).then(function(t){t?n.Util.redirectPage(t):f.checkWidgetStateAndAct()})];case 1:return e.sent(),[3,4];case 2:return[4,this.checkWidgetStateAndAct()];case 3:e.sent();e.label=4;case 4:return n.Util.raiseCustomEvent(n.LCWEvents.LCWOnMaximizedEvent),[2]}})})},i.prototype.checkWidgetStateAndAct=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return(this.state.currentWidgetLoadingState===n.WidgetLoadingState.Complete)?(n.Loader.currentRequestId||(n.Loader.currentRequestId=n.Util.newGuid()),n.TelemetryClient.info({Event:n.TelemetryEvent.LCWChatButtonClicked}),!n.Util.isNullOrUndefined(n.Loader.liveChatConfig.hideWidget)&&n.Loader.liveChatConfig.hideWidget?this.showComponents(n.Components.None):this.showComponents(n.Components.LoadingScreen),[4,this.handleChatButtonClickHelper()]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,this.startWidgetLoading()];case 3:t.sent();t.label=4;case 4:return[2]}})})},i.prototype.handleChatButtonClickHelper=function(){return __awaiter(this,void 0,void 0,function(){var t=this,r,u,f,e,o;return __generator(this,function(s){switch(s.label){case 0:return(r=this.state.currentWidgetState===n.WidgetState.Minimized,u=i.inPopoutWindow==!0,f=this.state.currentWidgetState===n.WidgetState.PopOutWindow,e=n.PopoutHandler.popOutWindowOpenRef&&!n.PopoutHandler.popOutWindowOpenRef.closed,o=this.state.isCalledFromRestoreWidgetState,n.Loader.currentConversation.isCustomerAudioOn=this.props.liveChatConfig.isAudioNotificationEnabled,this.setIsCalledFromRestoreWidgetState(!1),!(f&&e))?[3,1]:(this.showChatButton(),n.PopoutHandler.popOutWindowOpenRef.focus(),[3,10]);case 1:return(r&&!o)?(this.handleMaximize(),[3,10]):[3,2];case 2:return u?(this.showChatButton(),[4,this.acquireTokenAndOpenPopoutWindow()]):[3,4];case 3:return s.sent(),[3,10];case 4:return(n.Loader.currentConversation.isPostChatDisplayed&&this.state.currentSurveyWidgetState===n.WidgetState.Minimized)?(this.handlePostChatSurveyMaximize(),[3,10]):[3,5];case 5:return this.persistentChatHandler.isAuthPersistentChat()?(this.chatReconnectController.checkPreviousActiveSession().then(function(i){i&&i.trim()&&(n.Loader.reconnectId=i);t.postReconnectCheckHandler()}),[3,10]):[3,6];case 6:return(this.chatReconnectController.isAuthReconnectFlow()&&!this.isLoadWithState())?[4,this.chatReconnectController.checkPreviousActiveSession().then(function(i){i&&i.trim()?(n.Loader.reconnectId=i,t.alertUserToJoinOldSession(),t.liveChatVersion=t.getLiveChatVersionInstance(),t.logLiveChatVersionInitializationFailure(t.liveChatVersion)):t.postReconnectCheckHandler()})]:[3,8];case 7:return s.sent(),[3,10];case 8:return[4,this.postReconnectCheckHandler()];case 9:s.sent();s.label=10;case 10:return[2]}})})},i.prototype.acquireTokenAndOpenPopoutWindow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return(n.Loader.liveChatConfig.authClientFunction&&!n.Bootstrapper.authToken)?[4,n.AuthManager.acquireTokenFromAuthMethod()]:[3,2];case 1:t.sent();t.label=2;case 2:return n.PopoutHandler.LoadWidgetInPopOutWindow(i.isWindowOpened,n.AuthManager.isAuthFunctionSucceeded()),this.changeCurrentWidgetState(n.WidgetState.PopOutWindow),[2]}})})},i.prototype.postReconnectCheckHandler=function(){return __awaiter(this,void 0,void 0,function(){var t,r,f,i,u;return __generator(this,function(e){switch(e.label){case 0:return(t=n.Util.timer(),this.liveChatVersion=this.getLiveChatVersionInstance(),this.logLiveChatVersionInitializationFailure(this.liveChatVersion),!(n.Loader.liveChatConfig.authClientFunction&&!n.Bootstrapper.authToken))?[3,2]:[4,n.AuthManager.acquireTokenFromAuthMethod()];case 1:e.sent();e.label=2;case 2:return(f=n.DataContextTypes.UserWidgetOrganization,i=n.ContextSpecificDataStore.GetData(f,n.WidgetDataKeys.ConversationData),!!n.Util.isNullOrUndefined(i))?[3,4]:(n.Loader.currentConversation=i,n.Loader.currentRequestId=i.currentRequestId,n.Loader.reconnectId=i.reconnectId,n.Loader.currentConversation.currentWidgetState===n.WidgetState.Minimized&&(n.Loader.currentConversation.currentWidgetState=n.WidgetState.Closed),[4,n.Loader.validateAuthChatRecord(n.Loader.currentConversation)]);case 3:return u=e.sent(),r=u,u||this.resetCurrentLCWState(),[3,5];case 4:r=!1;e.label=5;case 5:return this.operatingHourController.shouldRenderOperatingHour()?(this.showComponents(n.Components.OperatingHour),this.changeCurrentOHWidgetState(n.WidgetState.Maximized),n.FrameHandler.setToDefaultSize(window),[3,12]):[3,6];case 6:return(!r&&this.prechatController.shouldRenderPrechat())?(this.showComponents(n.Components.PrechatSurvey),this.changeCurrentSurveyWidgetState(n.WidgetState.Maximized),this.setSurveyType(n.SurveyType.Prechat),n.FrameHandler.setToDefaultSize(window),n.LogHelper.logPrechatWidgetLoadTime(t.milliSecondsElapsed),this.fetchChatTokenPromise=n.Loader.fetchChatToken(!1),[3,12]):[3,7];case 7:return(this.postchatController.canRenderPostChat()&&n.Loader.currentConversation.isPostChatDisplayed&&!n.Bootstrapper.isPopOutMode)?(this.closeConversation(),this.showComponents(n.Components.ChatButton),n.LogHelper.logPostchatWidgetLoadTime(t.milliSecondsElapsed),[3,12]):[3,8];case 8:return!r?[4,this.loadWidget(!1).then(function(){return n.LogHelper.logChatWidgetLoadTime(t.milliSecondsElapsed)})]:[3,10];case 9:return e.sent(),[3,12];case 10:return[4,this.loadWidgetWithCache().then(function(){return n.LogHelper.logChatWidgetLoadTime(t.milliSecondsElapsed)})];case 11:e.sent();e.label=12;case 12:return[2]}})})},i.prototype.getLiveChatVersionInstance=function(){return n.Loader.liveChatConfig.liveChatVersionNumber&&n.Loader.liveChatConfig.liveChatVersionNumber===n.Constants.LiveChatV2?new n.LiveChatVersion2:new n.LiveChatVersion1},i.prototype.logLiveChatVersionInitializationFailure=function(){n.Util.isNullOrUndefined(this.liveChatVersion)&&n.TelemetryClient.error({Event:n.TelemetryEvent.ACSLiveChatVersionInitializationFailed,ExceptionDetails:{ErrorDetails:"LiveChatVersion is Null or Undefined for liveChatVersionNumber: "+n.Loader.liveChatConfig.liveChatVersionNumber}})},i.prototype.alertUserToJoinOldSession=function(){this.setSurveyType(n.SurveyType.ChatReconnect);this.showComponents(n.Components.ChatReconnectSurvey);this.changeCurrentSurveyWidgetState(n.WidgetState.Maximized);n.FrameHandler.setToDefaultSize(window)},i.prototype.handlePostChatSurveyMaximize=function(){this.showComponents(n.Components.PostchatSurvey);this.changeCurrentSurveyWidgetState(n.WidgetState.Maximized);n.FrameHandler.setToDefaultSize(window)},i.prototype.loadWidget=function(t){var i=this;return this.startWidgetLoading().then(function(){return i.fetchChatTokenOrWaitCompleting(t)}).then(function(){return i.resumeChat()}).then(function(){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,n.Loader.startSessionInit()];case 1:return[2,t.sent()]}})})}).then(function(){return i.completeWidgetLoading(!1)}).catch(function(n){i.handleSessionInitError(n);i.completeWidgetLoading(!0,n);throw n;})},i.prototype.fetchChatTokenOrWaitCompleting=function(t){return t?this.fetchChatTokenPromise:n.Loader.fetchChatToken(!1)},i.prototype.loadWidgetWithCache=function(){var t=this;return this.startWidgetLoading().then(function(){return t.resumeChat()}).then(function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWChatRetrieved);n.Util.setSessionKeys(n.Loader.currentConversation);t.completeWidgetLoading(!1)}).catch(function(n){t.completeWidgetLoading(!0,n);throw n;})},i.prototype.assignOfflineProps=function(){this.props.liveChatConfig.chatButtonTitle=this.props.liveChatConfig.offlineChatButtonTitle;this.props.liveChatConfig.chatButtonSubtitle=this.props.liveChatConfig.offlineChatButtonSubtitle;this.props.liveChatConfig.chatTitleColor=this.props.liveChatConfig.offlineChatTitleColor;this.props.liveChatConfig.bubbleColor=this.props.liveChatConfig.offlineBubbleColor;this.props.liveChatConfig.chatButtonColor=this.props.liveChatConfig.offlineChatButtonColor;this.props.liveChatConfig.chatAvatarUrl=this.props.liveChatConfig.offlineChatAvatarUrl},i.prototype.handleSessionInitError=function(t){n.Loader.currentConversation.sessionInitErrorCode!==n.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour||n.Util.isNullOrUndefined(this.props.liveChatConfig.offlineChatButtonTitle)?n.Loader.currentConversation.sessionInitErrorCode===n.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour?(this.showComponents(n.Components.LoadingScreen),this.setState({welcomePageDisplayStyle:{loadingComponentVisibility:!1,welcomeTextComponentVisibility:!1,alertTextComponentVisibility:!0,minimizeButtonVisibility:!1,closeButtonVisibility:!0,alertHeaderText:n.AlertMessages.getAlertHeaderMessage(n.Loader.currentConversation.sessionInitErrorCode),alertSubheaderText:n.AlertMessages.getAlertSubHeaderMessage(n.Loader.currentConversation.sessionInitErrorCode)}})):this.showComponents(n.Components.ChatButton):(n.Util.isNullOrUndefined(t.response.headers.message)||this.setOutsideOperatingHoursTitle(t.response.headers.message),this.assignOfflineProps(),this.showComponents(n.Components.OperatingHour),this.changeCurrentOHWidgetState(n.WidgetState.Maximized),n.FrameHandler.setToDefaultSize(window))},i.prototype.setOutsideOperatingHoursTitle=function(t){this.props.liveChatConfig.outsideOperatingHoursTitle=n.Utility.decodeUtf8EncodedString(t)},i.prototype.restoreWidgetStateIfAvailable=function(){return __awaiter(this,void 0,void 0,function(){var i,r,t,u;return __generator(this,function(f){switch(f.label){case 0:return!this.isLoadWithState()?n.Bootstrapper.isPopOutMode?[4,this.handleChatButtonClick()]:[3,2]:[3,4];case 1:return f.sent(),[3,3];case 2:this.showChatButton();f.label=3;case 3:return[2];case 4:return(i=!n.Loader.currentConversation.isPostChatDisplayed||!n.Bootstrapper.isPopOutMode,!!i)?[3,6]:(this.closeConversation(),[4,this.handleChatButtonClick()]);case 5:return f.sent(),[2];case 6:return n.Loader.liveChatConfig.authClientFunction?[4,n.AuthManager.acquireTokenFromAuthMethod()]:[3,8];case 7:f.sent();f.label=8;case 8:return(r=n.DataContextTypes.UserWidgetOrganization,t=n.ContextSpecificDataStore.GetData(r,n.WidgetDataKeys.ConversationData),!!n.Util.isNullOrUndefined(t))?[3,13]:(n.Loader.currentConversation=t,n.Loader.currentRequestId=t.currentRequestId,n.Loader.reconnectId=t.reconnectId,n.Loader.currentConversation.currentWidgetState===n.WidgetState.Minimized&&(n.Loader.currentConversation.currentWidgetState=n.WidgetState.Closed),this.changeCurrentWidgetState(n.Loader.currentConversation.currentWidgetState),this.setIsCalledFromRestoreWidgetState(!0),[4,n.Loader.getLWIDetails()]);case 9:return(f.sent(),!(n.Loader.liveWorkItemState===n.LiveWorkItemState.WrapUp||n.Loader.liveWorkItemState===n.LiveWorkItemState.Closed))?[3,10]:(this.handleConversationClose(),[3,12]);case 10:return[4,this.handleChatButtonClick()];case 11:f.sent();f.label=12;case 12:return[3,14];case 13:u=n.DataContextTypes.WidgetOrganization;n.ContextSpecificDataStore.RemoveData(u,n.WidgetDataKeys.OngoingChat);this.showChatButton();f.label=14;case 14:return[2]}})})},i.prototype.showChatButton=function(){(n.Util.isNullOrUndefined(n.Loader.liveChatConfig.hideWidget)||!n.Loader.liveChatConfig.hideWidget)&&this.showComponents(n.Components.ChatButton)},i.prototype.resumeChat=function(){var n=this;return new Promise(function(t,i){n.changeShowChatState(!0);n.loadWebChat().then(function(){return t()}).catch(function(n){return i(n)})})},i.prototype.completeWidgetLoading=function(t,i){var r=n.Loader.currentConversation.sessionInitErrorCode===n.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour,u=this.state.currentWidgetLoadingState===n.WidgetLoadingState.Pending,f=n.Loader.currentConversation.currentWidgetState===n.WidgetState.Minimized;t?(r||this.showComponents(n.Components.None),n.TelemetryClient.error({Event:n.TelemetryEvent.WidgetLoadFailed,ExceptionDetails:i})):(u&&f?this.showChatButton():(n.Loader.currentConversation.currentWidgetState=n.WidgetState.Maximized,this.changeCurrentWidgetState(n.WidgetState.Maximized),this.showComponents(n.Components.ChatPlaceholder)),this.changeCurrentSurveyWidgetState(n.WidgetState.Closed),n.Util.setupCacheRefreshTimer(),n.TelemetryClient.info({Event:n.TelemetryEvent.WidgetLoadComplete}));this.changeCurrentWidgetLoadingState(n.WidgetLoadingState.Complete)},i.prototype.loadWebChat=function(){return i.webChatProxy=new n.WebChat(this.props.liveChatConfig),i.webChatProxy.createWebChat(this.liveChatVersion),this.liveChatVersion!==null&&this.liveChatVersion.registerOnNewMessageActivityCallback(this.onNewMessage.bind(this)),Promise.resolve()},i.prototype.handleFocusForPopOutMode=function(){n.Bootstrapper.isPopOutMode&&this.props.liveChatConfig.isVisualNotificationsEnabled&&(this.setState({unreadMessagesCount:0}),this.changeDocumentTitle(0))},i.prototype.onNewMessage=function(t){var i=n.Bootstrapper.isPopOutMode&&window.document.hidden;!(this.state.currentWidgetState===n.WidgetState.Minimized||i&&this.props.liveChatConfig.isVisualNotificationsEnabled)||n.Utility.isHistoryMessage(t)||n.Utility.isSystemMessage(t)||(this.setState({unreadMessagesCount:this.state.unreadMessagesCount+1}),i?this.changeDocumentTitle(this.state.unreadMessagesCount):n.Utility.changeTitle(this.state.unreadMessagesCount));this.props.liveChatConfig.isAudioNotificationEnabled&&(n.Utility.isHistoryMessage(t)||(i||this.state.currentWidgetState===n.WidgetState.Minimized||this.state.currentWidgetState===n.WidgetState.Maximized&&!this.state.isFocused)&&n.Utility.playAudioNotifications())},i.prototype.changeDocumentTitle=function(t){var r=document.title?document.title:"",i,u;t===1?i=this.props.locale.UNREAD_MESSAGES_POP_OUT_SINGLE_MESSAGE.replace("{0}",t):t>1&&t<=n.Constants.UnreadMessagesNotificationConstants.maxValue?i=this.props.locale.UNREAD_MESSAGES_POP_OUT_MULTIPLE_MESSAGES.replace("{0}",t):t>n.Constants.UnreadMessagesNotificationConstants.maxValue&&(i=this.props.locale.UNREAD_MESSAGES_POP_OUT_MULTIPLE_MESSAGES_TRUNCATED);u=!!t&&t>0?i+" | "+r.match(/^((.*)\|\s+)?(.*)$/)[3]:""+r.match(/^((.*)\|\s+)?(.*)$/)[3];window.document.title=u},i.prototype.removeListeners=function(t){t&&t.addEventListener&&t.removeEventListener(n.HtmlEventNames.focus,this.handleFocusForPopOutMode)},i.prototype.startWidgetLoading=function(){return this.changeCurrentWidgetLoadingState(n.WidgetLoadingState.Pending),this.state.currentWidgetState===n.WidgetState.Closed&&this.showComponents(n.Components.LoadingScreen),Promise.resolve()},i.prototype.handleMaximize=function(){this.setState({unreadMessagesCount:0});n.Utility.changeTitle(0);this.changeCurrentWidgetState(n.WidgetState.Maximized);this.completeWidgetLoading(!1)},i.prototype.closeConversation=function(){n.FeaturesManager.shouldEnableCallingAsEscalateChannel()&&this.props.liveChatConfig!==null&&(this.props.liveChatConfig.callingOptions===n.CallingOptions.VideoAndVoiceCalling||this.props.liveChatConfig.callingOptions===n.CallingOptions.VoiceOnly)&&window["Microsoft.Omnichannel.Calling.SDK"]&&window["Microsoft.Omnichannel.Calling.SDK"].VoiceVideoCalling.getInstance().dispose();this.resetCurrentLCWState();this.changeShowChatState(!1);n.Utility.emptyWebChatRoot();this.changeCurrentSurveyWidgetState(n.WidgetState.Closed);this.prechatController.resetPreChat();this.chatReconnectController.resetReconnectResponse();this.resetConversationData();this.resetWelcomeView();n.ProactiveChatController.resetProctiveChatContext();n.ContextService.resetInitContext();n.Loader.currentConversation.isChatComplete=!0;this.postchatController.setIsPostChatDisplayedState(!1);n.Loader.reconnectId=null;n.Util.raiseCustomEvent(n.LCWEvents.LCWOnClosedEvent)},i.prototype.resetConversationData=function(){n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.ConversationData);n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.WidgetOrganization,n.WidgetDataKeys.OngoingChat);n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.PreChatResponse)},i.prototype.resetCurrentLCWState=function(){n.Loader.currentConversation=new n.Conversation;n.Loader.currentRequestId=n.Util.newGuid();n.Loader.surveyEnabledParticipantJoined=!1;this.setSurveyType(null)},i.prototype.closeSession=function(){return __awaiter(this,void 0,void 0,function(){var t,r;return __generator(this,function(u){switch(u.label){case 0:return this.postchatController.canRenderPostChat()?[4,n.Loader.getLWIDetails()]:[3,2];case 1:u.sent();u.label=2;case 2:return n.Util.clearCacheRefreshTimer(),t=this.postchatController.shouldRenderPostchat(),this.tryToClosePopoutWindow(),this.sendCloseMessageToSdkPopoutWindow(),this.removeAMSClientIframe(),(!t||n.Bootstrapper.isPopOutMode||i.inPopoutWindow==!0)&&n.Loader.ChatAdapter&&n.Loader.ChatAdapter.end(),n.Loader.liveChatConfig&&n.Loader.liveChatConfig.authClientFunction&&n.Loader.liveChatConfig.isPersistentChat&&n.Loader.PersistentChatTimer&&(clearInterval(n.Loader.PersistentChatTimer),n.Loader.PersistentChatTimer=null),n.Util.isNullOrUndefined(n.Loader.currentConversation.currentRequestId)||(r=n.Loader.currentConversation,n.Loader.sendSessionCloseEvent(r),!t||n.Bootstrapper.isPopOutMode||i.inPopoutWindow==!0?(this.setState({confirmationDialogDisplayed:!1}),this.closeConversation(),this.showComponents(n.Components.ChatButton)):this.renderPostChatSurvey()),[2]}})})},i.prototype.tryToClosePopoutWindow=function(){n.PopoutHandler.popOutWindowOpenRef&&!n.PopoutHandler.popOutWindowOpenRef.closed&&n.PopoutHandler.popOutWindowOpenRef.close()},i.prototype.sendCloseMessageToSdkPopoutWindow=function(){var t={messageName:n.IframeMessages.closePopoutChatMessage};window.parent.postMessage(t,"*")},i.prototype.removeAMSClientIframe=function(){var t=document.getElementById(n.HtmlIdNames.MicrosoftOmnichannelAMSClientIframeId);t!=null&&t.remove()},i.prototype.handleCloseSessionForPopOut=function(){n.Bootstrapper.isPopOutMode&&window.opener.parent.postMessage({messageName:n.LCWEvents.LCWOnPopoutClose},"*");this.state.isRefresh&&!n.Loader.currentConversation.isChatComplete?(this.cacheWidgetState(),this.cachePreChatResponse()):(window.opener&&n.Bootstrapper.isCustomPopOutMode&&window.opener.postMessage({messageName:n.IframeMessages.closePopoutChatMessage},"*"),this.resetConversationData(),this.closeSession())},i.prototype.renderPostChatSurvey=function(){this.postchatController.setIsPostChatDisplayedState(!0);var t=n.Loader.participantType===n.UserTypeToBeSurveyed.Bot?this.props.liveChatConfig.postChatBotSurveyMode:this.props.liveChatConfig.postChatSurveyMode;t==n.MSFPSurveyMode.Embed?(this.showComponents(n.Components.PostchatSurvey),this.setSurveyType(n.SurveyType.Postchat),this.changeCurrentSurveyWidgetState(n.WidgetState.Maximized),n.FrameHandler.setToDefaultSize(window)):n.Bootstrapper.isPopOutMode||this.showComponents(n.Components.ChatPlaceholder);this.cacheWidgetState();n.TelemetryClient.info({Event:n.TelemetryEvent.PostchatWidgetLoaded})},i.prototype.changeShowChatState=function(n){this.setState({showChat:n})},i.prototype.changeCurrentWidgetState=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.setState({currentWidgetState:n})];case 1:return t.sent(),[2]}})})},i.prototype.changeCurrentWidgetLoadingState=function(n){this.setState({currentWidgetLoadingState:n})},i.prototype.setIsCalledFromRestoreWidgetState=function(n){this.setState({isCalledFromRestoreWidgetState:n})},i.prototype.setSurveyType=function(n){this.setState({surveyType:n})},i.prototype.showComponents=function(t){t===n.Components.ChatButton&&n.Bootstrapper.lcwHideChatButton&&n.FrameHandler.resizeFrame(window,n.IFrameValues.minimizeIframe);this.setState({shouldShowChatButton:t===n.Components.ChatButton,shouldShowChatPlaceholder:t===n.Components.ChatPlaceholder,shouldShowLoadingScreen:t===n.Components.LoadingScreen,shouldShowPrechatSurvey:t===n.Components.PrechatSurvey,shouldShowChatReconnectSurvey:t===n.Components.ChatReconnectSurvey,shouldShowPostchatSurvey:t===n.Components.PostchatSurvey,shouldShowProactiveChatInvite:t===n.Components.ProactiveChatInvite,shouldShowOperatingHour:t===n.Components.OperatingHour,shouldShowPostchatLoadingScreen:t===n.Components.PostchatLoadingScreen})},i.prototype.changeCurrentSurveyWidgetState=function(n){this.setState({currentSurveyWidgetState:n})},i.prototype.changeCurrentOHWidgetState=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.setState({currentOHWidgetState:n})];case 1:return t.sent(),[2]}})})},i.prototype.onWelcomePageMinimize=function(){this.shouldShowChatButtonOnMinimize()&&this.showComponents(n.Components.ChatButton)},i.prototype.onWelcomePageClose=function(){this.changeCurrentWidgetState(n.WidgetState.Closed);this.closeConversation();this.showComponents(n.Components.ChatButton)},i.prototype.onOperatingHourPageClose=function(){this.changeCurrentOHWidgetState(n.WidgetState.Closed);this.showComponents(n.Components.ChatButton)},i.prototype.shouldShowChatButtonOnMinimize=function(){return!this.state.welcomePageDisplayStyle.alertTextComponentVisibility},i.prototype.showEmailDialog=function(){this.setState({showEmailRequestDialog:!0});var t=document.getElementById(n.HtmlIdNames.emailTranscriptDialogTextField);t!=null&&t.focus()},i.prototype.hideEmailDialog=function(){this.setState({showEmailRequestDialog:!1})},i.prototype.getEnabledActions=function(){var t=[];return this.props.liveChatConfig&&(this.props.liveChatConfig.isDownloadTranscriptEnabled&&t.push(n.DownloadTranscriptAction.getDownloadTranscriptAction(n.Bootstrapper.renderOnMobileDevice)),this.props.liveChatConfig.isEmailTranscriptEnabled&&t.push(n.EmailTranscriptAction.getEmailTranscriptAction(this.showEmailDialog.bind(this),n.Bootstrapper.renderOnMobileDevice)),this.props.liveChatConfig.isAudioNotificationEnabled&&(n.Loader.currentConversation&&(n.Loader.currentConversation.isCustomerAudioOn=!0),t.push(n.AudioNotificationAction.getAudioNotificationAction(this.props.liveChatConfig.isAudioNotificationEnabled)))),t},i.prototype.resetWelcomeView=function(){this.setState({welcomePageDisplayStyle:{loadingComponentVisibility:!0,welcomeTextComponentVisibility:!0,alertTextComponentVisibility:!1,minimizeButtonVisibility:!n.Bootstrapper.renderOnMobileDevice,closeButtonVisibility:!1,alertHeaderText:"",alertSubheaderText:""}})},i.prototype.handleConversationEnd=function(){var t=this;n.Loader.getLWIDetails().then(function(){t.postchatController.shouldRenderPostchat()?setTimeout(function(){return t.renderPostChatSurvey()},n.Constants.postChatRenderTimeOnThreadUpdate):(t.resetConversationData(),t.resetWelcomeView(),n.ProactiveChatController.resetProctiveChatContext(),n.ContextService.resetInitContext(),n.Util.clearCacheRefreshTimer())})},i.prototype.startProactiveChat=function(t,r,u,f){if(f===void 0&&(f=!1),i.inPopoutWindow=n.Bootstrapper.openChatInPopOutWindow,n.Util.isNullOrUndefined(r)||(i.inPopoutWindow=r),this.state.currentWidgetLoadingState===n.WidgetLoadingState.Complete&&this.state.currentWidgetState===n.WidgetState.Closed&&this.state.currentSurveyWidgetState===n.WidgetState.Closed){var e=n.Util.timer();n.Loader.isPreChatEnabledForProactiveChat=t;n.ProactiveChatController.validateAndSetProactiveChatNotificationConfig(u,this.props.locale.PROACTIVE_CHAT_WELCOME_MESSAGE);n.Bootstrapper.isPopOutMode?this.handleChatButtonClick(i.inPopoutWindow,f):this.showComponents(n.Components.ProactiveChatInvite);n.ProactiveChatController.createTimeoutForInvite(this.showComponents.bind(this));n.LogHelper.logIncomingProactiveChatLoadTime(e.milliSecondsElapsed)}else n.TelemetryClient.info({Event:n.TelemetryEvent.ChatAlreadyTriggered})},i.prototype.handleChatClose=function(){var t=this;n.Util.isNullOrUndefined(n.Loader.currentConversation.chatId)||(n.Utility.changeTitle(0),this.state.confirmationDialogDisplayed?(this.setState({confirmationDialogDisplayed:!1}),this.handleConversationClose()):n.Loader.getLWIDetails().then(function(){t.confirmConversationClose()}))},i.prototype.confirmConversationClose=function(){for(var t=this.props.locale.CLOSE_CONFIRMATION_DIALOG_TITLE,i=this.props.locale.CLOSE_CONFIRMATION_DIALOG_DESCRIPTION,r,u,f=0;f<this.enabledActions.length;f++)this.enabledActions[f].name==n.DefaultActions.DownloadTranscript?u=!0:this.enabledActions[f].name==n.DefaultActions.EmailTranscript&&(r=!0);r&&u&&(t=this.props.locale.CLOSE_CONFIRMATION_DIALOG_TITLE_FOR_EMAIL_AND_DOWNLOAD_TRANSCRIPT_ENABLED,i=this.props.locale.CLOSE_CONFIRMATION_DIALOG_DESCRIPTION_FOR_EMAIL_AND_DOWNLOAD_TRANSCRIPT_ENABLED);r&&!u&&(t=this.props.locale.CLOSE_CONFIRMATION_DIALOG_TITLE_FOR_EMAIL_TRANSCRIPT_ENABLED,i=this.props.locale.CLOSE_CONFIRMATION_DIALOG_DESCRIPTION_FOR_EMAIL_TRANSCRIPT_ENABLED);!r&&u&&(t=this.props.locale.CLOSE_CONFIRMATION_DIALOG_TITLE_FOR_DOWNLOAD_TRANSCRIPT_ENABLED,i=this.props.locale.CLOSE_CONFIRMATION_DIALOG_DESCRIPTION_FOR_DOWNLOAD_TRANSCRIPT_ENABLED);this.setState({showCloseConfirmation:!0,closeConfirmationInput:{title:t,description:i,confirmationButtonText:this.props.locale.CLOSE_CONFIRMATION_DIALOG_CONFIRMTITLE,cancelButtonText:this.props.locale.CLOSE_CONFIRMATION_DIALOG_CANCELTITLE,onConfirm:this.onCloseConfirmed.bind(this),onCancel:this.onCloseCanceled.bind(this)}})},i.prototype.onCloseConfirmed=function(){this.setState({showCloseConfirmation:!1,confirmationDialogDisplayed:!0});this.handleConversationClose()},i.prototype.onCloseCanceled=function(){this.setState({showCloseConfirmation:!1});n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderCloseButton)},i.prototype.handleConversationClose=function(){this.changeCurrentWidgetState(n.WidgetState.Closed);n.Bootstrapper.debugInfo.setWidgetState(n.WidgetState.Closed);this.closeSession()},i.inPopoutWindow=null,i.isWindowOpened=!1,i}(React.Component);n.ChatContainer=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){var i=t.call(this,n)||this;return i.state={heightSet:!0},i}return __extends(i,t),i.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return window.addEventListener(n.Constants.resizeEvent,this.setWebChatHeightBasedOnCalling.bind(this)),[2]})})},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.chatPlaceHolder,className:n.HtmlClassNames.webChatPlaceholder},React.createElement("div",{id:n.HtmlIdNames.chatDimLayer,className:n.HtmlClassNames.webChatDimLayer,style:{display:this.props.showEmailRequestDialog||this.props.showCloseConfirmation?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},this.props.showEmailRequestDialog&&React.createElement(n.EmailRequestDialog,{onDialogHide:this.props.hideEmailDialog.bind(this)}),this.props.showCloseConfirmation&&!this.props.confirmationDialogDisplayed&&React.createElement(n.CloseConfirmation,{closeConfirmationInput:this.props.closeConfirmationInput})),this.props.showHeader&&React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.handleChatMinimize.bind(this),onClose:this.handleClose.bind(this),showIconAndTitle:!0,showMinimizeButton:!n.Bootstrapper.lcwHideMinimizeButton,showCloseButton:!0,showCustomCloseButton:n.Bootstrapper.lcwEnableCustomCloseButtonText&&n.Bootstrapper.lcwEnableCustomCloseButtonText.trim().length>0}),React.createElement(n.CallingContainer,{ref:n.Constants.CloseCalling,liveChatConfig:n.Loader.liveChatConfig,locale:n.Loader.Locale,setWebChatHeightBasedOnCalling:this.setWebChatHeightBasedOnCalling.bind(this)}),this.state.heightSet&&React.createElement(n.WebChatRoot,{actionBarActive:this.props.enabledActions.length>0,headerActive:this.props.showHeader}),React.createElement(n.WebChatEventListener,null),React.createElement(n.WebChatKeyboardListeners,null),this.props.enabledActions.length>0&&React.createElement(n.ActionBar,{enabledActions:this.props.enabledActions}))},i.prototype.handleClose=function(){this.props.handleChatClose();this.refs.closeCalling.state.handleCloseConfirmation()},i.prototype.handleChatMinimize=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return n.Util.isNullOrUndefined(n.Loader.currentConversation.chatId)||(n.Utility.changeTitle(0),this.props.showComponents(n.Components.ChatButton)),[4,this.props.changeCurrentWidgetState(n.WidgetState.Minimized)];case 1:return t.sent(),n.Bootstrapper.debugInfo.setWidgetState(n.WidgetState.Minimized),n.Utility.focusOnElement(n.HtmlIdNames.chatButton),[2]}})})},i.prototype.setWebChatHeightBasedOnCalling=function(){var o=document.getElementsByClassName(n.HtmlClassNames.webChat+" "+n.HtmlClassNames.actionBarInactive+"-"+n.HtmlClassNames.headerActive),s=document.getElementsByClassName(n.HtmlClassNames.webChat+" "+n.HtmlClassNames.actionBarInactive+"-"+n.HtmlClassNames.headerInactive),h=document.getElementsByClassName(n.HtmlClassNames.webChat+" "+n.HtmlClassNames.actionBarActive+"-"+n.HtmlClassNames.headerActive),c=document.getElementsByClassName(n.HtmlClassNames.webChat+" "+n.HtmlClassNames.actionBarActive+"-"+n.HtmlClassNames.headerInactive),u=0,v=document.getElementById(n.HtmlIdNames.chatPlaceHolder),i,f,r,l,e,a,t;v&&(u=v.clientHeight);i=0;f=document.getElementById(n.HtmlIdNames.callingContainer);f&&(i=f.className&&f.className==n.HtmlCssConstants.space+n.HtmlCssConstants.noCallDialog?0:f.clientHeight);r=0;l=document.getElementById(n.HtmlIdNames.webChatHeader);l&&(r=l.clientHeight);e=0;a=document.getElementById(n.HtmlIdNames.actionBar);a&&(e=a.clientHeight);o&&o[0]?(t=o[0],t.style.height=(u-i-r).toString()+"px"):s&&s[0]?(t=s[0],t.style.height=(u-i-r).toString()+"px"):h&&h[0]?(t=h[0],t.style.height=(u-i-r-e).toString()+"px"):c&&c[0]&&(t=c[0],t.style.height=(u-i-r-e).toString()+"px");this.setState({heightSet:!0})},i}(React.Component);n.ChatPlaceholder=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n[n.None=0]="None";n[n.ChatButton=1]="ChatButton";n[n.LoadingScreen=2]="LoadingScreen";n[n.ChatPlaceholder=3]="ChatPlaceholder";n[n.PrechatSurvey=4]="PrechatSurvey";n[n.PostchatSurvey=5]="PostchatSurvey";n[n.ProactiveChatInvite=6]="ProactiveChatInvite";n[n.ChatReconnectSurvey=7]="ChatReconnectSurvey";n[n.OperatingHour=8]="OperatingHour";n[n.PostchatLoadingScreen=9]="PostchatLoadingScreen"})(t=n.Components||(n.Components={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){var i=t.call(this)||this;return i.enterHandlerRejectCall=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&i.props.onCallReject()},i.enterHandlerAcceptVoiceCall=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&i.props.onVoiceCallAccept()},i.enterHandlerAcceptVideoCall=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&i.props.onVideoCallAccept()},i.enterHandlerToggleCamera=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&i.props.onToggleLocalVideoClick()},i.enterHandlerToggleMute=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&i.props.onToggleMuteClick()},i.enterHandlerEndCall=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&i.props.onVoiceVideoCallStopClick()},i.keyHandlers=function(t){t.ctrlKey&&t.shiftKey&&(i.props.isIncomingCallPopup?(t.keyCode===n.Constants.KeyCodes.KEY_D&&i.props.onCallReject(),t.keyCode===n.Constants.KeyCodes.KEY_S&&i.props.onVoiceCallAccept(),t.keyCode===n.Constants.KeyCodes.KEY_A&&i.props.onVideoCallAccept()):(t.keyCode===n.Constants.KeyCodes.KEY_O&&i.props.onToggleLocalVideoClick(),t.keyCode===n.Constants.KeyCodes.KEY_M&&i.props.onToggleMuteClick(),t.keyCode===n.Constants.KeyCodes.KEY_D&&i.props.onVoiceVideoCallStopClick()),t.preventDefault())},i}return __extends(i,t),i.prototype.componentDidMount=function(){n.WebChatKeyboardListeners.removeKeyHandler(this.keyHandlers);n.WebChatKeyboardListeners.addKeyHandler(this.keyHandlers)},i.prototype.componentWillUnmount=function(){n.WebChatKeyboardListeners.removeKeyHandler(this.keyHandlers)},i.prototype.render=function(){var r=this.props.isRemoteVideoEnabled===!0||this.props.isLocalVideoEnabled===!0||this.props.acceptWithVideo===!0?n.HtmlCallingCssConstants.withVideo:n.HtmlCallingCssConstants.withoutVideo,u=this.props.isRemoteVideoEnabled===!0||this.props.isLocalVideoEnabled===!0||this.props.acceptWithVideo===!0?n.HtmlCallingCssConstants.withVideo:n.HtmlCallingCssConstants.withoutVideo,f=this.props.isRemoteVideoEnabled===!0?n.HtmlCallingCssConstants.show:n.HtmlCallingCssConstants.hide,i,t;return i=this.props.isLocalVideoEnabled===!0?this.props.isRemoteVideoEnabled===!0?n.HtmlCallingCssConstants.minimize:n.HtmlCallingCssConstants.maximize:n.HtmlCallingCssConstants.hide,t=this.props.isRemoteVideoEnabled===!0||this.props.isLocalVideoEnabled===!0||this.props.acceptWithVideo===!0?n.HtmlCallingCssConstants.withVideo:n.HtmlCallingCssConstants.withoutVideo,React.createElement("div",{id:n.HtmlIdNames.callContainer,className:n.HtmlClassNames.callContainer},React.createElement("div",{id:n.HtmlIdNames.currentCallBody,className:n.HtmlClassNames.noMargin+r},React.createElement("div",{id:n.HtmlIdNames.remoteVideo,className:n.HtmlClassNames.noMargin+f}),React.createElement("div",{id:n.HtmlIdNames.selfVideo,className:n.HtmlClassNames.noMargin+i})),this.props.isIncomingCallPopup&&React.createElement("div",{id:n.HtmlIdNames.incomingCallPopup,className:n.HtmlClassNames.incomingCallPopup+n.HtmlCssConstants.space+n.HtmlClassNames.noMargin+t,role:n.HtmlAttributeNames.region},React.createElement("div",{className:n.HtmlClassNames.incomingCallMessage,id:n.HtmlIdNames.incomingCallMessage},this.props.locale.INCOMING_CALL_MESSAGE),React.createElement("div",{className:n.HtmlClassNames.incomingCallButtonGroup},React.createElement("div",{className:n.HtmlClassNames.redCircle},React.createElement("div",{id:n.HtmlIdNames.callRejectButton,className:n.HtmlClassNames.callRejectButton,tabIndex:0,"tooltip-title":this.props.locale.REJECT_CALL,"data-for":n.HtmlIdNames.callRejectButton,role:n.HtmlAttributeNames.button,onClick:this.props.onCallReject.bind(this),onKeyDown:this.enterHandlerRejectCall.bind(this),"aria-label":this.props.locale.REJECT_CALL},React.createElement(n.ToolTip,{targetId:n.HtmlIdNames.callRejectButton,place:n.HtmlClassNames.toolTipBottomClass,useKeyboard:!0,"class":n.HtmlClassNames.voiceVideoTooltip}))),this.props.videoCallingEnabled&&React.createElement("div",{className:n.HtmlClassNames.greenCircle},React.createElement("div",{id:n.HtmlIdNames.videoCallAcceptButton,className:n.HtmlClassNames.videoCallAcceptButton,tabIndex:0,"tooltip-title":this.props.locale.ACCEPT_VIDEO_CALL,"data-for":n.HtmlIdNames.videoCallAcceptButton,role:n.HtmlAttributeNames.button,onClick:this.props.onVideoCallAccept.bind(this),onKeyDown:this.enterHandlerAcceptVideoCall.bind(this),"aria-label":this.props.locale.ACCEPT_VIDEO_CALL},React.createElement(n.ToolTip,{targetId:n.HtmlIdNames.videoCallAcceptButton,place:n.HtmlClassNames.toolTipBottomClass,useKeyboard:!0,"class":n.HtmlClassNames.voiceVideoTooltip}))),React.createElement("div",{className:n.HtmlClassNames.greenCircle},React.createElement("div",{id:n.HtmlIdNames.callAcceptButton,className:n.HtmlClassNames.callAcceptButton,tabIndex:0,"tooltip-title":this.props.locale.ACCEPT_VOICE_CALL,"data-for":n.HtmlIdNames.callAcceptButton,role:n.HtmlAttributeNames.button,onClick:this.props.onVoiceCallAccept.bind(this),onKeyDown:this.enterHandlerAcceptVoiceCall.bind(this),"aria-label":this.props.locale.ACCEPT_VOICE_CALL},React.createElement(n.ToolTip,{targetId:n.HtmlIdNames.callAcceptButton,place:n.HtmlClassNames.toolTipBottomClass,useKeyboard:!0,"class":n.HtmlClassNames.voiceVideoTooltip}))))),this.props.isIncomingCallPopup===!1&&React.createElement("div",{id:n.HtmlIdNames.currentCallFooter,className:n.HtmlClassNames.noMargin+t},React.createElement("div",{id:n.HtmlIdNames.currentCallActions,className:n.HtmlClassNames.noMargin+u},this.props.isVoiceOnly===!1&&React.createElement("div",{id:n.HtmlIdNames.toggleVideo,className:this.props.isLocalVideoEnabled===!0?n.HtmlClassNames.videoOn:n.HtmlClassNames.videoOff,tabIndex:0,"data-for":n.HtmlIdNames.toggleVideo,role:n.HtmlAttributeNames.button,onClick:this.props.onToggleLocalVideoClick.bind(this),onKeyDown:this.enterHandlerToggleCamera.bind(this),"tooltip-title":this.props.isLocalVideoEnabled===!0?this.props.locale.TURN_CAMERA_OFF:this.props.locale.TURN_CAMERA_ON,"aria-label":this.props.isLocalVideoEnabled===!0?this.props.locale.TURN_CAMERA_OFF:this.props.locale.TURN_CAMERA_ON},React.createElement(n.ToolTip,{targetId:n.HtmlIdNames.toggleVideo,place:n.HtmlClassNames.toolTipBottomClass,useKeyboard:!0,"class":n.HtmlClassNames.voiceVideoTooltip})),React.createElement("div",{id:n.HtmlIdNames.toggleAudio,className:this.props.isMicrophoneMuted===!0?n.HtmlClassNames.voiceOn:n.HtmlClassNames.voiceOff,tabIndex:0,"data-for":n.HtmlIdNames.toggleAudio,role:n.HtmlAttributeNames.button,onClick:this.props.onToggleMuteClick.bind(this),onKeyDown:this.enterHandlerToggleMute.bind(this),"tooltip-title":this.props.isMicrophoneMuted===!1?this.props.locale.MUTE:this.props.locale.UNMUTE,"aria-label":this.props.isMicrophoneMuted===!1?this.props.locale.MUTE:this.props.locale.UNMUTE},React.createElement(n.ToolTip,{targetId:n.HtmlIdNames.toggleAudio,place:n.HtmlClassNames.toolTipBottomClass,useKeyboard:!0,"class":n.HtmlClassNames.voiceVideoTooltip})),React.createElement("div",{className:n.HtmlClassNames.redBox},React.createElement("div",{id:n.HtmlIdNames.callRejectButton,className:n.HtmlClassNames.callRejectButton,tabIndex:0,role:n.HtmlAttributeNames.button,onClick:this.props.onVoiceVideoCallStopClick.bind(this),onKeyDown:this.enterHandlerEndCall.bind(this),"tooltip-title":this.props.locale.END_CALL,"data-for":n.HtmlIdNames.callRejectButton,"aria-label":this.props.locale.END_CALL},React.createElement(n.ToolTip,{targetId:n.HtmlIdNames.callRejectButton,place:n.HtmlClassNames.toolTipBottomClass,useKeyboard:!0,"class":n.HtmlClassNames.voiceVideoTooltip}))))))},i}(React.Component);n.CurrentCall=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){n.Utility.preventFocusToMoveOutOfElement(n.HtmlIdNames.webChatCloseConversationConfirm);n.Utility.focusOnElement(n.HtmlIdNames.webChatCloseConversationConfirmButtonConfirm)},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.webChatCloseConversationConfirm,className:n.HtmlClassNames.webChatCloseConversationConfirm,role:n.HtmlAttributeNames.region,tabIndex:-1,onKeyDown:this.onEscapeKeyDown.bind(this)},React.createElement("div",{className:n.HtmlClassNames.webChatCloseConversationContentContainer},React.createElement("h1",{className:n.HtmlClassNames.webChatCloseConversationConfirmTitle},this.props.closeConfirmationInput.title),React.createElement("p",{className:n.HtmlClassNames.webChatCloseConversationConfirmSubtitle},this.props.closeConfirmationInput.description),React.createElement("div",{className:n.HtmlClassNames.webChatCloseConversationConfirmButtonContainer},React.createElement("div",{id:n.HtmlIdNames.webChatCloseConversationConfirmButtonConfirm,className:n.HtmlClassNames.webChatCloseConversationConfirmButtonConfirm,tabIndex:0,role:"button",onClick:this.handleClose.bind(this),onKeyDown:this.onConfirmKeyHandler.bind(this),style:{backgroundColor:n.Bootstrapper.widgetThemeColor}},this.props.closeConfirmationInput.confirmationButtonText),React.createElement("div",{className:n.HtmlClassNames.webChatCloseConversationConfirmButtonCancel,tabIndex:0,role:"button",onClick:this.props.closeConfirmationInput.onCancel.bind(this),onKeyDown:this.onCancelKeyHandler.bind(this)},this.props.closeConfirmationInput.cancelButtonText))))},i.prototype.handleClose=function(){this.props.closeConfirmationInput.onConfirm()},i.prototype.onEscapeKeyDown=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ESC&&this.props.closeConfirmationInput.onCancel()},i.prototype.onConfirmKeyHandler=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.handleClose()},i.prototype.onCancelKeyHandler=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.props.closeConfirmationInput.onCancel()},i}(React.Component);n.CloseConfirmation=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.render=function(){var t=this.props.liveChatConfig.chatButtonIconUrl||"",r=this.props.liveChatConfig.chatButtonIconUrl?"":n.HtmlClassNames.webChatImageFile,u=this.props.showCustomCloseButton?n.HtmlClassNames.webChatHeaderMinimizeButtonWithCustomCloseButton:n.HtmlClassNames.webChatHeaderMinimizeButton;return React.createElement("div",{id:n.HtmlIdNames.webChatHeader,className:n.HtmlClassNames.webChatHeader,style:{background:this.props.liveChatConfig.chatButtonColor},role:n.HtmlAttributeNames.region},this.props.showIconAndTitle&&React.createElement("div",{className:n.HtmlClassNames.webChatHeaderIcon+" "+r,style:i.getChatButtonIconStyle(t)}),this.props.showIconAndTitle&&React.createElement("h2",{className:n.HtmlClassNames.webChatHeaderTitle,id:n.HtmlIdNames.webChatHeaderTitle},this.props.liveChatConfig.chatButtonTitle),React.createElement("div",{className:n.HtmlClassNames.webChatHeaderButtonGroup},this.props.showMinimizeButton&&React.createElement("div",{id:n.HtmlIdNames.webChatHeaderMinimizeButton,className:u,tabIndex:0,role:n.HtmlAttributeNames.button,onClick:this.handleMinimize.bind(this),onKeyDown:this.keyHandlerMinimize.bind(this),title:this.props.locale.MINIMIZE_BUTTON_LABEL}),this.props.showCloseButton&&!this.props.showCustomCloseButton&&React.createElement("div",{id:this.props.customCloseButtonId?this.props.customCloseButtonId:n.HtmlIdNames.webChatHeaderCloseButton,className:n.HtmlClassNames.webChatHeaderCloseButton,tabIndex:0,role:n.HtmlAttributeNames.button,onClick:this.props.onClose.bind(this),onKeyDown:this.keyHandlerClose.bind(this)},React.createElement("div",{"class":n.HtmlClassNames.webChatHeaderButtonTitle,title:this.props.locale.CLOSE_BUTTON_LABEL},this.props.locale.CLOSE_BUTTON_LABEL)),this.props.showCloseButton&&this.props.showCustomCloseButton&&React.createElement("button",{id:n.HtmlIdNames.webChatHeaderCustomCloseButton,tabindex:"0",role:n.HtmlAttributeNames.button,"class":n.HtmlClassNames.webChatHeaderCustomCloseButton,onClick:this.props.onClose.bind(this),onKeyDown:this.keyHandlerClose.bind(this),title:decodeURIComponent(n.Bootstrapper.lcwEnableCustomCloseButtonText)},decodeURIComponent(n.Bootstrapper.lcwEnableCustomCloseButtonText))))},i.getChatButtonIconStyle=function(n){return{backgroundImage:"url("+n+")"}},i.prototype.handleMinimize=function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWOnMinimizedEvent);this.props.onMinimize()},i.prototype.keyHandlerMinimize=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.handleMinimize()},i.prototype.keyHandlerClose=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.props.onClose()},i}(React.Component);n.Header=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.ic3AdapterActivityCallbacks=[]}return t.prototype.initChatAdapter=function(){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(){return n.Loader.liveChatConfig.authClientFunction&&n.Loader.liveChatConfig.isPersistentChat&&(n.Loader.PersistentChatTimer=setInterval(function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,n.Loader.fetchChatToken(!1)];case 1:return t.sent(),n.Loader.ChatAdapter.updateChatToken(n.Loader.currentConversation.token.chatToken,n.Loader.currentConversation.regionGtms),[2]}})})},n.ConfigurationManager.PersistentChatTokenUpdateTime)),t=function(t){t.id===n.NotificationScenarios.InternetConnection&&t.level==n.NotificationLevel.Error&&(t.message=n.Loader.Locale.BANNER_NO_INTERNET_CONNECTION);t.id===n.NotificationScenarios.InternetConnection&&t.level==n.NotificationLevel.Success&&(t.message=n.Loader.Locale.BANNER_INTERNET_BACK_ONLINE);t.id&&t.message&&n.NotificationHandler.notifyWithLevel(t.id,t.message,t.level)},i=function(){n.ChatRootReact.closeSession()},n.Loader.ChatAdapter=new window[n.Constants.Microsoft][n.Constants.BotFramework][n.Constants.WebChat].IC3Adapter({chatToken:{chatId:n.Loader.currentConversation.chatId,regionGTMS:n.Loader.currentConversation.regionGtms,requestId:n.Loader.currentConversation.currentRequestId,token:n.Loader.currentConversation.token.chatToken},userDisplayName:n.Constants.CustomerDisplayName,userId:n.Loader.currentConversation.userId||n.Constants.DefaultUserId,callbackOnNotification:t,callbackOnThreadNotFound:i,sdkURL:n.ScriptPaths.IC3ClientPath.replace("{VERSION}",n.ConfigurationManager.IC3ClientVersion),featureConfig:{ShouldEnableInlinePlaying:n.FeaturesManager.shouldEnableInlinePlaying()}},new n.IC3ClientSdkLogger),this.SubsribeToIC3AdapterActivities(),[2]})})},t.prototype.registerOnNewMessageActivityCallback=function(t){this.ic3AdapterActivityCallbacks[n.AdapterActivityType.Message]?this.ic3AdapterActivityCallbacks[n.AdapterActivityType.Message].push(t):this.ic3AdapterActivityCallbacks[n.AdapterActivityType.Message]=[t]},t.prototype.SubsribeToIC3AdapterActivities=function(){n.Loader.ChatAdapter.activity$.subscribe(this.onNewIc3AdapterActivityHandler.bind(this))},t.prototype.onNewIc3AdapterActivityHandler=function(t){var i=t.type&&t.type===n.AdapterActivityType.Message,r=i&&!n.Utility.isHistoryMessage(t);i&&this.ic3AdapterActivityCallbacks[n.AdapterActivityType.Message]&&this.ic3AdapterActivityCallbacks[n.AdapterActivityType.Message].forEach(function(n){return n(t)});r&&n.NewMessageEventHandler.raiseMessageEvent(t,n.Bootstrapper.isPopOutMode)},t}();n.LiveChatVersion1=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.acsAdapterActivityCallbacks=[]}return t.prototype.initChatAdapter=function(){return __awaiter(this,void 0,void 0,function(){var t,i,u,r,f;return __generator(this,function(){t=[];i=[];t=[n.createFormatEgressTagsMiddleware()];i=[n.createFormatIngressTagsMiddleware()];u={enableAdaptiveCards:!0,enableThreadMemberUpdateNotification:!0,enableLeaveThreadOnWindowClosed:!1,egressMiddleware:t,ingressMiddleware:i};r=new n.AMSFileManager;r.init(n.Loader.currentConversation);try{f=window[n.Constants.ChatAdapter];n.Loader.ChatAdapter=f.createACSAdapter(n.Loader.currentConversation.token.chatToken,n.Loader.currentConversation.userId||n.Constants.DefaultUserId,n.Loader.currentConversation.chatId,n.Loader.currentConversation.acsResourceEndpoint,r,n.ConfigurationManager.ChatAdapterFirstMessagePollingInterval,n.Constants.CustomerDisplayName,undefined,new n.ACSAdapterLogger,u)}catch(e){n.TelemetryClient.info({Event:n.TelemetryEvent.ACSChatAdapterLoadEvent,ExceptionDetails:{ErrorDescription:"Failed to load ACS ChatAdapter",Error:e}});throw new Error("Failed to load ACS ChatAdapter");}return this.subsribeToACSAdapterActivities(),[2]})})},t.prototype.registerOnNewMessageActivityCallback=function(t){this.acsAdapterActivityCallbacks[n.AdapterActivityType.Message]?this.acsAdapterActivityCallbacks[n.AdapterActivityType.Message].push(t):this.acsAdapterActivityCallbacks[n.AdapterActivityType.Message]=[t]},t.prototype.subsribeToACSAdapterActivities=function(){n.Loader.ChatAdapter.activity$.subscribe(this.onNewACSAdapterActivityHandler.bind(this))},t.prototype.onNewACSAdapterActivityHandler=function(t){var i=t.type&&t.type===n.AdapterActivityType.Message,r=i&&!n.Utility.isFromList(t);i&&this.acsAdapterActivityCallbacks[n.AdapterActivityType.Message]&&this.acsAdapterActivityCallbacks[n.AdapterActivityType.Message].forEach(function(n){return n(t)});r&&n.NewMessageEventHandler.raiseMessageEvent(t,n.Bootstrapper.isPopOutMode)},t}();n.LiveChatVersion2=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function i(){var i=document.createElement(n.Constants.HTMLConstants.div);i.id=n.HtmlIdNames.MSLiveChatWidget;i.setAttribute(n.HtmlAttributeNames.role,n.HtmlAttributeNames.navigation);document.getElementsByTagName(n.Constants.HTMLConstants.body)[0].appendChild(i);n.Render.ReactRender(React.createElement(t,null),i)}var t=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.componentDidMount=function(){this.bindFunc(this.refs.chatRef.state.handleChatButtonClick.bind(this),this.refs.chatRef.state.startProactiveChat.bind(this),this.refs.chatRef.state.closeSession.bind(this),this.refs.chatRef.state.handleConversationEnd.bind(this))},i.prototype.render=function(){var t=n.HtmlClassNames.chatRootReactClassName;return n.Bootstrapper.enableAutofill&&(t+=" "+n.HtmlClassNames.ocAutofill),n.Bootstrapper.renderOnMobileDevice?t+=" "+n.HtmlClassNames.inAppClassName:n.Bootstrapper.isPopOutMode&&(t+=" "+n.HtmlClassNames.popOutWindowClassName),React.createElement("div",{className:t,id:n.HtmlIdNames.chatRootReactId,dir:n.Util.getLocaleDirection(n.Loader.liveChatConfig.chatWidgetLocaleLCID)},React.createElement(n.ChatContainer,{ref:"chatRef",liveChatConfig:n.Loader.liveChatConfig,locale:n.Loader.Locale}))},i.prototype.bindFunc=function(n,t,r,u){i.handleChatButtonClick=n;i.startProactiveChat=t;i.closeSession=r;i.handleConversationEnd=u},i}(React.Component);n.ChatRootReact=t;n.renderMain=i})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.isAuthPersistentChat=function(){return n.Loader.liveChatConfig.isPersistentChat&&!n.Util.isNullOrUndefined(n.Loader.liveChatConfig.authClientFunction)},t}();n.PersistentChatHandler=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.LoadWidgetInPopOutWindow=function(t,i){var e,r;if(t===void 0&&(t=null),i===void 0&&(i=null),n.Util.isNullOrUndefined(n.Loader.liveChatConfig.authClientFunction)||i){e=n.Bootstrapper.srcUrl.substring(0,n.Bootstrapper.srcUrl.indexOf("/script"));r=e.concat(n.Constants.ChatHTMLPath,n.Constants.EndURLSeparator,n.Constants.URLDelimiter,n.Constants.IdAttributeName,n.Constants.Equal,n.Constants.LiveChatScriptId,n.Constants.URLDelimiter,n.Constants.PopOutChatConstants.isPopOutModeAttributeName,n.Constants.Equal,n.Constants.PopOutChatConstants.isPopOutModeAttributeValue,n.Constants.URLDelimiter,n.Constants.AppIdAttributeName,n.Constants.Equal,n.Bootstrapper.widgetId,n.Constants.URLDelimiter,n.Constants.OrgIdAttributeName,n.Constants.Equal,n.Bootstrapper.orgId,n.Constants.URLDelimiter,n.Constants.OrgUrlAttributeName,n.Constants.Equal,n.Bootstrapper.orgUrl,n.Constants.URLDelimiter,n.Constants.DisableTelemetryAttributeName,n.Constants.Equal,n.Bootstrapper.disableTelemetry.toString(),n.Constants.URLDelimiter,n.Constants.EnvironmentVersionAttributeName,n.Constants.Equal,n.Bootstrapper.environmentVersion,n.Constants.URLDelimiter,n.Constants.HostNameAttributeName,n.Constants.Equal,n.Bootstrapper.hostName);n.Bootstrapper.widgetThemeColor&&(r=r.concat(n.Constants.URLDelimiter,n.Constants.WidgetColorOverride,n.Constants.Equal,encodeURIComponent(n.Bootstrapper.widgetThemeColor)));n.Bootstrapper.widgetFontFamily&&(r=r.concat(n.Constants.URLDelimiter,n.Constants.WidgetFontFamily,n.Constants.Equal,n.Bootstrapper.widgetFontFamily));n.Bootstrapper.enableNewlineSupport&&(r=r.concat(n.Constants.URLDelimiter,n.Constants.EnableNewLineMarkdownSupport,n.Constants.Equal,n.Bootstrapper.enableNewlineSupport===n.Constants.Default?n.Constants.Default:String(n.Bootstrapper.enableNewlineSupport.trim().toLowerCase()===n.Constants.True)));n.Bootstrapper.suggestedActionLayout&&(r=r.concat(n.Constants.URLDelimiter,n.Constants.SuggestedActionLayout,n.Constants.Equal,n.Bootstrapper.suggestedActionLayout));n.Loader.reconnectId&&(r=r.concat(n.Constants.URLDelimiter,n.Constants.ReconnectIdAttributeName,n.Constants.Equal,n.Loader.reconnectId));var u=screen.availWidth*n.ConfigurationManager.popOutWindowWidthScaleFactor,f=screen.availHeight*n.ConfigurationManager.popOutWindowHeightScaleFactor,o=window.outerHeight/2+window.screenY-f/2,s=window.outerWidth/2+window.screenX-u/2;t==!0?(r=r.concat(n.Constants.URLDelimiter,n.Constants.PopOutChatConstants.isCustomPopOutModeAttributeName,n.Constants.Equal,n.Constants.PopOutChatConstants.isCustomPopOutModeAttributeValue),n.Util.raiseCustomEvent(n.IframeMessages.startPopoutChatResponse,{popOutUrl:r,target:n.Constants.PopOutChatConstants.target,width:u,height:f,top:o,left:s})):(this.popOutWindowOpenRef=window.open("",n.Constants.PopOutChatConstants.target,"width="+u+",height="+f+",location=no, top="+o+", left="+s+", resizable=yes"),this.popOutWindowOpenRef.location.href===n.Constants.PopOutChatConstants.popoutWindowBlankHref?this.popOutWindowOpenRef.location.replace(r):this.popOutWindowOpenRef.focus(),this.setupCommunicationBetweenPopoutWindow(this.popOutWindowOpenRef))}},t.setupCommunicationBetweenPopoutWindow=function(t){t&&window.addEventListener(n.EventConstants.message,function(i){i.data&&i.data.messageName==n.IframeMessages.authTokenResponse&&t.postMessage({messageName:n.IframeMessages.authTokenResponse,authToken:i.data.authToken},"*");i.data&&i.data.messageName==n.IframeMessages.initContextParamsResponse&&t.postMessage({messageName:n.IframeMessages.initContextParamsResponse,payload:{contextVariables:n.Loader.contextProvider?n.Loader.contextProvider():null,isProactiveChat:n.Loader.currentConversation.isProactiveChat?1:0,latitude:n.Loader.initContext.latitude,longitude:n.Loader.initContext.longitude}},"*");i.data&&i.data.messageName==n.IframeMessages.closePopoutChatMessage&&n.Loader.currentConversation&&n.Loader.currentConversation.isProactiveChat&&(n.Loader.currentConversation.isProactiveChat=!1)})},t}();n.PopoutHandler=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i){var r=t.call(this,i)||this;return r.isPlaying=!1,i.audioElement?(r.audioElement=i.audioElement,r.audioElement.src=r.props.url):r.audioElement=new Audio(r.props.url),r.state={isAudioOn:!0&&n.Loader.currentConversation.isCustomerAudioOn,audioAction:n.AudioNotificationAction.getAudioNotificationAction(!0&&n.Loader.currentConversation.isCustomerAudioOn)},r}return __extends(i,t),i.prototype.componentDidMount=function(){this.audioElement.addEventListener(n.EventConstants.audioEnded,this.disablePlaying.bind(this));this.audioElement.addEventListener(n.EventConstants.audioPlayError,this.handleError.bind(this));window.addEventListener(n.LCWEvents.LCWPlayAudioNotification,this.playAudio.bind(this))},i.prototype.componentWillUnmount=function(){this.audioElement.removeEventListener(n.EventConstants.audioEnded,this.disablePlaying.bind(this));this.audioElement.removeEventListener(n.EventConstants.audioPlayError,this.handleError.bind(this));window.removeEventListener(n.LCWEvents.LCWPlayAudioNotification,this.playAudio.bind(this))},i.prototype.toggleAudio=function(){n.Loader.currentConversation.isCustomerAudioOn=!n.Loader.currentConversation.isCustomerAudioOn;this.setState(function(t){return{isAudioOn:!t.isAudioOn,audioAction:n.AudioNotificationAction.getAudioNotificationAction(!t.isAudioOn)}})},i.prototype.getImagePath=function(){return this.state.isAudioOn?n.ScriptPaths.AudioNotificationOnIconPath:n.ScriptPaths.AudioNotificationOffIconPath},i.prototype.render=function(){var r=this.getImagePath(),t=n.BrowserInfo.isEdge(),i=n.BrowserInfo.isChrome();return React.createElement("div",{className:n.HtmlClassNames.actionBar+"-"+this.state.audioAction.name+"-"+n.HtmlClassNames.actionBarIconContainer,role:t||i?null:n.HtmlAttributeNames.button,"tooltip-title":this.state.audioAction.title,onClick:this.toggleAudio.bind(this),"data-for":this.state.audioAction.id},React.createElement(n.ToolTip,{targetId:this.state.audioAction.id,delayHide:10}),React.createElement("button",{id:this.state.audioAction.id,type:t?n.HtmlAttributeNames.button:null,className:n.HtmlClassNames.actionBar+"-"+this.state.audioAction.name+"-"+n.HtmlClassNames.actionBarIconButton,"aria-label":this.state.audioAction.title},React.createElement("img",{className:n.HtmlClassNames.actionBar+"-"+this.state.audioAction.name+"-"+n.HtmlClassNames.actionBarIconImage,src:this.state.audioAction.src,alt:this.state.audioAction.alt})))},i.prototype.disablePlaying=function(){this.isPlaying=!1},i.prototype.playAudio=function(){this.state.isAudioOn&&n.Loader.currentConversation.isCustomerAudioOn&&!this.isPlaying&&(this.isPlaying=!0,this.audioElement.play())},i.prototype.handleError=function(t){this.disablePlaying();n.TelemetryClient.error({Event:n.TelemetryEvent.AudioNotificationError,ExceptionDetails:t})},i}(React.Component);n.AudioNotification=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(r){var u=t.call(this,r)||this;return u.state={uuid:n.ToolTipUtils.generateUUID(),show:!1,delayHide:i.defaultDelayHide,event:r.event||null,originTooltip:null,offset:{},desiredPlace:i.defaultPosition,place:i.defaultPosition,currentTarget:null,currentEvent:null,useKeyboard:i.defaultValueUseKeyboard,ariaProps:n.Utility.getAriaAttributes(r),inlineStyle:null,"class":r.class},u.bindActions(["showTooltip","hideTooltip","mouseOnToolTip"]),u.delayHideLoop=null,u.tooltipRef=null,u}return __extends(i,t),i.prototype.render=function(){var u=this,t=this.state,r=t.originTooltip,f=t.uuid,e=t.ariaProps,o=t.inlineStyle,s=n.HtmlClassNames.toolTipBaseClass+(" "+f)+(" "+i.positionPrefix+this.state.place)+(" "+this.state.class)+(this.state.show&&r?" "+n.HtmlClassNames.toolTipShowClass:"");return React.createElement("div",__assign({id:this.props.id,ref:function(n){return u.tooltipRef=n},"data-id":"tooltip"},e,{className:""+s,style:o,onClick:"event.preventDefault()"}),r)},i.prototype.componentDidMount=function(){this.bindListener()},i.prototype.componentWillUnmount=function(){this.unbindListeners()},i.prototype.bindActions=function(n){var t=this;n.forEach(function(n){t[n].bind&&(t[n]=t[n].bind(t))})},i.prototype.showTooltip=function(t){var f=t.currentTarget.getAttribute(i.tooltipTitleAttribute),r=this.props.place||i.defaultPosition,u=n.ToolTipUtils.getPosition(t.currentTarget,this.tooltipRef,r,r,{}),e=u.isNewState?u.newState.place:r;this.clearTimer();this.setState({delayHide:t.currentTarget.getAttribute(i.dataDelayHideAttribute)||this.props.delayHide||i.defaultDelayHide,originTooltip:f,place:e,currentTarget:t.currentTarget,currentEvent:t,show:!0,useKeyboard:this.props.useKeyboard||i.defaultValueUseKeyboard,inlineStyle:this.props.inlineStyle,"class":this.props.class})},i.prototype.hideTooltip=function(n,t){var r=this,u=this.state,e=u.delayHide,h=u.originTooltip,c=u.show,o,s,f;(n.currentTarget!==i.lastTarget&&i.lastTargetTooltipResetCallback(this),i.lastTarget=n.currentTarget,!this.mouseOnToolTip()&&h)&&(!t||(o=this.getTargetArray(this.props.id),s=o.some(function(t){return t===n.currentTarget}),s&&c))&&(f=function(){if(r.mouseOnToolTip()){r.listenForTooltipExit();return}r.forceHide()},this.clearTimer(),e?this.delayHideLoop=setTimeout(f,parseInt(e,10)):f())},i.prototype.forceHide=function(){this.removeListenerForTooltipExit();this.setState({show:!1})},i.prototype.bindListener=function(){var t=this,i=this.getTargetArray(this.props.targetId),r=this.state.stateUseKeyboard;i.forEach(function(n){t.unbindBasicListener(n)});i.forEach(function(i){i.addEventListener(n.HtmlEventNames.mouseenter,t.showTooltip);i.addEventListener(n.HtmlEventNames.mouseleave,t.hideTooltip);(t.props.useKeyboard||r)&&(i.addEventListener(n.HtmlEventNames.focus,t.showTooltip),i.addEventListener(n.HtmlEventNames.blur,t.hideTooltip))})},i.prototype.unbindListeners=function(){var n=this,t=this.getTargetArray(this.props.targetId);t.forEach(function(t){n.unbindBasicListener(t)})},i.prototype.getTargetArray=function(n){var u=this,t=[],i,r;if(n)r=n.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),i='[data-for="'+r+'"]';else return t;return this.nodeListToArray(document.getElementsByTagName("*")).filter(function(n){return n.shadowRoot}).forEach(function(n){t=t.concat(u.nodeListToArray(n.shadowRoot.querySelectorAll(i)))}),t.concat(this.nodeListToArray(document.querySelectorAll(i)))},i.prototype.nodeListToArray=function(n){var t=n.length;return n.hasOwnProperty?Array.prototype.slice.call(n):new Array(t).map(function(t){return n[t]})},i.prototype.unbindBasicListener=function(t){t.removeEventListener(n.HtmlEventNames.mouseenter,this.showTooltip);t.removeEventListener(n.HtmlEventNames.mouseleave,this.hideTooltip)},i.prototype.clearTimer=function(){clearTimeout(this.delayHideLoop)},i.prototype.listenForTooltipExit=function(){var t=this.state.show;t&&this.tooltipRef&&this.tooltipRef.addEventListener(n.HtmlEventNames.mouseleave,this.hideTooltip)},i.prototype.removeListenerForTooltipExit=function(){var t=this.state.show;t&&this.tooltipRef&&this.tooltipRef.removeEventListener(n.HtmlEventNames.mouseleave,this.hideTooltip)},i.prototype.mouseOnToolTip=function(){var n=this.state.show;return n&&this.tooltipRef?(this.tooltipRef.matches||(this.tooltipRef.matches=this.tooltipRef.msMatchesSelector?this.tooltipRef.msMatchesSelector:this.tooltipRef.mozMatchesSelector),this.tooltipRef.matches(":"+i.hoverAttribute)):!1},i.defaultPosition="top",i.positionPrefix="toolTipPlace-",i.tooltipTitleAttribute="tooltip-title",i.dataDelayHideAttribute="data-delay-hide",i.hoverAttribute="hover",i.defaultValueUseKeyboard=!1,i.defaultDelayHide=0,i.lastTarget=null,i.lastTargetTooltipResetCallback=function(n){n.forceHide()},i}(React.Component);n.ToolTip=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getPosition=function(n,t,i,r,u){for(var c,e,l,a,v=this.getDimensions(t),ut=v.width,ft=v.height,y=this.getDimensions(n),et=y.width,ot=y.height,p=this.getCurrentOffset(n),w=p.mouseX,b=p.mouseY,f=this.getDefaultPosition(et,ot,ut,ft),k=this.calculateOffset(u),d=k.extraOffsetX,g=k.extraOffsetY,st=window.innerWidth,ht=window.innerHeight,nt=this.getParent(t),ct=nt.parentTop,lt=nt.parentLeft,tt=function(n){var t=f[n].l;return w+t+d},at=function(n){var t=f[n].r;return w+t+d},it=function(n){var t=f[n].t;return b+t+g},vt=function(n){var t=f[n].b;return b+t+g},yt=function(n){return tt(n)<0},pt=function(n){return at(n)>st},wt=function(n){return it(n)<0},bt=function(n){return vt(n)>ht},o=function(n){return yt(n)||pt(n)||wt(n)||bt(n)},rt=function(n){return!o(n)},kt=["top","bottom","left","right"],s=[],h=0;h<4;h++)c=kt[h],rt(c)&&s.push(c);return(e=!1,a=r!==i,rt(r)&&a?(e=!0,l=r):s.length>0&&a&&o(r)&&o(i)&&(e=!0,l=s[0]),e)?{isNewState:!0,newState:{place:l}}:{isNewState:!1,position:{left:parseInt(tt(i)-lt+"",10),top:parseInt(it(i)-ct+"",10)}}},t.generateUUID=function(){return"t"+n.Utility.getGUID()},t.getDimensions=function(n){var t=n.getBoundingClientRect(),i=t.height,r=t.width;return{height:parseInt(i,10),width:parseInt(r,10)}},t.getCurrentOffset=function(n){var i=n.getBoundingClientRect(),u=i.top,f=i.left,r=t.getDimensions(n),e=r.width,o=r.height;return{mouseX:f+e/2,mouseY:u+o/2}},t.getDefaultPosition=function(n,t,i,r){var f,e,o,s,u=2;return f={l:-(i/2),r:i/2,t:-(t/2+r+u),b:-(t/2)},o={l:-(i/2),r:i/2,t:t/2,b:t/2+r+u},s={l:-(i+n/2+u),r:-(n/2),t:-(r/2),b:r/2},e={l:n/2,r:i+n/2+u,t:-(r/2),b:r/2},{top:f,bottom:o,left:s,right:e}},t.calculateOffset=function(n){var r=0,u=0,i,f,t;for(Object.prototype.toString.apply(n)==="[object String]"&&(n=JSON.parse(n.toString().replace(/'/g,'"'))),i=0,f=Object.keys(n);i<f.length;i++)t=f[i],t==="top"?u-=parseInt(n[t],10):t==="bottom"?u+=parseInt(n[t],10):t==="left"?r-=parseInt(n[t],10):t==="right"&&(r+=parseInt(n[t],10));return{extraOffsetX:r,extraOffsetY:u}},t.getParent=function(n){for(var t=n,i,r;t;){if(window.getComputedStyle(t).getPropertyValue("transform")!=="none")break;t=t.parentElement}return i=t&&t.getBoundingClientRect().top||0,r=t&&t.getBoundingClientRect().left||0,{parentTop:i,parentLeft:r}},t}();n.ToolTipUtils=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){n.DIRECT_LINE_CONNECT_FULFILLED="DIRECT_LINE/CONNECT_FULFILLED";n.DIRECT_LINE_CONNECT="DIRECT_LINE/CONNECT";n.DIRECT_LINE_CONNECT_PENDING="DIRECT_LINE/CONNECT_PENDING";n.DIRECT_LINE_UPDATE_CONNECTION_STATUS="DIRECT_LINE/UPDATE_CONNECTION_STATUS";n.DIRECT_LINE_CONNECT_FULFILLING="DIRECT_LINE/CONNECT_FULFILLING";n.DIRECT_LINE_POST_ACTIVITY="DIRECT_LINE/POST_ACTIVITY";n.DIRECT_LINE_POST_ACTIVITY_PENDING="DIRECT_LINE/POST_ACTIVITY_PENDING";n.DIRECT_LINE_POST_ACTIVITY_FULFILLED="DIRECT_LINE/POST_ACTIVITY_FULFILLED";n.DIRECT_LINE_INCOMING_ACTIVITY="DIRECT_LINE/INCOMING_ACTIVITY";n.WEB_CHAT_SET_LANGUAGE="WEB_CHAT/SET_LANGUAGE";n.WEB_CHAT_SEND_MESSAGE="WEB_CHAT/SEND_MESSAGE";n.WEB_CHAT_SET_SEND_TIMEOUT="WEB_CHAT/SET_SEND_TIMEOUT";n.WEB_CHAT_SET_SEND_TYPING_INDICATOR="WEB_CHAT/SET_SEND_TYPING_INDICATOR";n.WEB_CHAT_SET_SUGGESTED_ACTIONS="WEB_CHAT/SET_SUGGESTED_ACTIONS";n.WEB_CHAT_STOP_DICTATE="WEB_CHAT/STOP_DICTATE";n.WEB_CHAT_STOP_SPEAKING="WEB_CHAT/STOP_SPEAKING";n.WEB_CHAT_SEND_EVENT="WEB_CHAT/SEND_EVENT";n.WEB_CHAT_SET_NOTIFICATION="WEB_CHAT/SET_NOTIFICATION";n.WEB_CHAT_DISMISS_NOTIFICATION="WEB_CHAT/DISMISS_NOTIFICATION";n.WEB_CHAT_SET_SEND_BOX="WEB_CHAT/SET_SEND_BOX";n.WEB_CHAT_SEND_FILES="WEB_CHAT/SEND_FILES"})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.applicable=function(t){if(t.type===n.WEB_CHAT_SEND_FILES){var i=t.payload.files[0];return!n.Util.isNullOrUndefined(i)}return!1},t.prototype.createSendFileAction=function(t){return{payload:{files:t},type:n.WEB_CHAT_SEND_FILES}},t.prototype.apply=function(n){var t,i,r,u,f;return n.payload.files.length>0?(t=n.payload.files,t.length===1)?(i=n,{dispatchAction:null,nextAction:i}):(r=this.createSendFileAction(t.slice(0,t.length-1)),u=this.createSendFileAction([t[t.length-1]]),{dispatchAction:r,nextAction:u}):(f=n,{dispatchAction:null,nextAction:f})},t}();n.AttachmentProcessingMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.AttachmentProcessingMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.AttachmentProcessingMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.applicable=function(t){return t.type===n.DIRECT_LINE_POST_ACTIVITY_PENDING&&t.payload&&t.payload.activity&&t.payload.activity.channelData},t.prototype.apply=function(i){var e=n.Bootstrapper.LiveChatContext,u=""+t.channelIdKey+n.Constants.ChannelId,f=""+n.Constants.CustomerTag,r=i;return r.payload.activity.channelData.tags?(r.payload.activity.channelData.tags.includes(u)||r.payload.activity.channelData.tags.push(u),r.payload.activity.channelData.tags.includes(f)||r.payload.activity.channelData.tags.push(f)):(r.payload.activity.channelData.tags=[u],r.payload.activity.channelData.tags.push(f)),r.payload.activity.channelData.metadata={deliveryMode:n.DeliveryMode.Bridged,widgetId:e.widgetId},{dispatchAction:null,nextAction:r}},t.channelIdKey="ChannelId-",t}();n.ChannelDataMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.ChannelDataMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.ChannelDataMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.apply=function(n){var i=n;return t.rerenderWebChatWithoutSendBox(),{dispatchAction:null,nextAction:i}},t.rerenderWebChatWithoutSendBox=function(){n.ChatContainer.webChatProxy.rerenderWebChat(!0)},t.prototype.applicable=function(t){var i,r;try{if(t&&t.payload&&t.payload.activity&&t.payload.activity.from&&t.payload.activity.actionType==n.DIRECT_LINE_INCOMING_ACTIVITY&&(i=t.payload.activity,i.from.role===n.DirectLineSenderRole.Channel&&i.channelData&&i.channelData.type&&i.channelData.type===n.Constants.MessageTypes.THREAD&&i.channelData.properties&&(i.channelData.properties.isdeleted===n.Constants.TruePascal||!i.channelData.properties.containsExternalEntitiesListeningAll)||i.from&&i.from.role===n.DirectLineSenderRole.Bot&&i.channelData&&i.channelData.tags&&i.channelData.tags.includes(n.Constants.SystemMessageTag)&&i.channelData.tags.includes(n.Constants.AgentEndConversationMessageTag)))return!0}catch(u){r="Failed to validate action.";try{r=r+JSON.stringify(t)}catch(u){r+" (unable to stringify action)"}console.error(r);n.TelemetryClient.error({Event:n.TelemetryEvent.ProcessingConversationEndMiddlewareFailed,ExceptionDetails:{ErrorData:r,Exception:u}})}return!1},t}();n.ConversationEndMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.ConversationEndMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.ConversationEndMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function t(n,t){var i,u=[],r;return n.length>0&&n.forEach(function(n){r&&t(r,n)?i.push(n):(i=[n],u.push(i));r=n}),u}function i(){return function(){return function(i){return function(r){var u=r.activities,f;return u!=null&&u.length>0?(f=i({activities:u}).status,{sender:t(u,function(t,i){var r=t.channelData&&t.channelData.tags?t.channelData.tags.includes(n.Constants.SystemMessageTag)?n.Constants.SystemMessageTag:t.from.name:t.from.name,u=i.channelData&&i.channelData.tags?i.channelData.tags.includes(n.Constants.SystemMessageTag)?n.Constants.SystemMessageTag:i.from.name:i.from.name;return r===u}),status:f}):function(){return!1}}}}}n.createGroupActivityMiddleware=i})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function t(){return function(){return function(n){return function(t){var i=JSON.parse(JSON.stringify(t)),r;if(i&&i.channelData&&i.channelData.tags&&(r=i.channelData.tags,typeof r=="string"))try{i.channelData.tags=JSON.parse(r)}catch(u){i.channelData.tags=r.split(",")}return n(i)}}}}function i(){return function(){return function(t){return function(i){var r=JSON.parse(JSON.stringify(i)),u;if(r&&(r.text&&(r.text=r.text.replace("&amp;","&")),r.channelData&&r.channelData.tags)){if(u=r.channelData.tags,typeof u=="string")return t(i);if(u instanceof Array)r.channelData.tags=u.toString();else if(typeof r.channelData.tags=="object")try{r.channelData.tags=JSON.stringify(u)}catch(f){console.error(f);n.TelemetryClient.error({Event:n.TelemetryEvent.FormatTagsMiddlewareJSONStringifyFailed,ExceptionDetails:{Exception:f}})}}return t(r)}}}}n.createFormatIngressTagsMiddleware=t;n.createFormatEgressTagsMiddleware=i})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.buildMaxLengthErrorMessage=function(t){return t===1?n.Loader.Locale.MaxCharacterCountExceededSingle.replace("{0}",t):n.Loader.Locale.MaxCharacterCountExceededMultiple.replace("{0}",t)}}return t.prototype.apply=function(t){var i=t&&t.payload&&t.payload.text&&t.payload.text.length||0,r=n.ConfigurationManager.MaxCharactersLimit;return i>r?n.NotificationHandler.notifyError(n.NotificationScenarios.MaxSizeError,this.buildMaxLengthErrorMessage(i-r)):n.NotificationHandler.dismissNotification(n.NotificationScenarios.MaxSizeError),{dispatchAction:null,nextAction:null}},t.prototype.applicable=function(t){return t.type===n.WEB_CHAT_SET_SEND_BOX},t}();n.MaxMessageSizeMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.MaxMessageSizeMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.MaxMessageSizeMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function t(){return function(){return function(t){return function(i){var f=i.activity,a=f.channelData.tags,s=f.from,v=s.name,y=s.role,p=f.timestamp,r=i.sendState,w=i.sameTimestampGroup,h=a,c=v,b=y,k=p,e=w,u;if(i[n.WebChatMiddlewareConstants.nextVisibleActivity]){var o=i.nextVisibleActivity,d=o.channelData.tags,l=o.from,g=l.name,nt=l.role,tt=o.timestamp,et=d,it=g,ot=nt,rt=tt,ut=Date.parse(k),ft=Date.parse(rt);(c!==it||ft-ut>n.WebChatMiddlewareConstants.timeBetweenTimestampGroups)&&(e=!1)}if((!h||!h.includes(n.Constants.SystemMessageTag))&&(!e||r!==n.SendStatus.Sent))return u=n.Util.getLocaleDirection(n.Loader.liveChatConfig.chatWidgetLocaleLCID),React.createElement("span",{className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestamp},r===n.SendStatus.Sending&&React.createElement(n.SendingTimestamp,{next:t,args:i,dir:u}),r===n.SendStatus.SendFailed&&React.createElement(n.NotDeliveredTimestamp,{next:t,args:i,dir:u}),r===n.SendStatus.Sent&&React.createElement(n.DeliveredTimestamp,{next:t,args:i,dir:u,role:b,name:c,sameTimestampGroupTemp:e}))}}}}n.createActivityStatusMiddleware=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){function r(){return function(){return function(n){return function(){for(var i,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];if(i=r[0],i.activity){if(i.activity.from&&i.activity.from.role===t.DirectLineSenderRole.Channel)return i.activity.channelData&&i.activity.channelData.type&&i.activity.channelData.type===t.Constants.MessageTypes.THREAD&&u(i.activity.channelData),function(){return!1};if(i.activity.channelData&&i.activity.channelData.tags&&i.activity.channelData.tags.includes(t.Constants.SystemMessageTag))return f(n,r,i);if(!t.Util.isNullOrEmptyString(i.activity.text)&&i.activity.type===t.WebChatMiddlewareConstants.message&&i.activity.from&&i.activity.from.role){if(i.activity.from.role!==t.WebChatMiddlewareConstants.user)return function(){for(var u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return React.createElement("div",{className:t.WebChatMiddlewareConstants.receivedMessageClassName},n.apply(void 0,r).apply(void 0,u))};i.activity.channelData.isHtmlEncoded||i.activity.channelId!==t.WebChatMiddlewareConstants.webchatChannelId||(i.activity.text=t.Utility.escapeHtml(i.activity.text),i.activity.channelData.isHtmlEncoded=!0)}}return n.apply(void 0,r)}}}}function u(n){var r,f,i,e,u;if(t.TelemetryClient.info({Event:t.TelemetryEvent.IC3ThreadUpdateEvent}),r=function(){t.Loader.liveChatConfig.authClientFunction&&t.Loader.liveChatConfig.isPersistentChat&&t.Loader.PersistentChatTimer&&(clearInterval(t.Loader.PersistentChatTimer),t.Loader.PersistentChatTimer=null);t.Loader.currentConversation.isChatComplete=!0;t.Util.raiseCustomEvent(t.LCWEvents.LCWThreadUpdateEvent);t.Util.raiseCustomEvent(t.LCWEvents.LCWOnEndConversationEvent);t.ChatRootReact.handleConversationEnd()},f=!t.Util.isNullOrUndefined(n.properties)&&!t.Util.isNullOrEmptyString(n.properties.isdeleted)&&n.properties.isdeleted.toLowerCase()===t.WebChatMiddlewareConstants.true,f){r();return}if(n.members&&n.members.length>0)for(i=0;i<n.members.length;i++)if(e=n.members[i].id,u=n.members[i].tag,e.startsWith(t.WebChatMiddlewareConstants.visitorIdPrefix)&&(t.Util.isNullOrUndefined(u)||u!=="left"))return;r()}function f(r,u,f){return(f.activity.channelData.tags.includes(n.Omnichannel.LiveChatWidget.Constants.AverageWaitTimeMessageTag)&&i.indexOf(f.activity.channelData.clientmessageid)<0&&(t.TelemetryClient.info({Event:n.Omnichannel.LiveChatWidget.TelemetryEvent.AverageWaitTimeMessageRecieved,ActionType:"average wait time message was recieved"},t.ScenarioType.ACTIONS),i.push(f.activity.channelData.clientmessageid)),f.activity.channelData.tags.includes(t.Constants.QueuePositionMessageTag)&&i.indexOf(f.activity.channelData.clientmessageid)<0&&(t.TelemetryClient.info({Event:t.TelemetryEvent.QueuePositionMessageRecieved,ActionType:"queue position message was recieved"},t.ScenarioType.ACTIONS),i.push(f.activity.channelData.clientmessageid)),f.nextVisibleActivity&&f.nextVisibleActivity.channelData&&f.nextVisibleActivity.channelData.clientmessageid&&f.nextVisibleActivity.channelData.clientmessageid===f.activity.channelData.clientmessageid||f.nextVisibleActivity&&f.nextVisibleActivity.messageid&&f.nextVisibleActivity.messageid===f.activity.messageid)?function(){return!1}:function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return React.createElement("div",{key:f.activity.id,className:t.HtmlClassNames.webChatSystemMessage},r.apply(void 0,u).apply(void 0,i))}}var i=[];t.createActivityMiddleware=r})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function i(n,t){var u=n.activity,f=n.attachment,i=Object.assign({},f),e,r;return i.contentType=t.contentType,i.thumbnailUrl=t.thumbnailUrl,e=u.attachments.map(function(n){return n===f?i:n}),r=Object.assign({},u),r.attachments=e,{activity:r,attachment:i}}function r(r,u,f){var e=i(r,{contentType:n.MimeTypes.UnknownFileType,thumbnailUrl:undefined});return React.createElement(t,{iconData:u,imageCard:r,textCard:e,renderer:f})}function o(){return function(){return function(u){return function(){for(var p,s,h=[],c=0;c<arguments.length;c++)h[c]=arguments[c];var e=h[0],a=e.activity.attachments,f=e.attachment;if(!a||!a.length||!f)return u.apply(void 0,h);var v=f||{content:"",contentType:""},o=v.content,y=v.contentType,l=(o||{type:""}).type;if(!l&&o&&n.Constants.supportedAdaptiveCardContentTypes.indexOf(y)>=0)try{o=JSON.parse(o);l=o.type;e.attachment.content=o}catch(d){p="Unable to parse the adaptive card format";n.TelemetryClient.error({Event:n.TelemetryEvent.InvalidAdaptiveCardFormat,ExceptionDetails:{ErrorData:p,Exception:d}})}if(l===n.WebChatMiddlewareConstants.adaptiveCard||n.Constants.supportedAdaptiveCardContentTypes.indexOf(y)>=0)return React.createElement("div",{className:n.WebChatMiddlewareConstants.adaptiveCardAttachmentClassName},u.apply(void 0,h));e.activity.channelData&&e.activity.channelData.middlewareData?f.contentUrl=e.activity.channelData.middlewareData[f.name]:f.tempContentUrl&&(f.contentUrl=f.tempContentUrl);var w=f.name.substring(f.name.lastIndexOf(".")+1,f.name.length)||f.name,g=n.FileAttachmentIconManager.imageRegex.test(f.name),b=null,k=null;return(n.FeaturesManager.shouldEnableInlinePlaying()&&(b=n.FileAttachmentIconManager.audioMediaRegex.test(f.name),k=n.FileAttachmentIconManager.videoMediaRegex.test(f.name)),s=n.FileAttachmentIconManager.getFileAttachmentIconData(w),g)?r(e,s,u):(b||k)&&e.activity.actionType&&e.activity.actionType===n.DIRECT_LINE_INCOMING_ACTIVITY?n.FileAttachmentIconManager.isInlineMediaSupported(f.name)?r(e,s,u):React.createElement(t,{iconData:s,textCard:i(e,{contentType:n.MimeTypes.UnknownFileType,thumbnailUrl:undefined}),renderer:u}):w==="txt"?React.createElement(t,{iconData:s,textCard:i(e,{contentType:n.MimeTypes.UnknownFileType,thumbnailUrl:undefined}),renderer:u}):React.createElement(t,{iconData:s,textCard:e,renderer:u})}}}}var u=function(n,t,i){n&&navigator.msSaveOrOpenBlob&&(navigator.msSaveOrOpenBlob(n,t),i.preventDefault())},t=function(t){var o=t.iconData,i=t.imageCard,r=t.textCard,u=t.renderer;return React.createElement("div",{dir:n.Util.getLocaleDirection(n.Loader.liveChatConfig.chatWidgetLocaleLCID)},i&&u(i),i&&React.createElement("hr",{className:n.HtmlClassNames.webChatAttachmentDivider}),React.createElement(f,{attachment:r.attachment},React.createElement(e,{src:o.icon}),r&&u(r)))},f=function(t){var i=function(n){u(t.attachment.blob,t.attachment.name,n)};return React.createElement("div",{className:n.HtmlClassNames.webChatAttachment,onClick:i},t.children)},e=function(t){var i=t.src;return React.createElement("div",{className:n.HtmlClassNames.webChatAttachmentIcon},i?i:n.FileAttachmentIconManager.getFileAttachmentIconData("txt").icon)};n.createAttachmentMiddleware=o})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function t(){return function(){return function(){return function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];var r=i[0],u=r.activity,f=u.channelData.tags,o=u.from.name,e=r.fromUser;return n.Util.isNullOrUndefined(e)||e||f&&f.includes(n.Constants.SystemMessageTag)?!1:function(){return React.createElement("div",{className:n.HtmlClassNames.webChatAvatar,style:{background:n.Loader.liveChatConfig.chatButtonColor}},React.createElement("p",{className:n.HtmlClassNames.webChatAvatarInitials}," ",n.Utility.getIconText(o)," "))}}}}}n.createAvatarMiddleware=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.applicable=function(t){var i=t.payload.text;return n.Util.isMaskingforCustomer(n.Bootstrapper.lcConfig.maskingInfo)&&i&&t.type===n.WEB_CHAT_SEND_MESSAGE},t.prototype.apply=function(n){var t=this.applyDataMasking(n);return{dispatchAction:null,nextAction:t}},t.prototype.applyDataMasking=function(t){var i=t.payload.text,f,r,e,o,s,h,u,c;if(!n.Bootstrapper.lcConfig||!n.Bootstrapper.lcConfig.maskingInfo||!n.Bootstrapper.lcConfig.maskingInfo.dataMaskingRules)return n.TelemetryClient.error({Event:n.TelemetryEvent.InvalidConfiguration,ExceptionDetails:{ErrorDetails:"Invalid data masking rules"}}),t;for(f=n.Bootstrapper.lcConfig.maskingInfo.dataMaskingRules,r=0,e=Object.keys(f);r<e.length;r++)if(o=e[r],s=f[o],s)try{for(h=new RegExp(s,"gi"),u=void 0;u=h.exec(i);)c=u[0].replace(/./gi,"#"),i=i.replace(u[0],c)}catch(l){n.TelemetryClient.error({Event:n.TelemetryEvent.DataMaskingRuleApplied,ExceptionDetails:{RuleId:o,Exception:l}})}return t.payload.text=i,t},t}();n.DataMaskingMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.DataMaskingMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.DataMaskingMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.MBtoBRatio=1e6}return t.prototype.applicable=function(t){if(t.type===n.DIRECT_LINE_POST_ACTIVITY){var r=t.payload.activity,u=r.attachments,i=r.channelData;return!n.Util.isNullOrUndefined(u)&&!n.Util.isNullOrUndefined(i)&&!n.Util.isNullOrUndefined(i.attachmentSizes)&&u.length===i.attachmentSizes.length}return!1},t.prototype.apply=function(n){var t=this.validateAttachment(n);return{dispatchAction:null,nextAction:t}},t.prototype.validateAttachment=function(t){for(var r=t.payload.activity.attachments,u=t.payload.activity.channelData.attachmentSizes,i=0;i<r.length;i++){var f=this.validateFileExtension(r[i]),e=this.validateFileSize(u[i]),o=parseInt(u[i])==0;f&&e&&!o||(n.NotificationHandler.notifyError(n.NotificationScenarios.AttachmentError,this.buildErrorMessage(r[i].name,f,e,o)),r.splice(i,1),u.splice(i,1),i--)}return t.payload.activity.attachments.length>0?t:{type:"",payload:null}},t.prototype.validateFileExtension=function(t){var i,r,u,f;return n.Loader.liveChatConfig.fileExtensions?(i=t.name.toLowerCase(),r=i.lastIndexOf("."),!r)?!1:(u=i.substring(r),f=n.Loader.liveChatConfig.fileExtensions.toLowerCase().split(","),f.indexOf(u)>-1):!0},t.prototype.validateFileSize=function(t){return n.Loader.liveChatConfig.fileSize&&parseInt(n.Loader.liveChatConfig.fileSize)*this.MBtoBRatio>parseInt(t)},t.prototype.buildErrorMessage=function(t,i,r,u){return!t||!n.Loader.liveChatConfig||!n.Loader.liveChatConfig.fileSize?n.Loader.Locale.BANNER_FILE_NULL_ERROR:i||r?r?i?u?n.Loader.Locale.BANNER_FILE_IS_EMPTY_ERROR:n.Loader.Locale.BANNER_ERROR_MESSAGE:this.getFileExtensionErrorMessage(t):this.getFileSizeErrorMessage():this.getFileSizeAndFileExtensionErrorMessage(t)},t.prototype.getFileSizeAndFileExtensionErrorMessage=function(t){var r=t.lastIndexOf("."),i,u;return r<0?i=n.Loader.Locale.BANNER_FILE_SIZE_WITHOUT_EXTENSION_ERROR:(u=t.substring(r),i=n.Loader.Locale.BANNER_FILE_SIZE_EXTENSION_ERROR,i=i.replace("{1}",u)),i.replace("{0}",n.Loader.liveChatConfig.fileSize)},t.prototype.getFileExtensionErrorMessage=function(t){var i=t.lastIndexOf("."),r;return i<0?n.Loader.Locale.BANNER_FILE_WITHOUT_EXTENSION:(r=t.substring(i),n.Loader.Locale.BANNER_FILE_EXTENSION_ERROR.replace("{0}",r))},t.prototype.getFileSizeErrorMessage=function(){return n.Loader.Locale.BANNER_FILE_SIZE_ERROR.replace("{0}",n.Loader.liveChatConfig.fileSize)},t}();n.AttachmentUploadValidatorMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.AttachmentUploadValidatorMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.AttachmentUploadValidatorMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.applicable=function(t){if(t.type===n.DIRECT_LINE_POST_ACTIVITY){var r=t.payload.activity,u=r.attachments,i=r.channelData;return!n.Util.isNullOrUndefined(u)&&!n.Util.isNullOrUndefined(i)&&!n.Util.isNullOrUndefined(i.attachmentSizes)&&u.length===i.attachmentSizes.length}return!1},t.prototype.apply=function(n){return{dispatchAction:null,nextAction:this.changeAttachmentLink(n)}},t.prototype.changeAttachmentLink=function(t){return t.payload.activity.attachments.forEach(function(t){var r=t.thumbnailUrl,i=t.contentUrl,u=t.contentType;u!==n.Constants.GifContentType||!r||!i||r===i||(t.thumbnailUrl=i)}),t},t}();n.GifUploadMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.GifUploadMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.GifUploadMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.applicable=function(t){return t.type===n.DIRECT_LINE_INCOMING_ACTIVITY&&t.payload&&t.payload.activity&&t.payload.activity.attachments&&t.payload.activity.attachments.length>0},t.disableDownloadButton=function(){t._disableHTMLPlayerDownloadButton(n.WebChatMiddlewareConstants.video);t._disableHTMLPlayerDownloadButton(n.WebChatMiddlewareConstants.audio)},t._disableHTMLPlayerDownloadButton=function(t){setTimeout(function(){for(var u,r=document.getElementsByTagName(t),i=0;i<r.length;i++)r[i].getAttribute(n.WebChatMiddlewareConstants.controlsList)?r[i].getAttribute(n.WebChatMiddlewareConstants.controlsList).indexOf(n.WebChatMiddlewareConstants.nodownload)===-1&&(u=r[i].getAttribute(n.WebChatMiddlewareConstants.controlsList),r[i].setAttribute(n.WebChatMiddlewareConstants.controlsList,u+n.HtmlCssConstants.space+n.WebChatMiddlewareConstants.nodownload)):r[i].setAttribute(n.WebChatMiddlewareConstants.controlsList,n.WebChatMiddlewareConstants.nodownload)},500)},t.prototype.apply=function(n){var i=n;return t.disableDownloadButton(),{dispatchAction:null,nextAction:i}},t.MIDDLEWARE_ID="HTMLPlayer",t}();n.HTMLPlayerMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){!n.StoreFactory.getInstance().isSubscribed(t.MIDDLEWARE_ID)&&n.FeaturesManager.shouldEnableInlinePlaying()&&n.StoreFactory.getInstance().subscribe(t.MIDDLEWARE_ID,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.processANode=function(t){for(var u=t.getElementsByTagName(n.HtmlAttributeNames.aTagName),i,r=0;r<u.length;r++)(i=u[r],i&&i.tagName&&i.tagName.toLowerCase()===n.HtmlAttributeNames.aTagName&&i.href)&&((!i.target||i.target&&i.target!==n.WebChatMiddlewareConstants.blank)&&(i.target=n.WebChatMiddlewareConstants.blank),i.rel?(i.rel&&i.rel.indexOf(n.HtmlAttributeNames.noopenerTag)===-1&&(i.rel=i.rel+n.HtmlCssConstants.space+n.HtmlAttributeNames.noopenerTag),i.rel&&i.rel.indexOf(n.HtmlAttributeNames.noreferrerTag)===-1&&(i.rel=i.rel+n.HtmlCssConstants.space+n.HtmlAttributeNames.noreferrerTag)):i.rel=n.HtmlAttributeNames.noopenerTag+n.HtmlCssConstants.space+n.HtmlAttributeNames.noreferrerTag)},t.prototype.applicable=function(t){var r,f,u,i;if(t&&t.type&&t.type===n.DIRECT_LINE_INCOMING_ACTIVITY){r="";try{return(r=t.payload.activity.text,!r)?!1:(f=this.convertTextToHtmlNode(r),u=f.getElementsByTagName(n.HtmlAttributeNames.aTagName),!!u&&u.length&&u.length>0)}catch(e){i="Failed to validate action.";try{i=i+JSON.stringify(t)}catch(e){i+" (unable to stringify action)"}console.error(i);n.TelemetryClient.error({Event:n.TelemetryEvent.ProcessingHTMLTextMiddlewareFailed,ExceptionDetails:{ErrorData:i,Exception:e}})}}return!1},t.prototype.apply=function(t){var u=t,f,r,i;try{f=t.payload.activity.text;r=this.convertTextToHtmlNode(f);r&&(this.processANode(r),u=window.simpleUpdateIn(t,[n.WebChatMiddlewareConstants.payload,n.WebChatMiddlewareConstants.activity,n.WebChatMiddlewareConstants.text],function(){return r.innerHTML}))}catch(e){i="Failed to apply action: ";try{i=i+JSON.stringify(t)}catch(e){i+" (unable to stringify action)"}console.error(i);n.TelemetryClient.error({Event:n.TelemetryEvent.ProcessingHTMLTextMiddlewareFailed,ExceptionDetails:{ErrorData:i,Exception:e}})}finally{return{dispatchAction:null,nextAction:u}}},t.prototype.convertTextToHtmlNode=function(t){var i,r;if(!t)return"";i=document.createElement(n.HtmlAttributeNames.div);try{t=window.DOMPurify.sanitize(t);i.innerHTML=t}catch(u){r="Failed to purify and set innertHTML with text: "+t;console.error(r);n.TelemetryClient.error({Event:n.TelemetryEvent.ProcessingHTMLTextMiddlewareFailed,ExceptionDetails:{ErrorData:r,Exception:u}})}return i},t}();n.HTMLTextMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.HTMLTextMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.HTMLTextMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.applicable=function(t){return t.type===n.WEB_CHAT_SEND_MESSAGE&&t.payload&&t.payload.text},t.prototype.apply=function(n){var t=this.applySanitization(n);return{dispatchAction:null,nextAction:t}},t.prototype.applySanitization=function(t){var u=t,r,f,i;try{r=window.DOMPurify.sanitize(t.payload.text);r||(r=" ");u=window.simpleUpdateIn(t,[n.WebChatMiddlewareConstants.payload,n.WebChatMiddlewareConstants.text],function(){return r})}catch(e){f=__assign({},t,{payload:__assign({},t.payload,{text:undefined})});i="Failed to apply action: ";try{i=i+JSON.stringify(f)}catch(e){i+" (unable to stringify action)"}console.error(i);n.TelemetryClient.error({Event:n.TelemetryEvent.ProcessingSanitizationMiddlewareFailed,ExceptionDetails:{ErrorData:i,Exception:e}})}finally{return u}},t}();n.SanitizationMiddleware=t,function(){window.addEventListener("StoreFactoryReady",function(){n.StoreFactory.getInstance().isSubscribed(n.Constants.SanitizationMiddlewareId)||n.StoreFactory.getInstance().subscribe(n.Constants.SanitizationMiddlewareId,new t)})}()})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function t(){return function(){return function(){return function(t){var u=t.activeTyping,o=t.visible,f,s,e;if(!u||n.Loader.liveChatConfig.liveChatVersionNumber===n.Constants.LiveChatV1&&!o)return null;for(u=Object.keys(u).map(function(n){return u[n]}),f=0;f<u.length;f++)u[f].role&&u[f].role===n.DirectLineSenderRole.User&&(n.Loader.liveChatConfig.liveChatVersionNumber!=n.Constants.LiveChatV2||o||r().then(function(){return null}),u.splice(f,1),f--);return s=i(u),e=n.Loader.liveChatConfig.chatButtonColor,u&&u.length!==0&&React.createElement("div",{className:n.HtmlClassNames.webChatTypingIndicator},React.createElement("div",{className:n.HtmlClassNames.webChatTypingIndicatorBubble,style:{background:e}}),React.createElement("div",{className:n.HtmlClassNames.webChatTypingIndicatorBubble,style:{background:e}}),React.createElement("div",{className:n.HtmlClassNames.webChatTypingIndicatorBubble,style:{background:e}}),React.createElement("div",null," ",s," "))}}}}function i(t){if(t&&t.length!==0){if(t.length===1)return n.Loader.Locale.TYPING_INDICATOR_ONE.replace("{0}",t[0].name);if(t.length===2){var i=t[0].name,r=t[1].name;return n.Loader.Locale.TYPING_INDICATOR_TWO.replace("{0}",i).replace("{1}",r)}return n.Loader.Locale.TYPING_INDICATOR_MULTIPLE.replace("{0}",t.length)}return""}function r(){var t=this;return new Promise(function(i){return __awaiter(t,void 0,void 0,function(){var t,r,u,f;return __generator(this,function(){t=n.Util.timer();r=function(){n.TelemetryClient.info({ElapsedTimeInMilliseconds:t.milliSecondsElapsed,Event:n.TelemetryEvent.SendTypingIndicatorSucceeded});i()};u=function(r){n.TelemetryClient.error({ElapsedTimeInMilliseconds:t.milliSecondsElapsed,Event:n.TelemetryEvent.SendTypingIndicatorFailed,ExceptionDetails:r});i()};try{return f={customerDisplayName:n.Constants.CustomerDisplayName},[2,n.OmnichannelProxy.getInstance().sendTypingIndicator(n.Loader.currentConversation.currentRequestId,n.Loader.liveChatConfig.liveChatVersionNumber,f).then(r,u)]}catch(e){n.TelemetryClient.error({ElapsedTimeInMilliseconds:t.milliSecondsElapsed,Event:n.TelemetryEvent.SendTypingIndicatorFailed,ExceptionDetails:{ErrorDescription:"Failed to send typing indicator",Error:e}})}return[2]})})})}n.createTypingIndicatorMiddleware=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.Connection="connection",n.DownloadTranscriptError="download transcript",n.EmailTranscriptError="email transcript",n.AttachmentError="attachment",n.InternetConnection="internet connection",n.MaxSizeError="max size",n}();n.NotificationScenarios=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.notify=function(i,r,u){n.Loader.store&&n.Loader.store.dispatch({type:n.WEB_CHAT_SET_NOTIFICATION,payload:{id:i,level:r,message:u}});t.setFocusOnNotificationCloseButton()},t.dismissNotification=function(t){n.Loader.store&&n.Loader.store.dispatch({type:n.WEB_CHAT_DISMISS_NOTIFICATION,payload:{id:t}})},t.notifyError=function(t,i){this.notify(t,n.NotificationLevel.Error,i)},t.notifyWarning=function(t,i){this.notify(t,n.NotificationLevel.Warning,i)},t.notifyInfo=function(t,i){this.notify(t,n.NotificationLevel.Info,i)},t.notifySuccess=function(t,i){this.notify(t,n.NotificationLevel.Success,i)},t.notifyWithLevel=function(n,t,i){i?this.notify(n,i,t):this.notifyInfo(n,t)},t.setFocusOnNotificationCloseButton=function(){var r=document.querySelector("#"+n.HtmlIdNames.MSLiveChatWidget+" ."+n.HtmlClassNames.webChatBannerExpandButton),i;if(r){r.focus();return}if(i=document.querySelector("#"+n.HtmlIdNames.MSLiveChatWidget+" ."+n.HtmlClassNames.webChatBannerCloseButton),i){i.focus();t.registerOnCloseEvent(i);return}},t.registerOnCloseEvent=function(t){t.onclick=function(){n.WebChatControlsUtils.setFocus()}},t}();n.NotificationHandler=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){this.addListeners(window);this.addListenersForParent()},i.prototype.componentWillUnmount=function(){this.removeListeners(window)},i.prototype.addListenersForParent=function(){window.addEventListener("message",function(t){if(t.data)try{var i=t.data,r=i.messageName;switch(r){case n.HtmlEventNames.handleControlSlash:n.WebChatControlsUtils.setFocus()}}catch(u){console.error(u)}})},i.prototype.addListeners=function(t){t&&t.addEventListener&&t.addEventListener(n.HtmlEventNames.keydown,this.handleKeydown)},i.prototype.removeListeners=function(t){t&&t.addEventListener&&t.removeEventListener(n.HtmlEventNames.keydown,this.handleKeydown)},i.prototype.handleKeydown=function(t){t.ctrlKey&&t.keyCode===n.Constants.KeyCodes.KEY_SLASH&&n.WebChatControlsUtils.setFocus()},i.prototype.render=function(){return null},i}(React.Component);n.WebChatEventListener=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getSendBox=function(){return document.querySelector(t.getSendBoxSelector())},t.setFocus=function(){var n=t.getSendBox();n&&n.offsetParent&&n.focus()},t.getSendButton=function(){return $j(t.getSendButtonSelector())[0]},t.isMaxCharacterLimitExceed=function(){return n.WebChatSendBoxUtils.getSendBoxText().length>n.ConfigurationManager.MaxCharactersLimit},t.addEventHandler=function(n,t,i,r){var u=i?$j(i):$j(document);u.on(n,r,function(n){t(n.originalEvent)})},t.getSendBoxSelector=function(){return'textarea[data-id="webchat-sendbox-input"]'},t.getSendButtonSelector=function(){return"#"+n.HtmlIdNames.webChatRootDiv+" form ~ div button"},t}();n.WebChatControlsUtils=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getSendBoxText=function(){var t=n.WebChatControlsUtils.getSendBox();if(t&&t.offsetParent)return t.value},t}();n.WebChatSendBoxUtils=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){function t(){return function(t){var u=t.data,f=t.dimensions,e=t.duration,o=t.error,s=t.fatal,i=t.level,h=t.Event,c=t.type,r=i?i.toUpperCase():"";switch(r){case n.LogLevel.DEBUG:n.TelemetryClient.debug(t,n.ScenarioType.WEBCHAT);break;case n.LogLevel.WARN:n.TelemetryClient.warn(t,n.ScenarioType.WEBCHAT);break;case n.LogLevel.ERROR:n.TelemetryClient.error(t,n.ScenarioType.WEBCHAT);break;case n.LogLevel.INFO:default:n.TelemetryClient.info(t,n.ScenarioType.WEBCHAT)}}}n.createWebChatTelemetry=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n.Active="Active";n.Open="Open";n.WrapUp="WrapUp";n.Closed="Closed"})(t=n.LiveWorkItemState||(n.LiveWorkItemState={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n.Success="success";n.Info="info";n.Warning="warn";n.Error="error"})(t=n.NotificationLevel||(n.NotificationLevel={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n[n.READ=0]="READ";n[n.WRITE=1]="WRITE"})(t=n.FilePermission||(n.FilePermission={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.middlewares={}}return t.prototype.setWebChat=function(n){this.webChat=n;this.ready()},t.prototype.ready=function(){var n=new Event("StoreFactoryReady");window.dispatchEvent(n)},t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.isSubscribed=function(n){return n in this.middlewares},t.prototype.subscribe=function(n,t){this.middlewares[n]=t},t.prototype.createWebChatStore=function(){var t=this;if(!this.webChat)throw new TypeError("WebChat is NOT configured!");return this.webChat.createStore({},function(i){var r=i.dispatch;return function(i){return function(u){var e,o,s,h,l,c,f;if(u.type===n.DIRECT_LINE_POST_ACTIVITY&&(e=u.payload.activity,e.from&&e.from.role!==n.Constants.UserMessageTag||(u=__assign({},u,{payload:__assign({},u.payload,{activity:__assign({},u.payload.activity,{textFormat:n.Constants.Markdown})})}))),u.type===n.DIRECT_LINE_INCOMING_ACTIVITY&&(e=u.payload.activity,e&&(u.payload.activity[n.Constants.ActionType]=n.DIRECT_LINE_INCOMING_ACTIVITY)),o=u,u&&u.payload)for(s=0,h=Object.keys(t.middlewares);s<h.length;s++)l=h[s],c=t.middlewares[l],c.applicable(o)&&(f=c.apply(o),f&&(f.dispatchAction&&r(f.dispatchAction),f.nextAction&&(o=f.nextAction)));return i(o)}}})},t}();n.StoreFactory=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){n.DeliveredTimestamp=function(t){var o=t.next,r=t.args,u=t.dir,f=t.role,s=t.name,h=t.sameTimestampGroupTemp,e=n.Loader.react,c=e.useRef,l=e.useEffect,i=c(),a=r.activity.timestamp;return l(function(){i.current[n.WebChatMiddlewareConstants.childNodes][1].innerText=n.Utility.getTimestampHourMinute(a)},[i]),React.createElement("div",{className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestampContent,dir:u},f===n.DirectLineSenderRole.Bot&&React.createElement(React.Fragment,null,React.createElement("span",{"aria-hidden":"false"},s),React.createElement("span",null," - ")),React.createElement("span",{ref:i,dir:u}," ",o(__assign({},r,{sameTimestampGroup:h}))),f===n.DirectLineSenderRole.User&&React.createElement(React.Fragment,null,React.createElement("span",{className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestampContent}," - "),React.createElement("span",{"aria-hidden":"false"},n.Loader.Locale.MESSAGE_DELIVERED)))}})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){n.SendingTimestamp=function(t){var r=t.args,f=t.next,e=t.dir,u=n.Loader.react,o=u.useRef,s=u.useEffect,i=o(),h=r.activity.timestamp;return s(function(){i.current[n.WebChatMiddlewareConstants.childNodes][1].innerText=n.Utility.getTimestampHourMinute(h)},[i]),React.createElement("div",{className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestampContent},React.createElement("span",{ref:i}," ",f(__assign({},r,{sendState:n.SendStatus.Sent,sameTimestampGroup:!1}))),React.createElement("span",{dir:e},React.createElement("span",null,"  "," - "," "),React.createElement("span",null,"  ",n.Loader.Locale.MESSAGE_SENT," ")))}})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var c=function(){function n(){}return n.popOutWindowClassName="pop-out",n.inAppClassName="inApp",n.chatRootReactClassName="chat-root-react",n.webChat="web-chat",n.webChatPlaceholder="web-chat-placeholder",n.webChatDimLayer="web-chat-dim-layer",n.pageContainer="oclcw-page-container",n.errorText="oclcw-error-text",n.pushButton="button.ac-pushButton",n.submitButton="ac-pushButton",n.errorContainer="oclcw-error-container",n.webChatSystemMessage="oclcw-web-chat-system-message",n.webChatAttachment="oclcw-web-chat-attachment",n.webChatAttachmentIcon="oclcw-web-chat-attachment-icon",n.webChatAttachmentDivider="oclcw-web-chat-attachment-divider",n.ocAutofill="oc-autofill",n.ocAutofillFrame="oc_autofill_iframe",n.actionBar="oclcw-actionBar",n.actionBarActive="oclcw-actionBar-active",n.actionBarInactive="oclcw-actionBar-inactive",n.actionBarIconContainer="icon-container",n.actionBarIconButton="icon-button",n.actionBarIconImage="icon-image",n.actionBarIconsContainer="oclcw-actionBar-icons-container",n.emailTranscriptDialogContainer="oclcw-emailTranscriptDialog-container",n.emailTranscriptDialog="oclcw-emailTranscript-dialog",n.emailTranscriptDialogContentContainer="oclcw-emailTranscriptDialog-contentContainer",n.emailTranscriptDialogTitle="oclcw-emailTranscriptDialog-title",n.emailTranscriptDialogTextContent="oclcw-emailTranscriptDialog-textContent",n.emailTranscriptDialogTextFieldContainer="oclcw-emailTranscriptDialog-textField-container",n.emailTranscriptDialogTextField="oclcw-emailTranscriptDialog-textField",n.emailTranscriptDialogInvalidEmail="oclcw-invalidEmail",n.emailTranscriptDialogButtons="oclcw-emailTranscriptDialog-buttons",n.emailTranscriptDialogActionButtonSend="oclcw-emailTranscriptDialog-actionButton_send",n.emailTranscriptDialogActionButtonCancel="oclcw-emailTranscriptDialog-actionButton_cancel",n.chat="chat-button",n.notificationIcon="notification-icon",n.loadingScreen="loading-screen",n.loadingMessage="loading-message",n.chatButton="oclcw-chatbutton",n.oclcwt1="oclcw-t1",n.oclcwt2="oclcw-t2",n.chatIconTitle="oclcw-chatbutton-title",n.chatIcon="oclcw-chaticon",n.chatIconContainer="oclcw-chaticon-container",n.unreadMessagesNotificationBubble="oclcw-unread-messages-notification-bubble",n.unreadMessagesNotificationBubbleTruncated="oclcw-unread-messages-notification-bubble-truncated",n.webChatHeader="web-chat-header",n.headerActive="header-active",n.headerInactive="header-inactive",n.webChatHeaderIcon="web-chat-header-icon",n.webChatHeaderTitle="web-chat-header-title",n.webChatImageFile="web-chat-image-file",n.webChatHeaderButtonGroup="web-chat-header-button-group",n.webChatHeaderMinimizeButton="web-chat-header-minimizebutton",n.webChatHeaderMinimizeButtonWithCustomCloseButton="web-chat-header-minimizebuttonwithcustomclosebutton",n.webChatHeaderCloseButton="web-chat-header-closebutton",n.webChatHeaderCustomCloseButton="web-chat-header-customclosebutton",n.webChatCloseConversationConfirm="web-chat-close-conversation-confirm",n.webChatCloseConversationContentContainer="web-chat-close-conversation-content-container",n.webChatCloseConversationConfirmTitle="web-chat-close-conversation-confirm-title",n.webChatCloseConversationConfirmSubtitle="web-chat-close-conversation-confirm-subtitle",n.webChatCloseConversationConfirmButtonContainer="web-chat-close-conversation-confirm-button-container",n.webChatCloseConversationConfirmButtonConfirm="web-chat-close-conversation-confirm-button-confirm",n.webChatCloseConversationConfirmButtonCancel="web-chat-close-conversation-confirm-button-cancel",n.webChatHeaderButtonTitle="web-chat-header-button-title",n.callContainer="call-container",n.incomingCallPopup="incoming-call-popup",n.incomingCallButtonGroup="incoming-call-button-group",n.callRejectButton="call-reject-button",n.callAcceptButton="call-accept-button",n.toggleAudio="microphone-button",n.videoCallAcceptButton="video-call-accept-button",n.videoOn="video-call-on-button",n.videoOff="video-call-off-button",n.voiceOn="voice-call-on-button",n.voiceOff="voice-call-off-button",n.incomingCallMessage="incoming-call-message",n.callingContainer="calling-container",n.redBox="redbox",n.redCircle="redcircle",n.greenCircle="greencircle",n.noMargin="no-margin ",n.assertive="assertive",n.off="off",n.voiceVideoTooltip="voice-video-tooltip",n.incomingProactiveChatPageContainer="oclcw-incomingproactivechat-page-container",n.ipcpClose="oclcw-ipcp-close",n.ipcpWelcomMessageText="oclcw-ipcp-welcomemessage-text",n.ipcpAcceptButton="oclcw-ipcp-accept-button",n.ipcpAcceptButtonText="oclcw-ipcp-accept-button-text",n.ipcpBanner="oclcw-ipcp-banner",n.ipcpBannerText="oclcw-ipcp-banner-text",n.ipcpBannerTextRow1="oclcw-ipcp-banner-text-row-1",n.ipcpBannerTextRow2="oclcw-ipcp-banner-text-row-2",n.pageContainerWelcomePage="oclcw-page-container welcome-page",n.wpWelcomePage="oclcw-welcome-page",n.wpContainer="oclcw-wp-container",n.wpSubContainer="oclcw-wp-sub-container",n.wpLogo="oclcw-wp-logo",n.wpLogoInset="oclcw-wp-logo-inset",n.wpLogoWelcomeText="oclcw-wp-logo-welcome-text",n.wpMessage="oclcw-wp-msg",n.wpt1="t1",n.wpt2="t2",n.wpt3="t3",n.wpLogoAlertText="oclcw-wp-logo-alert-text",n.wpAlertMessage="oclcw-wp-alert-msg",n.wpLoading="oclcw-wp-loading",n.pageContainerPostchatLoadPage="oclcw-page-container postchat-load-page",n.pclPage="oclcw-postchat-load-page",n.pclContainer="oclcw-pcl-container",n.pclSubContainer="oclcw-pcl-sub-container",n.pclLogoText="oclcw-pcl-logo-survey-text",n.pclMessage="oclcw-pcl-msg",n.pcl1="t1",n.postChatPage="oclcw-postchat-page",n.cardContainer="oclcw-card-container",n.ppContainer="oclcw-pp-container",n.ppPostchatMainContainer="oclcw-pp-postchat-main-container",n.ppPostchatContainer="oclcw-pp-postchatcontainer",n.preChatPage="oclcw-prechat-page",n.chatReconnectPage="oclcw-prechat-page",n.ppPrechatMainContainer="oclcw-pp-prechat-main-container",n.ppPrechatContainer="oclcw-pp-prechatcontainer oclcw-card-container card adaptive",n.preChatDropdown="ac-input ac-multichoiceInput",n.acMultichoiceInput="ac-multichoiceInput",n.acContainer="ac-container",n.acActionSet="ac-actionSet",n.operatingHourPageContainerContainer="oclcw-page-container operatinghour-page",n.operatingHourPage="oclcw-operatinghour-page",n.ohContainer="oclcw-oh-container",n.ohLogoAlertText="oclcw-oh-logo-alert-text",n.ohAlertMessage="oclcw-oh-alert-msg",n.ohTitle="t1",n.ohSubtitle="t2",n.oclcwWebChatActivityStatusTimestamp="oclcw-web-chat-activityStatus-timestamp",n.oclcwWebChatActivityStatusTimestampContent="oclcw-web-chat-activityStatus-timestampContent",n.oclcwWebChatActivityStatusTimestampFailed="oclcw-web-chat-activityStatus-timestampFailed",n.oclcwWebChatActivityStatusTimestampRetry="oclcw-web-chat-activityStatus-timestampRetry",n.content="content",n.webChatBubbleContent="webchat__bubble__content",n.webChatTypingIndicator="webchat__typingIndicator",n.webChatTypingIndicatorBubble="bubble",n.webChatAvatar="webchat__avatar",n.webChatAvatarInitials="webchat__avatar_initials",n.webChatBannerCloseButton="webchat__toast__dismissButton",n.webChatBannerExpandButton="webchat__toaster__expandIcon",n.webChatToasterListItem="webchat__toaster__listItem",n.webChatDismissButton="webchat__toast__dismissButton",n.toolTipBaseClass="toolTipBase",n.toolTipShowClass="toolTipShow",n.toolTipBottomClass="bottom",n}(),t,i,r,u,f,e,o,s,h;n.HtmlClassNames=c;t=function(){function n(){}return n.MSLiveChatWidget="MSLiveChatWidget",n.chatPlaceHolder="chatPlaceHolder",n.chatPlaceholderWrapper="chatPlaceholderWrapper",n.surveyPlaceholderId="oclcw-survey-placeholder",n.chatRootReactId="chatRootReact",n.webChatRoot="web-chat-root",n.webChatRootDiv="web-chat-root-div",n.chat="chat",n.chatDimLayer="chatDimLayer",n.errorElementId="surveyFieldError",n.actionBar="oclcw-actionBar",n.actionBarIconsContainer="oclcw-actionBarIconsContainer",n.emailTranscriptDialogContainer="oclcw-emailTranscriptDialogContainer",n.emailTranscriptDialogTextField="oclcw-emailTranscriptDialogTextField",n.emailTranscriptButton="oclcw-actionBar-EmailTranscript-button",n.downloadTranscriptButton="oclcw-actionBar-DownloadTranscript-button",n.audioNotificationButton="oclcw-actionBar-AudioNotification-button",n.chatButtonContainer="oclw-chat",n.chatButton="oclcw-chatButton",n.notificationIcon="notificationIcon",n.loadingScreen="loadingScreen",n.webChatHeader="webChatHeader",n.webChatHeaderTitle="webChatHeaderTitle",n.webChatHeaderCloseButton="webChatHeaderCloseButton",n.webChatHeaderCustomCloseButton="webChatHeaderCustomCloseButton",n.webChatHeaderWelcomeCloseButton="webChatHeaderWelcomeCloseButton",n.webChatHeaderMinimizeButton="webChatHeaderMinimizeButton",n.webChatCloseConversationConfirm="webChatCloseConversationConfirm",n.webChatCloseConversationConfirmButtonConfirm="webChatCloseConversationConfirmButtonConfirm",n.incomingCallPopup="incomingCallPopup",n.callRejectButton="callRejectButton",n.callAcceptButton="callAcceptButton",n.videoCallAcceptButton="videoCallAcceptButton",n.incomingCallMessage="incomingCallMessage",n.microphoneButton="microphoneButton",n.toggleVideo="toggleVideo",n.toggleAudio="toggleAudio",n.callingContainer="calling-container",n.callContainer="call-container",n.currentCallBody="currentCall-body",n.remoteVideo="remoteVideo",n.selfVideo="selfVideo",n.currentCallActions="currentCall-actionicons",n.currentCallFooter="currentCall-footer",n.endedCall="endedcall",n.incomingProactiveChat="oclw-incomingproactivechat",n.ipcpIncomingProactiveChatAcceptButton="oclcw-ipcp-incomingproactivechat-accept-button",n.wpWelcomeText="oclcw-wp-welcome-text",n.wpLoadingText="oclcw-wp-loadingtext",n.wpAlertText="oclcw-wp-alert-text",n.pclText="oclcw-pcl-text",n.pclLoadingText="oclcw-pcl-loadingtext",n.pclText1Id="oclcw-pcl-text1",n.pclText2Id="oclcw-pcl-text2",n.ohAlertText="oclcw-wp-alert-text",n.MicrosoftOmnichannelLCWidgetChatIframePageId="Microsoft_Omnichannel_LCWidget_Chat_Iframe_Window",n.reconnectButtonValue="Reconnect",n.newChatButtonValue="NewChat",n.postChatEmbedModeContainer="oclcwPostChatEmbedModeContainer",n.MicrosoftOmnichannelAMSClientIframeId="Microsoft_Omnichannel_AMSClient_Iframe_Window",n}();n.HtmlIdNames=t;i=function(){function n(){}return n.resizeMSLcwIframe="resizeMSLcwIframe",n.repositionMSLcwIframe="repositionMSLcwIframe",n.webChatPanel="web_chat_panel",n.proactiveChatPanel="proactive_chat_panel",n.startChatButton="start_chat_button",n.minimizeIframe="minimize_iframe",n.defaultClassName="web_chat_panel",n}();n.IFrameValues=i;r=function(){function n(){}return n.bottomLeft="BottomLeft",n.bottomRight="BottomRight",n}();n.WidgetPosition=r;u=function(){function n(){}return n.role="role",n.navigation="navigation",n.ariaLabel="aria-label",n.ariaLive="aria-live",n.ariaDisabled="aria-disabled",n.form="form",n.ariaLabelledby="aria-labelledby",n.tabindex="tabindex",n.ariaRequired="aria-required",n.ariaDesribedby="aria-describedby",n.disabled="disabled",n.hidden="hidden",n.prechatContainer="oclcw-pp-prechatcontainer",n.download="download",n.href="href",n.false="false",n.true="true",n.region="region",n.button="button",n.input="Input",n.style="style",n.head="head",n.type="type",n.csstext="text/css",n.listItem="LI",n.unorderedList="UL",n.div="div",n.aTagName="a",n.noopenerTag="noopener",n.noreferrerTag="noreferrer",n.inputToggle="Input.Toggle",n}();n.HtmlAttributeNames=u;f=function(){function n(){}return n.keydown="keydown",n.click="click",n.keyup="keyup",n.keypress="keypress",n.unload="unload",n.handleControlSlash="handleControlSlash",n.mouseenter="mouseenter",n.mouseleave="mouseleave",n.focus="focus",n.blur="blur",n}();n.HtmlEventNames=f;e=function(){function n(){}return n.adaptiveCardFont="Segoe UI, Helvetica Neue, sans-serif",n.invalidEmailBorder="1px solid ",n.webChatMarginBottomWithActionBar="calc(100% - 88px)",n.webChatMarginBottomWithoutActionBar="calc(100% - 68px)",n.webChatUserBubbleDefaultColor="White",n.webChatUserBubbleFailedColor="#FAEDEC",n.height="height",n.webChatHeightWhenVoiceOrIncoming="height: calc(100% - 110px)",n.webChatHeightWhenVideoCall="height: calc(100% - 290px)",n.webChatHeightWhenNoCallingPopup="height: calc(100% - 50px)",n.space=" ",n.voiceCallOrIncomingPopup="voiceCallOrIncomingPopup",n.videoCallDialog="videoCallDialog",n.noCallDialog="noCallDialog",n.activeActionBarHeight=30,n.fifteenPx="15px",n.absolute="absolute",n.display="display",n}();n.HtmlCssConstants=e;o=function(){function n(){}return n.show="show",n.hide="hide",n.minimize="minimize",n.maximize="maximize",n.withVideo="withVideo",n.withoutVideo="withoutVideo",n.column="column",n}();n.HtmlCallingCssConstants=o;s=function(){function n(){}return n.activity="activity",n.payload="payload",n.text="text",n.nextVisibleActivity="nextVisibleActivity",n.timeBetweenTimestampGroups=3e5,n.closest="closest",n.childNodes="childNodes",n.receivedMessageClassName="ms_lcw_webchat_received_message",n.adaptiveCardAttachmentClassName="ms_lcw_webchat_adaptive_card",n.message="message",n.user="user",n.adaptiveCard="AdaptiveCard",n.visitorIdPrefix="8:",n.blank="_blank",n.true="true",n.webchatChannelId="webchat",n.video="video",n.audio="audio",n.controlsList="controlsList",n.nodownload="nodownload",n}();n.WebChatMiddlewareConstants=s;h=function(){function n(){}return n.asterisk="&#42;",n}();n.HtmlEscapeCharacters=h})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=this;n.NotDeliveredTimestamp=function(i){var o=i.args,p=i.next,s=i.dir,u=n.Loader.react,w=u.useCallback,h=u.useRef,c=u.useEffect,l=n.Loader.webChat.hooks,b=l.usePostActivity,k=l.useFocusSendBox,f=h(),e=h(),a=k(),v=b(),r=o[n.WebChatMiddlewareConstants.activity],d=r.timestamp;c(function(){e.current[n.WebChatMiddlewareConstants.childNodes][1].innerText=n.Utility.getTimestampHourMinute(d)},[e]);var y=w(function(n){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return nt(n),r.previousClientActivityID=r.channelData.clientActivityID,[4,v(r)];case 1:return t.sent(),a(),[2]}})})},[r,a,v]),g=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ENTER&&(t.preventDefault(),y(t))},nt=function(t){for(var i=t.target.parentElement;i.tagName!=n.HtmlAttributeNames.listItem;)if(i=i.parentElement,i.tagName==n.HtmlAttributeNames.unorderedList)return;i.parentNode.removeChild(i)};return c(function(){n.Utility.setBubbleColorFromTimestamp(f.current[n.WebChatMiddlewareConstants.closest]("."+n.HtmlClassNames.content),n.HtmlCssConstants.webChatUserBubbleFailedColor)},[f]),React.createElement("div",{ref:f,className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestampContent},React.createElement("span",{ref:e}," ",p(__assign({},o,{sendState:n.SendStatus.Sent,sameTimestampGroup:!1}))),React.createElement("span",{dir:s},React.createElement("span",null,"  "," - "," "),React.createElement("span",{className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestampFailed},"  ",n.Loader.Locale.MESSAGE_NOT_DELIVERED," ")),React.createElement("span",{dir:s},React.createElement("span",null,"  "," - "," "),React.createElement("span",{className:n.HtmlClassNames.oclcwWebChatActivityStatusTimestampRetry,onClick:y,onKeyDown:g,tabIndex:0},"  ",n.Loader.Locale.MESSAGE_RETRY," ")))}})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.componentDidMount=function(){this.props.welcomePageDisplayStyle.minimizeButtonVisibility?n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderMinimizeButton):this.props.welcomePageDisplayStyle.closeButtonVisibility&&n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderWelcomeCloseButton);n.FrameHandler.setToDefaultSize(window)},i.prototype.componentDidUpdate=function(t){this.props.welcomePageDisplayStyle.closeButtonVisibility!==t.welcomePageDisplayStyle.closeButtonVisibility&&n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderWelcomeCloseButton)},i.prototype.render=function(){var t=this.props.liveChatConfig.chatButtonIconUrl?this.props.liveChatConfig.chatButtonIconUrl:"",i=this.props.liveChatConfig.chatButtonIconUrl?"":n.HtmlClassNames.webChatImageFile;return React.createElement("div",{className:n.HtmlClassNames.pageContainerWelcomePage,role:n.HtmlAttributeNames.region,"aria-label":n.Loader.Locale.WELCOME_SCREEN_LANDMARK,onKeyDown:this.onEscapeKeyDown.bind(this)},React.createElement("div",{className:n.HtmlClassNames.wpWelcomePage,style:{backgroundColor:n.Loader.liveChatConfig.chatTitleColor},"aria-labelledby":n.HtmlIdNames.wpWelcomeText+" "+n.HtmlIdNames.wpLoadingText,"aria-live":n.HtmlClassNames.assertive},React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.props.onMinimize.bind(this),onClose:this.props.onClose.bind(this),showIconAndTitle:!1,showMinimizeButton:this.props.welcomePageDisplayStyle.minimizeButtonVisibility,showCloseButton:this.props.welcomePageDisplayStyle.closeButtonVisibility,customCloseButtonId:n.HtmlIdNames.webChatHeaderWelcomeCloseButton}),React.createElement("div",{className:n.HtmlClassNames.wpContainer},React.createElement("div",{className:n.HtmlClassNames.wpSubContainer},React.createElement("div",{className:n.HtmlClassNames.wpLogo},React.createElement("div",{className:n.HtmlClassNames.wpLogoInset+" "+i},React.createElement("img",{src:t}))),React.createElement("div",{id:n.HtmlIdNames.wpWelcomeText,className:n.HtmlClassNames.wpLogoWelcomeText,style:{display:this.props.welcomePageDisplayStyle.welcomeTextComponentVisibility?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},React.createElement("span",{className:n.HtmlClassNames.wpMessage+" "+n.HtmlClassNames.wpt1},n.Loader.Locale.WELCOME_SCREEN_WELCOME_TO_TEXT+" "),React.createElement("span",{className:n.HtmlClassNames.wpMessage+" "+n.HtmlClassNames.wpt2},n.Loader.Locale.WELCOME_SCREEN_LIVE_CHAT_SUPPORT_TEXT)),React.createElement("div",{id:n.HtmlIdNames.wpAlertText,className:n.HtmlClassNames.wpLogoAlertText,style:{display:this.props.welcomePageDisplayStyle.alertTextComponentVisibility?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},React.createElement("span",{className:n.HtmlClassNames.wpAlertMessage+" "+n.HtmlClassNames.wpt1},this.props.welcomePageDisplayStyle.alertHeaderText),React.createElement("span",{className:n.HtmlClassNames.wpAlertMessage+" "+n.HtmlClassNames.wpt2},this.props.welcomePageDisplayStyle.alertSubheaderText))),React.createElement("div",{className:n.HtmlClassNames.wpLoading,style:{display:this.props.welcomePageDisplayStyle.loadingComponentVisibility?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},React.createElement("img",{alt:n.Loader.Locale.WELCOME_SCREEN_ICON_ALT,src:n.ScriptPaths.LoadingImagePath}),React.createElement("span",{id:n.HtmlIdNames.wpLoadingText,className:n.HtmlClassNames.wpMessage+" "+n.HtmlClassNames.wpt3},n.Loader.Locale.WELCOME_SCREEN_LOADING_TEXT)))))},i.prototype.onMinimizeKeyDown=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.props.onMinimize()},i.prototype.onCloseKeyDown=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.props.onClose()},i.prototype.onEscapeKeyDown=function(t){t.keyCode!==n.Constants.KeyCodes.KEY_ESC||n.Bootstrapper.isPopOutMode||this.props.onMinimize()},i}(React.Component);n.WelcomePage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n.User="user";n.Bot="bot";n.Channel="channel"})(t=n.DirectLineSenderRole||(n.DirectLineSenderRole={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n.Sending="sending";n.SendFailed="send failed";n.Sent="sent"})(t=n.SendStatus||(n.SendStatus={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){n.Utility.focusOnElement(n.HtmlIdNames.ipcpIncomingProactiveChatAcceptButton);var t=document.getElementById(n.HtmlIdNames.incomingProactiveChat);t?n.FrameHandler.resizeFrame(window,n.IFrameValues.proactiveChatPanel):console.error("Failed to find element: ",n.HtmlIdNames.incomingProactiveChat)},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.incomingProactiveChat,className:n.HtmlClassNames.incomingProactiveChatPageContainer,role:n.HtmlAttributeNames.region,"aria-label":this.props.locale.WELCOME_SCREEN_LANDMARK,onKeyDown:this.onEscapeKeyDown.bind(this)},React.createElement("div",{className:n.HtmlClassNames.ipcpBanner,"aria-label":this.props.locale.PROACTIVE_CHAT_BANNER_WELCOME_TO_TEXT+this.props.locale.PROACTIVE_CHAT_BANNER_LIVE_CHAT_SUPPORT_TEXT,style:{backgroundColor:this.props.liveChatConfig.chatTitleColor}},React.createElement("span",{role:n.HtmlAttributeNames.button,tabIndex:0,className:n.HtmlClassNames.ipcpClose,"aria-label":this.props.locale.CLOSE_CHAT,onClick:this.handleRejectButtonClickForProactiveNotification.bind(this),onKeyDown:this.onCloseKeyDown.bind(this)}),React.createElement("span",{className:n.HtmlClassNames.ipcpBannerText},React.createElement("p",{className:n.HtmlClassNames.ipcpBannerTextRow1},this.props.locale.PROACTIVE_CHAT_BANNER_WELCOME_TO_TEXT),React.createElement("p",{className:n.HtmlClassNames.ipcpBannerTextRow2},this.props.locale.PROACTIVE_CHAT_BANNER_LIVE_CHAT_SUPPORT_TEXT))),React.createElement("span",{className:n.HtmlClassNames.ipcpWelcomMessageText}," ",n.Loader.proactiveChatNotificationConfig.message," "),React.createElement("div",{id:n.HtmlIdNames.ipcpIncomingProactiveChatAcceptButton,className:n.HtmlClassNames.ipcpAcceptButton,style:{backgroundColor:this.props.liveChatConfig.chatTitleColor},onClick:this.handleAcceptButtonClickForProactiveNotification.bind(this),onKeyDown:this.onAcceptKeyDown.bind(this)},React.createElement("span",{role:n.HtmlAttributeNames.button,tabIndex:0,className:n.HtmlClassNames.ipcpAcceptButtonText},this.props.locale.PROACTIVE_CHAT_ACCEPT)))},i.prototype.onEscapeKeyDown=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ESC&&this.handleRejectButtonClickForProactiveNotification()},i.prototype.onCloseKeyDown=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.handleRejectButtonClickForProactiveNotification()},i.prototype.onAcceptKeyDown=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.handleAcceptButtonClickForProactiveNotification()},i.prototype.handleAcceptButtonClickForProactiveNotification=function(){n.TelemetryClient.info({Event:n.TelemetryEvent.ProactiveChatAccepted});n.Loader.currentConversation.isProactiveChat=!0;n.ProactiveChatController.clearTimeout();this.props.handleChatButtonClick(n.ChatContainer.inPopoutWindow)},i.prototype.handleRejectButtonClickForProactiveNotification=function(){var t=n.Util.timer();n.TelemetryClient.info({Event:n.TelemetryEvent.ProactiveChatRejected});n.ProactiveChatController.clearTimeout();this.props.showComponents(n.Components.ChatButton);n.LogHelper.logProactiveChatCloseTimeAfterReject(t.milliSecondsElapsed)},i}(React.Component);n.ProactiveChatPage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n){this.config=n}return n.prototype.shouldRenderOperatingHour=function(){return this.config.outOfOperatingHours},n}();n.OperatingHourController=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){n.FrameHandler.setToDefaultSize(window);n.Util.setAriaLiveAlert(this.operationHoursMessage)},i.prototype.render=function(){return this.operationHoursMessage=this.props.liveChatConfig.outsideOperatingHoursTitle.replace(n.Constants.urlRegex,function(n){return'<a href="'+n+'" rel="noreferrer noopener">'+n+"<\/a>"}),React.createElement("div",{className:n.HtmlClassNames.operatingHourPageContainerContainer,role:n.HtmlAttributeNames.region,"aria-label":this.props.locale.OperatingHour_LANDMARK,onKeyDown:this.onEscapeKeyDown.bind(this)},React.createElement("div",{className:n.HtmlClassNames.operatingHourPage,"aria-labelledby":n.HtmlIdNames.webChatHeaderTitle},React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.onMinimizeClick.bind(this),onClose:this.props.onClose.bind(this),showIconAndTitle:!0,showMinimizeButton:!0,showCloseButton:!1}),React.createElement("div",{className:n.HtmlClassNames.ohContainer},React.createElement("div",{id:n.HtmlIdNames.ohAlertText,className:n.HtmlClassNames.ohLogoAlertText},React.createElement("div",{className:n.HtmlClassNames.ohAlertMessage+"  "+n.HtmlClassNames.ohTitle,dangerouslySetInnerHTML:{__html:this.operationHoursMessage}})))))},i.prototype.onMinimizeClick=function(){this.props.showComponents(n.Components.ChatButton);this.props.changeCurrentOHWidgetState(n.WidgetState.Minimized)},i.prototype.onEscapeKeyDown=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ESC&&this.onMinimizeClick()},i}(React.Component);n.OperatingHourPage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.componentDidMount=function(){this.props.postchatLoadPageDisplayStyle.minimizeButtonVisibility?n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderMinimizeButton):this.props.postchatLoadPageDisplayStyle.closeButtonVisibility&&n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderCloseButton);n.FrameHandler.setToDefaultSize(window)},i.prototype.componentDidUpdate=function(t){this.props.postchatLoadPageDisplayStyle.closeButtonVisibility!==t.postchatLoadPageDisplayStyle.closeButtonVisibility&&n.Utility.focusOnElement(n.HtmlIdNames.webChatHeaderCloseButton)},i.prototype.render=function(){return React.createElement("div",{className:n.HtmlClassNames.pageContainerPostchatLoadPage,"aria-label":n.Loader.Locale.POSTCHAT_LANDMARK,onKeyDown:this.onEscapeKeyDown.bind(this),"aria-labelledby":n.HtmlIdNames.pclText+" "+n.HtmlIdNames.pclText1Id+" "+n.HtmlIdNames.pclText2Id,"aria-live":n.HtmlClassNames.assertive},React.createElement("div",{className:n.HtmlClassNames.pclPage,style:{backgroundColor:n.Loader.liveChatConfig.chatTitleColor}},React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.props.onMinimize.bind(this),onClose:this.onCloseClick.bind(this),showIconAndTitle:!1,showMinimizeButton:!n.Bootstrapper.lcwHideMinimizeButton,showCloseButton:this.props.postchatLoadPageDisplayStyle.closeButtonVisibility,customCloseButtonId:n.HtmlIdNames.webChatHeaderCloseButton}),React.createElement("div",{className:n.HtmlClassNames.pclContainer},React.createElement("div",{className:n.HtmlClassNames.pclSubContainer},React.createElement("div",{id:n.HtmlIdNames.pclText,style:{display:this.props.postchatLoadPageDisplayStyle.textComponentVisibility?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},React.createElement("span",{id:n.HtmlIdNames.pclText1Id,className:n.HtmlClassNames.pclMessage+" "+n.HtmlClassNames.pcl1},n.Loader.Locale.POSTCHAT_SURVEY_LOAD_SCREEN_TEXT1),React.createElement("span",{id:n.HtmlIdNames.pclText2Id,className:n.HtmlClassNames.pclMessage+" "+n.HtmlClassNames.pcl1},n.Loader.Locale.POSTCHAT_SURVEY_LOAD_SCREEN_TEXT2))))))},i.prototype.onMinimizeKeyDown=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.props.onMinimize()},i.prototype.onCloseKeyDown=function(t){(t.keyCode===n.Constants.KeyCodes.KEY_ENTER||t.keyCode===n.Constants.KeyCodes.KEY_SPACE)&&this.props.onClose()},i.prototype.onEscapeKeyDown=function(t){t.keyCode!==n.Constants.KeyCodes.KEY_ESC||n.Bootstrapper.isPopOutMode||this.props.onMinimize()},i.prototype.onCloseClick=function(){this.props.handleChatClose()},i}(React.Component);n.PostchatLoadPage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(i){var r=t.call(this,i)||this;return AdaptiveCards.AdaptiveCard.elementTypeRegistry.registerType(n.RatingInput.RatingType,function(){return new n.RatingInput}),r}return __extends(i,t),i.prototype.componentDidMount=function(){var t=this;try{this.postchatController=new n.PostchatController(this.props.liveChatConfig);this.props.showComponents(n.Components.PostchatLoadingScreen);this.postchatController.getSurveyInviteLink().then(function(){t.props.showComponents(n.Components.PostchatSurvey);renderSurvey(n.HtmlIdNames.postChatEmbedModeContainer,t.postchatController.surveyInviteLink,"","",t.postchatController.formsProLocale)}).catch(function(i){t.props.handleConversationClose();n.TelemetryClient.error({Event:n.TelemetryEvent.PostChatFormsProRenderFailed,ExceptionDetails:i})})}catch(i){this.props.handleConversationClose();n.TelemetryClient.error({Event:n.TelemetryEvent.PostChatFormsProRenderFailed,ExceptionDetails:i})}},i.prototype.render=function(){return React.createElement("div",{role:n.HtmlAttributeNames.region,className:n.HtmlClassNames.postChatPage+" "+n.HtmlClassNames.cardContainer,"aria-label":this.props.locale.POSTCHAT_LANDMARK,"aria-labelledby":n.HtmlIdNames.webChatHeaderTitle},React.createElement("div",{className:n.HtmlClassNames.ppContainer,onKeyDown:this.onEscapeKeyDown.bind(this)},React.createElement("div",{id:n.HtmlIdNames.chatDimLayer,className:n.HtmlClassNames.webChatDimLayer,style:{display:this.props.showEmailRequestDialog||this.props.showCloseConfirmation?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},this.props.showEmailRequestDialog&&React.createElement(n.EmailRequestDialog,{onDialogHide:this.props.hideEmailDialog.bind(this)}),this.props.showCloseConfirmation&&!this.props.confirmationDialogDisplayed&&React.createElement(n.CloseConfirmation,{closeConfirmationInput:this.props.closeConfirmationInput})),this.props.showHeader&&React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.onMinimizeClick.bind(this),onClose:this.onCloseClick.bind(this),showIconAndTitle:!0,showMinimizeButton:!n.Bootstrapper.lcwHideMinimizeButton,showCloseButton:!0,showCustomCloseButton:n.Bootstrapper.lcwEnableCustomCloseButtonText&&n.Bootstrapper.lcwEnableCustomCloseButtonText.trim().length>0}),React.createElement("div",{className:n.HtmlClassNames.ppPostchatMainContainer},React.createElement("div",{id:n.HtmlIdNames.postChatEmbedModeContainer,className:n.HtmlClassNames.ppPostchatContainer}))),this.props.enabledActions.length>0&&React.createElement(n.ActionBar,{enabledActions:this.props.enabledActions}))},i.prototype.onMinimizeClick=function(){this.props.showComponents(n.Components.ChatButton);this.props.changeCurrentSurveyWidgetState(n.WidgetState.Minimized)},i.prototype.onEscapeKeyDown=function(t){t.keyCode!==n.Constants.KeyCodes.KEY_ESC||n.Bootstrapper.isPopOutMode||this.onMinimizeClick()},i.prototype.onCloseClick=function(){this.props.handleChatClose()},i}(React.Component);n.PostchatPage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.isAuthReconnectFlow=function(){return!n.Loader.liveChatConfig.isReconnectEnabled||n.Loader.reconnectId&&n.Loader.reconnectId.trim()||!n.Loader.liveChatConfig.authClientFunction||this.isReconnectResponseSubmitted()?!1:!0},t.prototype.checkPreviousActiveSession=function(){var t=this;return new Promise(function(i){return __awaiter(t,void 0,void 0,function(){var t,r,u;return __generator(this,function(f){switch(f.label){case 0:return[4,n.AuthManager.acquireTokenFromAuthMethod()];case 1:return t=f.sent(),n.Util.isNullOrEmptyString(t)?(r=new Error("Received empty token"),n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,r),i(null)):(n.Loader.initContext.authenticatedUserToken=t,u={authenticatedUserToken:t},n.OmnichannelProxy.getInstance().getReconnectableChats(u).then(function(n){n&&n.reconnectid&&i(n.reconnectid);i(null)},function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.GetReconnectableChatsFailed,ExceptionDetails:t});i(null)})),[2]}})})})},t.prototype.resetReconnectResponse=function(){n.Loader.reconnectResponse=null},t.prototype.isReconnectResponseSubmitted=function(){return!!n.Loader.reconnectResponse},t.prototype.retrieveReconnectId=function(){var i=n.Util.getUrlQueryString(),t;return n.Loader.liveChatConfig.isReconnectEnabled&&!n.Util.isNullOrEmptyString(i)&&(t=n.Util.getQueryParameters(i),t&&!n.Util.isNullOrEmptyString(t[n.Constants.ReconnectIdAttributeName]))?t[n.Constants.ReconnectIdAttributeName]:null},t.prototype.reconnectAvailabilityCheck=function(t){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(){return[2,new Promise(function(r){return __awaiter(i,void 0,void 0,function(){return __generator(this,function(){return n.OmnichannelProxy.getInstance().getReconnectAvailability(t).then(function(i){i&&!i.isReconnectAvailable?i.reconnectRedirectionURL&&r(i.reconnectRedirectionURL):n.Loader.reconnectId=t;r(null)},function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.GetReconnectAvailabilityFailed,ExceptionDetails:t});r(null)}),[2]})})})]})})},t}();n.ChatReconnectController=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){this.props.renderCard(this.onSurveySubmit.bind(this));n.FrameHandler.setToDefaultSize(window)},i.prototype.render=function(){return React.createElement("div",{role:n.HtmlAttributeNames.region,className:n.HtmlClassNames.chatReconnectPage+" "+n.HtmlClassNames.cardContainer,"aria-label":this.props.locale.PRECHAT_LANDMARK,"aria-labelledby":n.HtmlIdNames.webChatHeaderTitle},React.createElement("div",{className:n.HtmlClassNames.ppContainer,onKeyDown:this.onEscapeKeyDown.bind(this)},this.props.showHeader&&React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.onMinimizeClick.bind(this),onClose:this.onCloseClick.bind(this),showIconAndTitle:!0,showMinimizeButton:!n.Bootstrapper.lcwHideMinimizeButton,showCloseButton:n.Bootstrapper.lcwHideMinimizeButton,showCustomCloseButton:n.Bootstrapper.lcwEnableCustomCloseButtonText&&n.Bootstrapper.lcwEnableCustomCloseButtonText.trim().length>0}),React.createElement("div",{className:n.HtmlClassNames.ppPrechatMainContainer},React.createElement("div",{className:n.HtmlClassNames.ppPrechatContainer}))))},i.prototype.onMinimizeClick=function(){this.props.showComponents(n.Components.ChatButton);this.props.changeCurrentSurveyWidgetState(n.WidgetState.Minimized)},i.prototype.onCloseClick=function(){this.props.showComponents(n.Components.ChatButton);this.props.changeCurrentSurveyWidgetState(n.WidgetState.Closed)},i.prototype.onEscapeKeyDown=function(t){t.keyCode===n.Constants.KeyCodes.KEY_ESC&&this.onMinimizeClick()},i.prototype.onSurveySubmit=function(t){var i=this.extractSurveyResponses(t);this.recordReconnectResponse(i);i==n.HtmlIdNames.reconnectButtonValue?(n.TelemetryClient.info({Event:n.TelemetryEvent.ChatReconnectPopUp,ActionType:"continue to old conversation button is clicked"}),this.props.loadWidget(!1).then(function(){return n.TelemetryClient.info({Event:n.TelemetryEvent.WebChatLoaded})})):(n.Loader.reconnectId=null,n.TelemetryClient.info({Event:n.TelemetryEvent.ChatReconnectPopUp,ActionType:"start new conversation button is clicked"}),this.props.postReconnectCheckHandler())},i.prototype.extractSurveyResponses=function(n){return n.data.value},i.prototype.recordReconnectResponse=function(t){n.Loader.reconnectResponse=t},i}(React.Component);n.ChatReconnectPage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){var i=t.call(this)||this;return i.validator=new n.SurveyValidator(i.enableSurveySubmit.bind(i)),i}return __extends(i,t),i.prototype.componentDidMount=function(){this.setDefaultFocusOnFirstInput(this.adaptiveCard);var t=document.getElementsByClassName(n.HtmlClassNames.submitButton)[0];t&&n.Bootstrapper.widgetThemeColor&&(t.style.backgroundColor=n.Bootstrapper.widgetThemeColor)},i.prototype.render=function(){return React.createElement("div",{id:n.HtmlIdNames.surveyPlaceholderId,style:{display:this.props.shouldShowSurvey?n.Constants.HTMLConstants.block:n.Constants.HTMLConstants.none}},React.createElement("div",{className:n.HtmlClassNames.pageContainer,dir:n.Util.getLocaleDirection(this.props.liveChatConfig.chatWidgetLocaleLCID)},this.props.surveyType===n.SurveyType.Prechat&&React.createElement(n.PrechatPage,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,showComponents:this.props.showComponents.bind(this),addAriaLabelForInputElements:this.addAriaLabelForInputElements.bind(this),enableSurveySubmit:this.enableSurveySubmit.bind(this),loadWidget:this.props.loadWidget.bind(this),validator:this.validator,renderCard:this.renderCard.bind(this),changeCurrentSurveyWidgetState:this.props.changeCurrentSurveyWidgetState.bind(this),showHeader:!n.Bootstrapper.renderOnMobileDevice&&!n.Bootstrapper.isPopOutMode}),this.props.surveyType===n.SurveyType.Postchat&&React.createElement(n.PostchatPage,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,showComponents:this.props.showComponents.bind(this),addAriaLabelForInputElements:this.addAriaLabelForInputElements.bind(this),enableSurveySubmit:this.enableSurveySubmit.bind(this),closeConversation:this.props.closeConversation.bind(this),validator:this.validator,changeCurrentSurveyWidgetState:this.props.changeCurrentSurveyWidgetState.bind(this),enabledActions:this.props.enabledActions,hideEmailDialog:this.props.hideEmailDialog.bind(this),showEmailRequestDialog:this.props.showEmailRequestDialog,showHeader:!n.Bootstrapper.renderOnMobileDevice&&!n.Bootstrapper.isPopOutMode,showCloseConfirmation:this.props.showCloseConfirmation,confirmationDialogDisplayed:this.props.confirmationDialogDisplayed,closeConfirmationInput:this.props.closeConfirmationInput,handleChatClose:this.props.handleChatClose.bind(this),handleConversationClose:this.props.handleConversationClose.bind(this)}),this.props.surveyType===n.SurveyType.ChatReconnect&&React.createElement(n.ChatReconnectPage,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,showComponents:this.props.showComponents.bind(this),addAriaLabelForInputElements:this.addAriaLabelForInputElements.bind(this),enableSurveySubmit:this.enableSurveySubmit.bind(this),loadWidget:this.props.loadWidget.bind(this),postReconnectCheckHandler:this.props.postReconnectCheckHandler.bind(this),validator:this.validator,renderCard:this.renderChatReconnectCard.bind(this),changeCurrentSurveyWidgetState:this.props.changeCurrentSurveyWidgetState.bind(this),showHeader:!n.Bootstrapper.renderOnMobileDevice&&!n.Bootstrapper.isPopOutMode}),this.props.shouldShowPostchatLoadingScreen&&React.createElement(n.PostchatLoadPage,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.onPostchatLoadPageMinimize.bind(this),onClose:this.onPostchatLoadPageClose.bind(this),postchatLoadPageDisplayStyle:this.props.postchatLoadPageDisplayStyle,handleChatClose:this.props.handleChatClose.bind(this)})))},i.prototype.addAriaLabelForInputElements=function(t){var r=t.getAllInputs(),u;if(r&&r.length>0)for(u=0;u<r.length;u++){var i=r[u],f=t.getItemAt(i.index-1),e=f&&f.renderedElement&&f.renderedElement.textContent?f.renderedElement.textContent:"";i&&i.renderedElement&&(i.getJsonTypeName()===n.HtmlAttributeNames.inputToggle?n.Utility.addElementsForCheckBoxInput(i):(i.renderedElement.setAttribute(n.HtmlAttributeNames.ariaLabel,e),this.addAriaRequiredForRequiredField(i)))}},i.prototype.setDefaultFocusOnFirstInput=function(n){if(n){var t=n.getAllInputs();t&&t.length>0&&t[0].renderedElement&&t[0].renderedElement.focus()}},i.prototype.addAriaRequiredForRequiredField=function(t){try{var i=JSON.parse(t.id);i.IsRequired===!0&&t.renderedElement.setAttribute(n.HtmlAttributeNames.ariaRequired,!0)}catch(r){n.TelemetryClient.info({Event:n.TelemetryEvent.InvalidAdaptiveCardFormat,ExceptionDetails:r})}},i.prototype.enableSurveySubmit=function(t){var i=$j(n.HtmlClassNames.pushButton)[0];t?i.classList.remove(n.HtmlAttributeNames.disabled):i.classList.add(n.HtmlAttributeNames.disabled);i.setAttribute(n.HtmlAttributeNames.ariaDisabled,t?n.HtmlAttributeNames.false:n.HtmlAttributeNames.true)},i.prototype.renderCard=function(t){var i=new AdaptiveCards.AdaptiveCard,r;this.adaptiveCard=i;i.hostConfig=new AdaptiveCards.HostConfig({fontFamily:n.HtmlCssConstants.adaptiveCardFont});i.onParseElement=this.validator.attachFieldValidators.bind(this.validator);i.onExecuteAction=t.bind(this);i.parse(this.props.liveChatConfig.preChatSurvey);r=i.render();this.addAriaLabelForInputElements(i);r.setAttribute(n.HtmlAttributeNames.role,n.HtmlAttributeNames.form);r.setAttribute(n.HtmlAttributeNames.ariaLabelledby,n.HtmlIdNames.webChatHeaderTitle);r.setAttribute(n.HtmlAttributeNames.tabindex,"-1");(new n.HTMLTextMiddleware).processANode(r);document.getElementsByClassName(n.HtmlAttributeNames.prechatContainer)[0].appendChild(r);n.Utility.addScrollToPreChatDropdown(n.HtmlClassNames.preChatDropdown)},i.prototype.renderChatReconnectCard=function(t){var e='{"type":"AdaptiveCard","version":"1.1","body":[{"type":"TextBlock","weight":"bolder","text":"'+this.props.locale.RECONNECT_POPUP_TITLE+'","wrap":true},{"type":"TextBlock","spacing": "Medium","text":"'+this.props.locale.RECONNECT_POPUP_DESCRIPTION+'","wrap":true},{"type":"Image","horizontalAlignment":"center","height":"90px","spacing": "Large","url":"'+n.ScriptPaths.ChatReconnectPopupIconPath+'","size":"large","style":"default"}],"actions":[{"type":"Action.Submit","data":{"Type":"InputSubmit","value":"'+n.HtmlIdNames.reconnectButtonValue+'"},"title":"'+this.props.locale.RECONNECT_POPUP_OLDSESSION_BUTTON+'"},{"type":"Action.Submit","data":{"Type":"InputSubmit","value":"'+n.HtmlIdNames.newChatButtonValue+'"},"title":"'+this.props.locale.RECONNECT_POPUP_NEWSESSION_BUTTON+'"}]}',i=new AdaptiveCards.AdaptiveCard,r,f,u;this.adaptiveCard=i;i.hostConfig=new AdaptiveCards.HostConfig({fontFamily:n.HtmlCssConstants.adaptiveCardFont});i.onExecuteAction=t.bind(this);i.parse(JSON.parse(e));r=i.render();this.addAriaLabelForInputElements(i);r.setAttribute(n.HtmlAttributeNames.role,n.HtmlAttributeNames.form);r.setAttribute(n.HtmlAttributeNames.ariaLabelledby,n.HtmlIdNames.webChatHeaderTitle);r.setAttribute(n.HtmlAttributeNames.tabindex,"-1");f=r.getElementsByClassName(n.HtmlClassNames.acActionSet);f.length>0&&(u=f[0].style,u&&(u.flexDirection=n.HtmlCallingCssConstants.column,u.paddingTop=n.HtmlCssConstants.fifteenPx));document.getElementsByClassName(n.HtmlAttributeNames.prechatContainer)[0].appendChild(r)},i.prototype.onPostchatLoadPageMinimize=function(){this.shouldPostchatSurveyShowChatButtonOnMinimize()&&this.props.showComponents(n.Components.ChatButton)},i.prototype.onPostchatLoadPageClose=function(){this.props.changeCurrentSurveyWidgetState(n.WidgetState.Closed);this.props.closeConversation();this.props.showComponents(n.Components.ChatButton)},i.prototype.shouldPostchatSurveyShowChatButtonOnMinimize=function(){return!this.props.postchatLoadPageDisplayStyle.alertTextComponentVisibility},i}(React.Component);n.SurveyPlaceholder=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){var i=t.call(this)||this;return i.querySelectorForOptions="#"+n.HtmlIdNames.MSLiveChatWidget+" ."+n.HtmlClassNames.pageContainer+" ."+n.HtmlClassNames.acContainer+" ."+n.HtmlClassNames.acMultichoiceInput,i}return __extends(i,t),i.prototype.componentDidMount=function(){this.props.renderCard(this.onSurveySubmit.bind(this));n.FrameHandler.setToDefaultSize(window);this.removeExtraOption()},i.prototype.render=function(){return React.createElement("div",{role:n.HtmlAttributeNames.region,className:n.HtmlClassNames.preChatPage+" "+n.HtmlClassNames.cardContainer,"aria-label":this.props.locale.PRECHAT_LANDMARK,"aria-labelledby":n.HtmlIdNames.webChatHeaderTitle},React.createElement("div",{className:n.HtmlClassNames.ppContainer,onKeyDown:this.onEscapeKeyDown.bind(this)},this.props.showHeader&&React.createElement(n.Header,{liveChatConfig:this.props.liveChatConfig,locale:this.props.locale,onMinimize:this.onMinimizeClick.bind(this),onClose:this.onCloseClick.bind(this),showIconAndTitle:!0,showMinimizeButton:!n.Bootstrapper.lcwHideMinimizeButton,showCloseButton:n.Bootstrapper.lcwHideMinimizeButton,showCustomCloseButton:n.Bootstrapper.lcwEnableCustomCloseButtonText&&n.Bootstrapper.lcwEnableCustomCloseButtonText.trim().length>0}),React.createElement("div",{className:n.HtmlClassNames.ppPrechatMainContainer},React.createElement("div",{className:n.HtmlClassNames.ppPrechatContainer}))))},i.prototype.onMinimizeClick=function(){this.props.showComponents(n.Components.ChatButton);this.props.changeCurrentSurveyWidgetState(n.WidgetState.Minimized)},i.prototype.onCloseClick=function(){this.props.showComponents(n.Components.ChatButton);this.props.changeCurrentSurveyWidgetState(n.WidgetState.Closed)},i.prototype.onEscapeKeyDown=function(t){t.keyCode!==n.Constants.KeyCodes.KEY_ESC||n.Bootstrapper.isPopOutMode||this.onMinimizeClick()},i.prototype.onSurveySubmit=function(t){if(this.props.validator.canSubmitSurvey(t)){n.TelemetryClient.info({Event:n.TelemetryEvent.PrechatSubmitted});n.Util.setAriaLiveAlert(n.Loader.Locale.LOADING_CHAT_WIDGET);var i=this.extractSurveyResponses(t),r=n.Util.timer();this.props.enableSurveySubmit(!1);this.props.validator.disableInputs(t);this.persistPreChatResponse(i);this.props.loadWidget(!0).then(function(){return n.TelemetryClient.info({Event:n.TelemetryEvent.WebChatLoaded})})}},i.prototype.persistPreChatResponse=function(t){n.Loader.initContext.preChatResponse=t;n.ContextSpecificDataStore.PersistData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.PreChatResponse,t,n.ConfigurationManager.ConfigExpiryTime)},i.prototype.extractSurveyResponses=function(n){return n.data},i.prototype.removeExtraOption=function(){var t=document.querySelectorAll(this.querySelectorForOptions),i,r;if(t&&t.length>0)for(i=0;i<t.length;i++)t[i].childNodes&&(r=t[i].childNodes[0],r.attributes[n.HtmlAttributeNames.disabled]&&r.attributes[n.HtmlAttributeNames.hidden]&&t[i].removeChild(r))},i}(React.Component);n.PrechatPage=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getInitContext=function(){return t.populateInitContext()},t.populateInitContext=function(){return new Promise(function(t){var i=new n.InitContext;i.locale=n.Loader.liveChatConfig.chatWidgetLocale;i.device=n.DeviceInfo.getDeviceType();i.os=n.OSInfo.getOsType().toString();i.browser=n.BrowserInfo.getBrowserName();i.originurl=n.Util.getCurrentUrl();i.fetchPortalContactId=function(){if(n.Bootstrapper.isPopOutMode)if(n.Bootstrapper.isCustomPopOutMode){if(window.opener){var t,i=function(i){if(i.data&&i.data.messageName==n.IframeMessages.portalContactIdResponse&&(t=i.data.portalContactId,t))return t.toString()};window.addEventListener("message",i,!1);window.opener.postMessage({messageName:n.IframeMessages.portalContactIdRequest},"*")}}else if(window.opener&&typeof window.opener[n.Constants.Microsoft][n.Constants.Dynamic365]!=n.Constants.Undefined&&typeof window.opener[n.Constants.Microsoft][n.Constants.Dynamic365][n.Constants.Portal]!=n.Constants.Undefined&&typeof window.opener[n.Constants.Microsoft][n.Constants.Dynamic365][n.Constants.Portal][n.Constants.User]!=n.Constants.Undefined)return window.opener[n.Constants.Microsoft][n.Constants.Dynamic365][n.Constants.Portal][n.Constants.User][n.Constants.ContactId].toString();if(typeof window[n.Constants.Microsoft][n.Constants.Dynamic365]!=n.Constants.Undefined&&typeof window[n.Constants.Microsoft][n.Constants.Dynamic365][n.Constants.Portal]!=n.Constants.Undefined&&typeof window[n.Constants.Microsoft][n.Constants.Dynamic365][n.Constants.Portal][n.Constants.User]!=n.Constants.Undefined)return window[n.Constants.Microsoft][n.Constants.Dynamic365][n.Constants.Portal][n.Constants.User][n.Constants.ContactId].toString()};t(i)})},t.setInitContext=function(){var i=t.getInitContext();return i.then(function(t){n.Loader.initContext=t;n.Loader.initContext.preChatResponse=n.ContextSpecificDataStore.GetData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.PreChatResponse)})},t.resetInitContext=function(){n.Loader.initContext.authenticatedUserToken=null;n.Loader.initContext.customContextData=null},t.addCustomContextData=function(t){var i,f,u,e;if(n.Loader.contextProvider||t){i=null;try{i=t?t:n.Loader.contextProvider()}catch(s){n.TelemetryClient.error({Event:n.TelemetryEvent.ContextProviderException,ExceptionDetails:s});n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_CONTEXTPROVIDER_METHOD_FAIL,s);return}if(i){for(f={},u=0,e=Object.keys(i);u<e.length;u++){var h=e[u],r=i[h],o={};typeof r!="function"&&r!==null&&(o=typeof r=="object"?this.getCustomPropertiesBag(r):this.getCustomPropertiesBag({value:r}),o&&(f[h]=o))}n.Loader.initContext.customContextData=f}}},t.getCustomPropertiesBag=function(n){for(var t,r,i=this.getCustomPropertiesDefaultValueMapping(),u=0,f=Object.keys(i);u<f.length;u++)if(t=f[u],t in n){if(r=n[t],typeof r=="function"||typeof r=="object"&&r!==null)continue;i[t]=n[t]}return i.value?i:null},t.getCustomPropertiesDefaultValueMapping=function(){return{value:null,isDisplayable:!1}},t}();n.ContextService=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.createTimeoutForInvite=function(t){n.Util.isNullOrUndefined(this.timeoutEvent)&&(this.timeoutEvent=setTimeout(this.handleTimeoutForProactiveNotification.bind(this,t.bind(this)),n.Constants.ProactiveChatInviteTimeout),this.timeoutRemoved=!1)},t.clearTimeout=function(){this.timeoutRemoved=!0;clearTimeout(this.timeoutEvent)},t.handleTimeoutForProactiveNotification=function(t){if(!this.timeoutRemoved){var i=n.Util.timer();n.TelemetryClient.info({Event:n.TelemetryEvent.ProactiveChatInvitationTimedOut});clearTimeout(this.timeoutEvent);t(n.Components.ChatButton);n.LogHelper.logProactiveChatCloseTimeAfterTimeout(i.milliSecondsElapsed)}},t.getProactiveChatInviteMessage=function(t,i){var r=i;return n.Util.isNullOrUndefined(t)||n.Util.isNullOrEmptyString(t.message)||(r=t.message),r},t.resetProctiveChatContext=function(){n.Loader.currentConversation.isProactiveChat=!1},t.validateAndSetProactiveChatNotificationConfig=function(t,i){n.Loader.proactiveChatNotificationConfig=new n.ProactiveChatNotificationConfig;n.Loader.proactiveChatNotificationConfig.message=this.getProactiveChatInviteMessage(t,i)},t.timeoutRemoved=!1,t}();n.ProactiveChatController=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(n){this.config=n}return t.prototype.canRenderPostChat=function(){return this.config.isPostChatEnabled&&n.Utility.isValidSurveyScript(n.Constants.msfpEmbedScript)&&!n.Util.isNullOrUndefined(this.config.postChatSurveyIdentifier)&&!n.Util.isNullOrUndefined(this.config.postChatSurveyOwnerId)},t.prototype.shouldRenderPostchat=function(){return this.canRenderPostChat()&&!n.Loader.currentConversation.isPostChatDisplayed&&n.Loader.surveyEnabledParticipantJoined},t.prototype.setIsPostChatDisplayedState=function(t){n.Loader.currentConversation.isPostChatDisplayed=t},t.prototype.getSurveyInviteLink=function(){var i=this;return new Promise(function(r,u){return __awaiter(i,void 0,void 0,function(){var i=this,f,e,o,s,h;return __generator(this,function(c){switch(c.label){case 0:return f=function(t){if(t!=null){if(t.inviteList!=null&&t.inviteList.length==1)i.surveyInviteLink=t.inviteList[0].invitationLink;else n.TelemetryClient.error({Event:n.TelemetryEvent.GetSurveyInviteLinkFailed,ExceptionDetails:{"Error Message":"Survey Invite link failed to send response."}});t.formsProLocaleCode!=null&&(i.formsProLocale=t.formsProLocaleCode)}r(t)},e=function(t){n.TelemetryClient.error({Event:n.TelemetryEvent.GetSurveyInviteLinkFailed,ExceptionDetails:t});u()},o={FormId:n.Loader.participantType===n.UserTypeToBeSurveyed.Bot?this.config.postChatBotSurveyIdentifier:this.config.postChatSurveyIdentifier,ConversationId:n.Loader.conversationId,OCLocaleCode:this.config.chatWidgetLocale},s=n.Loader.participantType===n.UserTypeToBeSurveyed.Bot?this.config.postChatBotSurveyOwnerId:this.config.postChatSurveyOwnerId,[4,t.getOptionParamForInviteLinkAPI()];case 1:return h=c.sent(),n.OmnichannelProxy.getInstance().getSurveyInviteLink(s,o,h).then(f,e),[2]}})})})},t.getOptionParamForInviteLinkAPI=function(){return __awaiter(this,void 0,void 0,function(){var t,i,r;return __generator(this,function(u){switch(u.label){case 0:return(t={},!n.Loader.liveChatConfig.authClientFunction)?[3,2]:[4,n.AuthManager.acquireTokenFromAuthMethod()];case 1:i=u.sent();n.Util.isNullOrEmptyString(i)?(r=new Error("Received empty token"),n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,r)):(t.authenticatedUserToken=i,t.requestId=n.Loader.currentRequestId);u.label=2;case 2:return[2,t]}})})},t.prototype.addEmbedPostChatScriptToHead=function(){var f,u,e,o,r,i,t;if(n.Util.isNullOrUndefined(n.Constants.msfpEmbedScript)||!n.Utility.isValidSurveyScript(n.Constants.msfpEmbedScript)){f=new Error(n.Constants.invalidMsfpEmbedScriptException);n.TelemetryClient.error({Event:n.TelemetryEvent.PostChatFormsProRenderFailed,ExceptionDetails:f});throw f;}for(u=document.createElement(n.Constants.HTMLConstants.div),u.innerHTML=n.Constants.msfpEmbedScript,e=u.getElementsByTagName(n.BootstrapperConstants.Script),o=u.getElementsByTagName(n.BootstrapperConstants.Link),r=0;r<e.length;r++)i=e[r],i.src&&(t=document.createElement(n.BootstrapperConstants.Script),t.type=i.type,t.src=i.src,window.document.head.contains(t)||document.getElementsByTagName(n.BootstrapperConstants.Head)[0].appendChild(t)),i.innerHTML&&(t=document.createElement(n.BootstrapperConstants.Script),t.innerHTML=i.innerHTML,window.document.head.contains(t)||window.document.head.appendChild(t));for(r=0;r<o.length;r++)i=o[r],i.href&&(t=document.createElement(n.BootstrapperConstants.Link),t.type=i.type,t.rel=i.rel,t.href=i.href,window.document.head.contains(t)||document.getElementsByTagName(n.BootstrapperConstants.Head)[0].appendChild(t))},t}();n.PostchatController=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.isValid=!0,n}return __extends(i,t),i.prototype.internalRender=function(){var r,t;return this.value=""+this.scale,r=document.createElement("div"),r.innerHTML=this.get(),t=this,this.addEventListener(n.HtmlIdNames.surveyPlaceholderId,i.RatingStarClass,n.HtmlEventNames.click,function(n){t.onRatingClick(n)}),this.addEventListener(n.HtmlIdNames.surveyPlaceholderId,i.RatingStarClass,n.HtmlEventNames.keypress,function(n){t.onRatingPress(n)}),this.addEventListener(n.HtmlIdNames.surveyPlaceholderId,i.RatingFieldSetClass,n.HtmlEventNames.keydown,function(n){t.handleArrowKeys(n)}),r},i.prototype.addEventListener=function(n,t,i,r){document.getElementById(n).addEventListener(i,function(n){n.target.className.indexOf(t)>=0&&r(n)})},i.prototype.onRatingClick=function(n){var t=n.target.htmlFor,i=document.getElementById(t);this.value=i.value},i.prototype.onRatingPress=function(n){var i=n,r,t;(i.keyCode==13||i.keyCode==32)&&(r=n.target.htmlFor,t=document.getElementById(r),this.value=t.value,t.checked=!0)},i.prototype.handleArrowKeys=function(t){var e,o,r;if(t.type=="keydown"){var u=t,f=t.target,i=null;u.keyCode==n.Constants.KeyCodes.KEY_ARROW_LEFT?(e=parseInt(f.htmlFor.split(n.Constants.HTMLConstants.star)[0])-1+n.Constants.HTMLConstants.star,i=document.getElementById(e)):u.keyCode==n.Constants.KeyCodes.KEY_ARROW_RIGHT&&(o=parseInt(f.htmlFor.split(n.Constants.HTMLConstants.star)[0])+1+n.Constants.HTMLConstants.star,i=document.getElementById(o));i&&(r=i,r.labels[0].click(),r.labels[0].focus())}},i.prototype.toJSON=function(){return t.prototype.toJSON.call(this)},i.prototype.getJsonTypeName=function(){return i.RatingType},i.prototype.parse=function(n,i){this.scale=parseInt(n.scale);t.prototype.parse.call(this,n,i)},i.prototype.getRootElementSelector=function(){return"."+n.HtmlClassNames.postChatPage},i.prototype.get=function(){for(var t,e,o='<fieldset class="oclcw-pop-rating" aria-role="radiogroup" aria-label="'+n.Loader.Locale.POSTCHAT_RATING+'">',u="",f="0",r=1;r<=this.scale;r++)t=r+"star",e='<input type="radio" id="'+t+'" name="rating" value="'+r+'" /><label class = "'+i.RatingStarClass+'" placeholder = "'+t+'" aria-label="'+t+'" for= "'+t+'" title = "'+t+'" tabindex = "'+f+'" aria-role="radio" > <\/label>',u=u+e,f="-1";return o+u+"<\/fieldset>"},i.RatingType="Input.Rating",i.RatingStarClass="oclcw-pop-rating-star",i.RatingFieldSetClass="oclcw-pop-rating",i}(AdaptiveCards.Input);n.RatingInput=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(n){this.config=n}return t.prototype.canRenderPreChat=function(){return n.FeaturesManager.shouldShowPrechatScreen()&&this.config.isPreChatEnabled&&n.Utility.isSurveyValid(this.config.preChatSurvey)&&this.canRenderPreChatForProactiveChat()},t.prototype.canRenderPreChatForProactiveChat=function(){return n.Loader.currentConversation.isProactiveChat?n.Loader.isPreChatEnabledForProactiveChat:!0},t.prototype.shouldRenderPrechat=function(){return this.canRenderPreChat()&&!this.isPreChatResponseSubmitted()&&!(n.Loader.reconnectId&&n.Loader.reconnectId.trim())},t.prototype.isPreChatResponseSubmitted=function(){return!!n.Loader.initContext.preChatResponse},t.prototype.resetPreChat=function(){n.Loader.initContext.preChatResponse=null;n.ContextSpecificDataStore.RemoveData(n.DataContextTypes.UserWidgetOrganization,n.WidgetDataKeys.PreChatResponse)},t}();n.PrechatController=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.validate=function(t,i){i===void 0&&(i=null);var r=n.Util.isNullOrEmptyString(t)||!isNaN(t);return r||n.Util.isNullOrUndefined(i)||i.push(n.Loader.Locale.INVALID_DATA_TYPE_MESSAGE),r},t._instance=null,t}();n.NumericFieldValidator=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(n){this._isFirstPass=!0;this.enableSurveySubmit=n}return t.prototype.attachFieldValidators=function(t,i){if(t.isInteractive){t.onValueChanged=this.validateInput.bind(this);t.validators=[];try{var r=JSON.parse(i.id);t.ocId="i"+r.Id;t.getJsonTypeName()==="Input.Text"&&(i.isMultiline?t.validators.push(n.TextLengthValidator.MultilineInstance):t.validators.push(n.TextLengthValidator.SinglelineInstance));r.IsRequired===!1||r.IsOption===!0?t.isValid=!0:t.getJsonTypeName()=="Input.Toggle"?t.validators.push(n.RequiredBooleanFieldValidator.Instance):t.validators.push(n.RequiredFieldValidator.Instance)}catch(u){t.isValid=!0}}},t.prototype.canSubmitSurvey=function(n){this._isFirstPass=!1;var t=n.parent.getRootElement().getAllInputs();return this.reEvaluatePrechatForm(t)?!0:(t.forEach(function(n){n.onValueChanged(n)}),!1)},t.prototype.disableInputs=function(n){var t=n.parent.getRootElement().getAllInputs();t.forEach(function(n){n._renderedElement.disabled=!0})},t.prototype.cleanUp=function(){this._isFirstPass=!0},t.prototype.validateInput=function(t){var i=[];if(t.getJsonTypeName()==n.RatingInput.RatingType){t.isValid=!0;return}(t.isValid=t.validators.length>0?t.validators.every(function(n){return n.validate(t.value,i)}):!0,this._isFirstPass)||(t.isValid?t.renderedElement.classList.contains(n.Constants.HTMLConstants.error)&&(t.renderedElement.classList.remove(n.Constants.HTMLConstants.error),this.removeErrorMessages(t),this.reEvaluatePrechatForm(t.parent.getAllInputs())):(t.renderedElement.classList.add(n.Constants.HTMLConstants.error),this.renderErrorMessages(t,i),this.enableSurveySubmit(!1)))},t.prototype.reEvaluatePrechatForm=function(n){var t=n.every(function(n){return n.isValid===!0});return t?this.enableSurveySubmit(!0):this.enableSurveySubmit(!1),t},t.prototype.createErrorElement=function(t,i){var r=document.createElement("div");return r.classList.add(n.HtmlClassNames.errorContainer),r.innerHTML='\n                <span>\n                    <img src="'+n.ScriptPaths.ErrorImagePath+'"/>\n                <\/span>\n                <span class='+n.HtmlClassNames.errorText+'\n                    id="'+i+'">'+t+"<\/span>\n            ",r},t.prototype.renderErrorMessages=function(t,i){var f=this,u=document.querySelectorAll("."+n.HtmlClassNames.errorContainer+"."+t.ocId),r;if(u.length>0)for(r=0;r<u.length;r++)u[r].style.display=n.Constants.HTMLConstants.block;else i.forEach(function(i){var r=n.HtmlIdNames.errorElementId+t.index,u=f.createErrorElement(i,r);u.classList.add(t.ocId);t.renderedElement.parentNode.insertBefore(u,t.renderedElement.nextSibling);t.renderedElement.setAttribute(n.HtmlAttributeNames.ariaDesribedby,r)})},t.prototype.removeErrorMessages=function(t){for(var r=document.querySelectorAll("."+n.HtmlClassNames.errorContainer+"."+t.ocId),i=0;i<r.length;i++)r[i].parentNode.removeChild(r[i]),t.renderedElement.removeAttribute(n.HtmlAttributeNames.ariaDesribedby)},t.prototype.setFocusFirstErrorField=function(n){var t,i;if(n&&n.length>0)for(t=0;t<n.length;t++)if(i=n[t],!i.isValid){i.renderedElement.focus();break}},t}();n.SurveyValidator=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.validate=function(t,i){i===void 0&&(i=null);var r=!n.Util.isNullOrUndefined(t)&&t.trim&&!n.Util.isNullOrEmptyString(t.trim());return r||n.Util.isNullOrUndefined(i)||i.push(n.Loader.Locale.REQUIRED_FIELD_MISSING_MESSAGE),r},t._instance=null,t}();n.RequiredFieldValidator=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(n){this.maxLength=n}return Object.defineProperty(t,"MultilineInstance",{get:function(){return t.multilineInstance||(t.multilineInstance=new t(t.multilineMaxLength)),t.multilineInstance},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SinglelineInstance",{get:function(){return t.singlelineInstance||(t.singlelineInstance=new t(t.singlelineMaxLength)),t.singlelineInstance},enumerable:!0,configurable:!0}),t.prototype.validate=function(t,i){i===void 0&&(i=null);var r=(t||"").length<=this.maxLength;return r||n.Util.isNullOrUndefined(i)||i.push(n.Loader.Locale.MAX_TEXT_LENGTH_EXCEEDED_MESSAGE),r},t.multilineMaxLength=250,t.singlelineMaxLength=100,t}();n.TextLengthValidator=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.validate=function(t,i){var r=!n.Util.isNullOrUndefined(t)&&t.trim&&!n.Util.isNullOrEmptyString(t.trim())&&t.toLowerCase()!=="false";return r||n.Util.isNullOrUndefined(i)||i.push(n.Loader.Locale.REQUIRED_FIELD_MISSING_MESSAGE),r},t._instance=null,t}();n.RequiredBooleanFieldValidator=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t,i,r,u;(function(n){n[n.Pending=0]="Pending";n[n.Complete=1]="Complete"})(t=n.WidgetLoadingState||(n.WidgetLoadingState={})),function(n){n[n.NewChat=0]="NewChat";n[n.ExistingChat=1]="ExistingChat"}(i=n.ChatType||(n.ChatType={})),function(n){n[n.ChatNotStarted=0]="ChatNotStarted";n[n.ChatStarted=1]="ChatStarted"}(r=n.ChatState||(n.ChatState={})),function(n){n.Accept="accept";n.Reject="reject";n.Connect="connect";n.End="end"}(u=n.SecondaryChannelEvents||(n.SecondaryChannelEvents={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(){this.initializeLoader();t.Util.setAriaLiveAlert()}return i.startSessionInit=function(){return __awaiter(this,void 0,void 0,function(){var r=this,n;return __generator(this,function(){return n=new Promise(function(n,u){return __awaiter(r,void 0,void 0,function(){var e,r,s,h,f,o,c,l;return __generator(this,function(a){switch(a.label){case 0:return t.Utility.validateIfSessionInitIsStartedOrComplete(this.currentConversation)?(n(),[2]):(e=i.currentRequestId,t.Bootstrapper.debugInfo.addSessionInitRequestId(e),r=t.Util.timer(),s=function(){i.currentConversation.sessionInitState=t.SessionInitState.SessionInitComplete;i.currentConversation.portalContactId=i.initContext.portalcontactid;i.currentConversation.isChatComplete=!1;t.Util.setSessionKeys(i.currentConversation);t.Util.raiseCustomEvent(t.LCWEvents.LCWChatQueued);t.TelemetryClient.info({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.SessionInitSuccess});n()},h=function(n){!t.Util.isNullOrUndefined(n)&&n.response.headers.errorcode&&(i.currentConversation.sessionInitErrorCode=Number(n.response.headers.errorcode));t.Util.isNullOrUndefined(n)||n.response.status!==t.HTTPErrorCodes.Status403Forbidden&&n.response.status!==t.HTTPErrorCodes.Status413PayloadTooLarge||(i.currentConversation=new t.Conversation,i.currentRequestId=t.Util.newGuid());t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.SessionInitFailure,ExceptionDetails:n});u(n)},[4,this.populateContextData()]);case 1:if(a.sent(),i.initContext.isProactiveChat=i.currentConversation.isProactiveChat?i.currentConversation.isProactiveChat:!1,f={initContext:{locale:i.initContext.locale,originurl:i.initContext.originurl,preChatResponse:i.initContext.preChatResponse,customContextData:i.initContext.customContextData,portalcontactid:i.initContext.fetchPortalContactId(),latitude:i.initContext.latitude,longitude:i.initContext.longitude,isProactiveChat:i.initContext.isProactiveChat},getContext:!0,reconnectId:i.liveChatConfig.isReconnectEnabled?i.reconnectId:null},t.Util.isNullOrUndefined(i.currentConversation.chatId)||(f.initContext.chatId=i.currentConversation.chatId),!i.liveChatConfig.authClientFunction)return[3,6];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 3:return o=a.sent(),t.Util.isNullOrEmptyString(o)?(c=new Error("Received empty token"),t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:c}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,c)):(i.initContext.authenticatedUserToken=o,f.authenticatedUserToken=o,i.currentConversation.sessionInitState=t.SessionInitState.SessionInitStarted,t.OmnichannelProxy.getInstance().sessionInit(e,f).then(s,h)),[3,5];case 4:return l=a.sent(),t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed Auth SessionInit",Error:l}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,l),[3,5];case 5:return[3,7];case 6:t.OmnichannelProxy.getInstance().sessionInit(e,f).then(s,h);a.label=7;case 7:return i.currentConversation.isChatComplete=!1,[2]}})})}),[2,n]})})},i.getAgentAvailability=function(){return __awaiter(this,void 0,void 0,function(){var r=this,n;return __generator(this,function(){return n=new Promise(function(n,u){return __awaiter(r,void 0,void 0,function(){var e,h,o,r,s,f;return __generator(this,function(c){switch(c.label){case 0:return e=t.Util.timer(),h=t.Util.newGuid(),[4,this.populateContextData()];case 1:c.sent();t.TelemetryClient.info({Event:t.TelemetryEvent.GetAgentAvailabilityInitiated});o={initContext:{locale:i.initContext.locale,originurl:i.initContext.originurl,preChatResponse:i.initContext.preChatResponse,customContextData:i.initContext.customContextData,portalcontactid:i.initContext.fetchPortalContactId(),latitude:i.initContext.latitude,longitude:i.initContext.longitude,isProactiveChat:i.currentConversation.isProactiveChat?i.currentConversation.isProactiveChat:!1},getContext:!0};t.Util.isNullOrEmptyString(i.liveChatConfig.authClientFunction)&&u(t.Utility.getQueueAvailabilityErrorResponse("Agent availability is supported only for authenticated live chat widget",null));i.currentConversation&&i.currentConversation.sessionInitState&&i.currentConversation.sessionInitState==t.SessionInitState.SessionInitComplete&&u(t.Utility.getQueueAvailabilityErrorResponse("Get agent availability operation is invalid when session init is completed.",null));c.label=2;case 2:return c.trys.push([2,4,,5]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 3:return r=c.sent(),t.Util.isNullOrEmptyString(r)?(s=new Error("Received empty token"),t.TelemetryClient.error({ElapsedTimeInMilliseconds:e.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:s}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,s),u(t.Utility.getQueueAvailabilityErrorResponse("Received empty authentication token",null))):(i.initContext.authenticatedUserToken=r,o.authenticatedUserToken=r,t.OmnichannelProxy.getInstance().getAgentAvailability(h,o).then(function(t){return n(t)}).catch(function(n){return u(t.Utility.getQueueAvailabilityErrorResponse("Get agent availability failed",n))})),[3,5];case 4:return f=c.sent(),t.TelemetryClient.error({ElapsedTimeInMilliseconds:e.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed Auth get agent availability",Error:f}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AGENT_AVAILABILITY_FAIL,f),u(t.Utility.getQueueAvailabilityErrorResponse("Get agent availability failed",f)),[3,5];case 5:return[2]}})})}),[2,n]})})},i.populateContextData=function(){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(r){switch(r.label){case 0:return(t.Bootstrapper.isPopOutMode||t.Bootstrapper.isCustomPopOutMode)?[4,t.Util.getInitContextParamsForPopout(t.IframeMessages.initContextParamsRequest,t.IframeMessages.initContextParamsResponse)]:[3,2];case 1:return n=r.sent(),n&&(n.contextVariables&&t.ContextService.addCustomContextData(n.contextVariables),n.isProactiveChat&&(i.currentConversation.isProactiveChat=Boolean(n.isProactiveChat)),n.latitude&&n.longitude&&(i.initContext.latitude=n.latitude,i.initContext.longitude=n.longitude)),[3,3];case 2:t.ContextService.addCustomContextData(null);r.label=3;case 3:return[2]}})})},i.prototype.createLoaderPromise=function(){i.loaderPromise=new Promise(function(n,t){i.loaderPromiseResolver=n;i.loaderPromiseRejecter=t})},i.prototype.initializeLoader=function(){var r=this;t.Util.isNullOrUndefined(t.Bootstrapper.bootStrappingPromise)?setTimeout(function(){return r.initializeLoader()},t.ConfigurationManager.BootstrapperPromiseStateCheckInterval):(this.createLoaderPromise(),t.Bootstrapper.bootStrappingPromise.then(function(){i.Locale=n.Omnichannel.LiveChatWidget.Locale;i.liveChatConfig=t.Bootstrapper.LiveChatConfiguration;t.Bootstrapper.debugInfo.setWebChatVersion(t.ConfigurationManager.WebChatSdkVersion);t.Bootstrapper.debugInfo.setOcSdkVersion(t.ConfigurationManager.OmnichannelSdkVersion);r.initializeLiveChatWidget()}))},i.prototype.initializeLiveChatWidget=function(){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(){return[2,t.ContextService.setInitContext().then(function(){return t.Bootstrapper.debugInfo.addDebugButtonIfNotPresent()}).then(function(){return t.Bootstrapper.debugInfo.setDebugButtonDisplay()}).then(function(){return t.Bootstrapper.debugInfo.setRuntimeId(t.Bootstrapper.lcwRuntimeId)}).then(function(){return n.repositionIframe()}).then(function(){return n.injectRootComponent()}).then(function(){return i.loaderPromiseResolver()}).catch(function(){return i.loaderPromiseRejecter()}).then(function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return!t.Bootstrapper.isPopOutMode?[4,i.getLocation()]:[3,2];case 1:n.sent();n.label=2;case 2:return[2]}})})})]})})},i.prototype.repositionIframe=function(){i.liveChatConfig.chatButtonPosition===t.Constants.ChatButtonInitStyle.bottomLeftPosition&&t.FrameHandler.repositionFrame(window,t.WidgetPosition.bottomLeft);i.liveChatConfig.chatButtonPosition===t.Constants.ChatButtonInitStyle.bottomRightPosition&&t.FrameHandler.repositionFrame(window,t.WidgetPosition.bottomRight)},i.prototype.injectRootComponent=function(){var n=document.getElementById(t.HtmlIdNames.chatRootReactId);n||t.renderMain()},i.fetchChatToken=function(){var n=this;return new Promise(function(r,u){return __awaiter(n,void 0,void 0,function(){var n,f,o,c,l,e,s,h;return __generator(this,function(a){switch(a.label){case 0:if(n=t.Util.newGuid(),i.currentRequestId&&(n=i.currentRequestId),t.Bootstrapper.debugInfo.addGetChatTokenRequestId(n),f=t.Util.timer(),o={reconnectId:i.liveChatConfig.isReconnectEnabled?i.reconnectId:null,currentLiveChatVersion:i.liveChatConfig.liveChatVersionNumber},c=function(u){i.currentConversation.token=new t.Token;i.currentConversation.chatId=u.ChatId;i.currentConversation.token.chatToken=u.Token;i.currentConversation.token.expiresIn=u.ExpiresIn;i.currentConversation.token.visitorId=u.VisitorId;i.currentConversation.voiceVideoCallToken=u.VoiceVideoCallToken;i.currentConversation.currentRequestId=n;i.currentConversation.regionGtms=JSON.parse(u.RegionGtms);i.currentConversation.conversationStartTime=new Date;i.currentConversation.userId=u.VisitorId;i.currentConversation.attachmentConfiguration=u.AttachmentConfiguration;t.Util.isNullOrUndefined(u.ACSEndpoint)||(i.currentConversation.acsResourceEndpoint=u.ACSEndpoint);var e=t.ConfigurationManager.TokenRefreshTime;t.TelemetryClient.info({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.FetchChatTokenSuccess});r()},l=function(n){i.reconnectId!=null&&n&&n.status==204&&!t.Util.isNullOrEmptyString(i.liveChatConfig.reconnectRedirectionURL)?t.Util.redirectPage(i.liveChatConfig.reconnectRedirectionURL):t.TelemetryClient.error({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.FetchChatTokenFailure,ExceptionDetails:n});u(n)},!i.liveChatConfig.authClientFunction)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 2:return e=a.sent(),t.Util.isNullOrEmptyString(e)?(s=new Error("Received empty token"),t.TelemetryClient.error({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:s}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,s)):(i.initContext.authenticatedUserToken=e,o.authenticatedUserToken=e),[3,4];case 3:return h=a.sent(),t.TelemetryClient.error({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed at fetch Chat Token",Error:h}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,h),[3,4];case 4:return t.OmnichannelProxy.getInstance().getChatToken(n,o).then(c,l),[2]}})})})},i.getLWIDetails=function(){var n=this;return new Promise(function(r){return __awaiter(n,void 0,void 0,function(){var n,u,f;return __generator(this,function(e){switch(e.label){case 0:return n=function(n){i.conversationId=n.ConversationId!=null?n.ConversationId:null;i.surveyEnabledParticipantJoined=!t.Util.isNullOrUndefined(n.CanRenderPostChat)&&n.CanRenderPostChat===t.Constants.TruePascal;i.liveWorkItemState=n.State;i.participantType=!t.Util.isNullOrUndefined(n.ParticipantType)&&n.ParticipantType;r()},u=function(n){t.TelemetryClient.error({Event:t.TelemetryEvent.GetLWIDetailsFailed,ExceptionDetails:n});i.surveyEnabledParticipantJoined=!0;r()},[4,i.getOptionParamForgetLWIDetails()];case 1:return f=e.sent(),t.OmnichannelProxy.getInstance().getLWIDetails(i.currentRequestId,f).then(n,u),[2]}})})})},i.getOptionParamForgetLWIDetails=function(){return __awaiter(this,void 0,void 0,function(){var n,r,u,f;return __generator(this,function(e){switch(e.label){case 0:if(n={reconnectId:i.liveChatConfig.isReconnectEnabled?i.reconnectId:null},!i.liveChatConfig.authClientFunction)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 2:return r=e.sent(),t.Util.isNullOrEmptyString(r)?(u=new Error("Received empty token"),t.TelemetryClient.error({Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:u}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,u)):n.authenticatedUserToken=r,[3,4];case 3:return f=e.sent(),t.TelemetryClient.info({Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed at getOptionParamForgetLWIDetails",Error:f}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,f),[3,4];case 4:return[2,n]}})})},i.sendSessionCloseEvent=function(n){var r=this,u=new Promise(function(u){return __awaiter(r,void 0,void 0,function(){var r,o,f,e,s,h,c,l,a;return __generator(this,function(v){switch(v.label){case 0:if(r=t.Util.timer(),o=i.reconnectId!=null,f={isReconnectChat:o,isPersistentChat:i.liveChatConfig.isPersistentChat},t.Util.isNullOrUndefined(i.currentConversation.chatId)||(f.chatId=i.currentConversation.chatId),e=o?i.reconnectId:n.currentRequestId,t.Bootstrapper.debugInfo.addSessionCloseRequestId(e),s=function(){t.TelemetryClient.info({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.SessionCloseSuccess});u()},h=function(n){t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.SessionCloseFailure,ExceptionDetails:n})},!i.liveChatConfig.authClientFunction)return[3,5];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 2:return c=v.sent(),t.Util.isNullOrEmptyString(c)?(l=new Error("Received empty token"),t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:l}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,l)):(f.authenticatedUserToken=c,t.OmnichannelProxy.getInstance().sessionClose(e,f).then(s,h)),[3,4];case 3:return a=v.sent(),t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed at SessionClose",Error:a}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,a),[3,4];case 4:return[3,6];case 5:t.OmnichannelProxy.getInstance().sessionClose(e,f).then(s,h);v.label=6;case 6:return[2]}})})});return t.AuthManager.clearAuthToken(),u},i.validateAuthChatRecord=function(n){var r=this;return new Promise(function(u){return __awaiter(r,void 0,void 0,function(){var r,f,h,c,l,e,o,s;return __generator(this,function(a){switch(a.label){case 0:if(r=t.Util.timer(),f={},t.Util.isNullOrUndefined(i.currentConversation)||t.Util.isNullOrUndefined(i.currentConversation.chatId)||(f.chatId=i.currentConversation.chatId),h=n.currentRequestId,c=function(){t.TelemetryClient.info({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.ValidateAuthChatRecordSuccess});u(!0)},l=function(n){t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.ValidateAuthChatRecordFailed,ExceptionDetails:n});u(!1)},!i.liveChatConfig.authClientFunction)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 2:return e=a.sent(),t.Util.isNullOrEmptyString(e)?(o=new Error("Received empty token"),t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:o}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,o),u(!1)):(f.authenticatedUserToken=e,t.OmnichannelProxy.getInstance().validateAuthChatRecord(h,f).then(c,l)),[3,4];case 3:return s=a.sent(),t.TelemetryClient.error({ElapsedTimeInMilliseconds:r.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed at ValidateAuthChatRecordFailed",Error:s}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,s),[3,4];case 4:return[3,6];case 5:u(!0);a.label=6;case 6:return[2]}})})})},i.getLocation=function(){return __awaiter(this,void 0,void 0,function(){var r,n;return __generator(this,function(u){switch(u.label){case 0:return(r=t.LocationInfo.requestLocationDetection(),!r)?[3,2]:[4,t.LocationInfo.getLocationInfo()];case 1:return n=u.sent(),i.initContext.latitude=n.latitude.toString(),i.initContext.longitude=n.longitude.toString(),[3,3];case 2:i.initContext.latitude="";i.initContext.longitude="";u.label=3;case 3:return[2]}})})},i.handleSecondaryChannelEvent=function(n,r){if(!t.Util.isNullOrUndefined(i.currentConversation.currentRequestId)){var f=i.currentConversation,u=new t.SecondaryChannelEventBody;u.SecondaryChannelType=n;u.SecondaryChannelEventType=r;i.secondaryChannelEvent(f,u)}},i.secondaryChannelEvent=function(n,r){var f=this,u=null;return new Promise(function(e){return __awaiter(f,void 0,void 0,function(){var f,o,s,h,c,l;return __generator(this,function(a){switch(a.label){case 0:if(f=t.Util.timer(),t.Bootstrapper.debugInfo.addSecondaryChannelEventRequestId(n.currentRequestId),o=function(){t.TelemetryClient.info({Event:t.TelemetryEvent.SecondaryChannelEventSuccess,ElapsedTimeInMilliseconds:f.milliSecondsElapsed});e()},s=function(n){t.TelemetryClient.error({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.SecondaryChannelEventFailure,ExceptionDetails:n})},!i.liveChatConfig.authClientFunction)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.AuthManager.acquireTokenFromAuthMethod()];case 2:return h=a.sent(),t.Util.isNullOrEmptyString(h)?(c=new Error("Received empty token"),t.TelemetryClient.error({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientEmptyTokenException,ExceptionDetails:{Error:c}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,c)):(u=h,t.OmnichannelProxy.getInstance().makeSecondaryChannelEventRequest(n.currentRequestId,r,u).then(o,s)),[3,4];case 3:return l=a.sent(),t.TelemetryClient.error({ElapsedTimeInMilliseconds:f.milliSecondsElapsed,Event:t.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed at Send Secondary Channel Event",Error:l}}),t.LCWErrorTypes.raiseErrorEvent(t.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,l),[3,4];case 4:return[3,6];case 5:t.OmnichannelProxy.getInstance().makeSecondaryChannelEventRequest(n.currentRequestId,r).then(o,s);a.label=6;case 6:return[2]}})})})},i.liveChatConfig=null,i.currentConversation=new t.Conversation,i.surveyEnabledParticipantJoined=!1,i.participantType=null,i.liveWorkItemState=null,i.agentAcceptedOn=null,i.conversationId=null,i.isPreChatEnabledForProactiveChat=!0,i.getChatTokenPromise=null,i.sessionInitPromise=null,i.proactiveChatNotificationConfig=null,i.loaderPromise=null,i}();t.Loader=i})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={}));window.isMock||function(){new Microsoft.Omnichannel.LiveChatWidget.Loader}("docReady",window),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.raiseMessageEvent=function(t,i){var u,r;if(t.type===n.AdapterActivityType.Message)if(u=t,r={text:"",id:u.id,type:u.type,timestamp:u.timestamp,chatId:n.Loader.currentConversation.chatId,userId:n.Loader.currentConversation.userId,isChatComplete:n.Loader.currentConversation.isChatComplete,conversationId:n.Loader.conversationId,channelData:t.channelData,messageType:""},t.from.role===n.Constants.UserMessageTag)i?window.opener.parent.postMessage({messageName:n.LCWEvents.LCWOnPopoutMessageSent},"*"):n.Util.raiseCustomEvent(n.LCWEvents.LCWOnMessageSent);else if(t.channelData.tags&&t.channelData.tags.includes(n.Constants.SystemMessageTag))i?window.opener.parent.postMessage({messageName:n.LCWEvents.LCWOnPopoutMessageReceived,payload:{messageType:n.Constants.SystemMessageTag}},"*"):(r.text=u.text,r.messageType=n.Constants.SystemMessageTag,n.Util.raiseCustomEvent(n.LCWEvents.LCWOnMessageReceived,r));else{var f=t,e=!f.text,o=!t.channelData||!t.channelData.tags||t.channelData.tags.length===0,s=!f.attachments||f.attachments.length===0;if(o&&e&&s)return;i?window.opener.parent.postMessage({messageName:n.LCWEvents.LCWOnPopoutMessageReceived,payload:{messageType:n.Constants.UserMessageTag}},"*"):(r.messageType=n.Constants.UserMessageTag,n.Util.raiseCustomEvent(n.LCWEvents.LCWOnMessageReceived,r))}},t}();n.NewMessageEventHandler=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.decodeHtmlCharacters=function(i){try{i=i.trim();i=t.decodeHtmlCharactersHelper(i)}catch(r){var u={Event:"Failed to decode html characters",ExceptionDetails:r};n.TelemetryClient.error(u)}return i},t.decodeHtmlCharactersHelper=function(n){return n.replace(/&amp;/g,t.amp).replace(/&lt;/g,t.lt).replace(/&gt;/g,t.gt).replace(/&#43;/g,t.plus).replace(/&#45;/g,t.minus).replace(/&#x2F;/g,t.slash).replace(/&quot;/g,t.quot)},t.amp="&",t.lt="<",t.gt=">",t.plus="+",t.minus="-",t.slash="/",t.quot='"',t}();n.MarkdownUtil=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.acquireTokenFromAuthMethod=function(){return __awaiter(this,void 0,void 0,function(){var r,i,u;return __generator(this,function(f){switch(f.label){case 0:if(!n.Util.isNullOrEmptyString(n.Bootstrapper.authToken))if(this.isCachedJWTTokenExpired())t.clearAuthToken();else return[2,n.Bootstrapper.authToken];return(i=n.Loader.authTokenProvider,i)?[3,2]:[4,t.getAuthTokenMethodFromString(n.Loader.liveChatConfig.authClientFunction)];case 1:i=f.sent();f.label=2;case 2:if(r=i,r)try{r(function(i){if(n.Util.isNullOrEmptyString(i)){t.clearAuthToken();var r=new Error("Received empty token");n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_AUTHTOKENPROVIDER_NO_TOKEN_RECEIVED,r)}else return n.Bootstrapper.authToken=i,n.Bootstrapper.jwtSubId=t.getSubFromJWTToken(i),n.Bootstrapper.jwtExp=t.getExpFromJWTToken(i),i})}catch(e){t.clearAuthToken();n.TelemetryClient.error({Event:n.TelemetryEvent.AuthClientMethodException,ExceptionDetails:e});n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,e)}else t.clearAuthToken(),u=new Error("Undefined method found for LivechatConfig"),n.TelemetryClient.error({Event:n.TelemetryEvent.InvalidAuthClientMethod,ExceptionDetails:{ErrorDetails:u}}),n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_AUTHTOKENPROVIDER_METHOD_FAIL,u);return[2,n.Bootstrapper.authToken]}})})},t.isCachedJWTTokenExpired=function(){var t=Date.now()/1e3+n.Bootstrapper.timeDifference;return n.Bootstrapper.jwtExp<t-n.Constants.AuthTokenExpiryBufferTimeInSeconds},t.getSubFromJWTToken=function(t){try{var i=JSON.parse(atob(t.split(".")[1]));return i.sub}catch(r){return n.TelemetryClient.warn({Event:n.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed when parsing and retrieving jwt sub",Error:r}}),null}},t.getExpFromJWTToken=function(t){try{var i=JSON.parse(atob(t.split(".")[1]));return i.exp}catch(r){return n.TelemetryClient.warn({Event:n.TelemetryEvent.AuthClientMethodException,ExceptionDetails:{ErrorDescription:"Failed when parsing and retrieving jwt exp",Error:r}}),null}},t.isAuthFunctionSucceeded=function(){var t=n.Bootstrapper.authToken;return!n.Util.isNullOrEmptyString(t)},t.clearAuthToken=function(){n.Bootstrapper.authToken=""},t.getAuthTokenMethodFromString=function(i){return __awaiter(this,void 0,void 0,function(){var r,u,f,e;return __generator(this,function(o){switch(o.label){case 0:return n.Bootstrapper.isPopOutMode?n.Bootstrapper.isCustomPopOutMode?window.opener?[4,t.getAuthTokenOrAuthMethodFromOuterScope(window.opener,n.IframeMessages.authTokenRequest,i)]:[3,2]:[3,4]:[3,9];case 1:return u=o.sent(),[3,3];case 2:u=null;o.label=3;case 3:return r=u,[3,8];case 4:return window.opener.parent?[4,t.getAuthTokenOrAuthMethodFromOuterScope(window.opener.parent,n.IframeMessages.authTokenRequest,i)]:[3,6];case 5:return f=o.sent(),[3,7];case 6:f=null;o.label=7;case 7:r=f;o.label=8;case 8:return[3,13];case 9:return window.parent?[4,t.getAuthTokenOrAuthMethodFromOuterScope(window.parent,n.IframeMessages.authTokenRequest,i)]:[3,11];case 10:return e=o.sent(),[3,12];case 11:e=null;o.label=12;case 12:r=e;o.label=13;case 13:return[2,r]}})})},t.getAuthTokenOrAuthMethodFromOuterScope=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,e,o,u,s;return __generator(this,function(h){switch(h.label){case 0:return o=new Promise(function(t,i){e=t;setTimeout(function(){return i(n.Constants.AuthFunctionFailureString)},n.Constants.AuthFunctionTimeout)}).catch(function(t){var i={Event:n.TelemetryEvent.GetAuthTokenFromOuterScope,ExceptionDetails:t};n.TelemetryClient.error(i);n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_CHAT_WIDGET_GET_AUTH_TOKEN_FROM_OUTER_SCOPE_FAILED,i)}),u=function(t){t.data&&t.data.messageName==n.IframeMessages.authTokenResponse&&(f=function(n){n(t.data.authToken)},e())},window.addEventListener("message",u,!1),s={messageName:i,functionFullName:r},t.postMessage(s,"*"),[4,o];case 1:return h.sent(),window.removeEventListener("message",u,!1),[2,f]}})})},t}();n.AuthManager=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.componentDidMount=function(){this.addListeners(window)},i.prototype.componentWillUnmount=function(){this.removeListeners(window)},i.addKeyHandler=function(n){i.keyHandlers||(i.keyHandlers=[]);i.keyHandlers.indexOf(n)<0&&i.keyHandlers.push(n)},i.removeKeyHandler=function(n){if(i.keyHandlers){var t=i.keyHandlers.indexOf(n);t>=0&&i.keyHandlers.splice(t,1)}},i.prototype.addListeners=function(t){t&&t.addEventListener&&t.addEventListener(n.HtmlEventNames.keydown,this.handleKeydown)},i.prototype.removeListeners=function(t){t&&t.addEventListener&&t.removeEventListener(n.HtmlEventNames.keydown,this.handleKeydown)},i.prototype.handleKeydown=function(n){var t,r,u;if(i.keyHandlers&&i.keyHandlers.length!=0)for(t=0,r=i.keyHandlers;t<r.length;t++)u=r[t],u(n)},i.prototype.render=function(){return null},i}(React.Component);n.WebChatKeyboardListeners=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){function t(n,t){ReactDOM.render(n,t)}n.ReactRender=t})(t=n.Render||(n.Render={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.createResizeMessage=function(t){return{messageName:n.IFrameValues.resizeMSLcwIframe,id:n.HtmlIdNames.MicrosoftOmnichannelLCWidgetChatIframePageId,className:t}},t.createRepositionMessage=function(t){return{messageName:n.IFrameValues.repositionMSLcwIframe,id:n.HtmlIdNames.MicrosoftOmnichannelLCWidgetChatIframePageId,position:t}},t.getResizeClassName=function(t){var i=n.IFrameValues.defaultClassName;return n.Util.isNullOrEmptyString(t)||(i=t),i},t.resizeFrame=function(t,i){if(n.Util.isNullOrUndefined(t)||n.Util.isNullOrEmptyString(i)){console.error("Failed to resize parent window; invalid parameters: ",t);return}var r=t.parent,u=this.getResizeClassName(i);r?r.postMessage(this.createResizeMessage(u),"*"):console.error("Failed to find parent window during resizeFrame! ",r)},t.repositionFrame=function(t,i){if(n.Util.isNullOrUndefined(t)||i===null){console.error("Failed to reposition parent window; invalid parameters: ",t);return}var r=t.parent;r?r.postMessage(this.createRepositionMessage(i),"*"):console.error("Failed to find parent window during repositionFrame! ",r)},t.setToDefaultSize=function(t){this.resizeFrame(t,n.IFrameValues.webChatPanel)},t}();n.FrameHandler=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getFileAttachmentIconData=function(n){var i=n.startsWith(".")?n.slice(1):n||"",r=t.FileAttachmentIconMap[i.toLowerCase()]||t.BlankIcon;return{icon:r}},t.isInlineMediaSupported=function(i){switch(n.BrowserInfo.getBrowserName()){case n.BrowserVendor.CHROME:case n.BrowserVendor.OPERA:return t.chromeSupportedInlineMediaRegex.test(i);case n.BrowserVendor.FIREFOX:return t.firefoxSupportedInlineMediaRegex.test(i);case n.BrowserVendor.IE:return t.ieSupportedInlineMediaRegex.test(i);case n.BrowserVendor.EDGE:return n.BrowserInfo.isChromiumEdge()&&t.chromeSupportedInlineMediaRegex.test(i);default:return!1}},t.imageRegex=/(\.)(jpeg|jpg|jiff|png|gif|bmp)$/i,t.audioMediaRegex=/(\.)(aac|aiff|alac|flac|mp2|mp3|pcm|wav|wma)$/i,t.videoMediaRegex=/(\.)(avchd|avi|flv|mpe|mpeg|mpg|mpv|mp4|m4p|m4v|mov|qt|swf|webm|wmv)$/i,t.chromeSupportedInlineMediaRegex=/(\.)(aac|mp3|wav|mp4)$/i,t.firefoxSupportedInlineMediaRegex=/(\.)(aac|flac|mp3|wav|mp4|mov)$/i,t.ieSupportedInlineMediaRegex=/(\.)(mp3|mp4)$/i,t.ArchiveIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M1792 0q27 0 50 10t40 27 28 41 10 50v480q0 45-9 77t-24 58-31 46-31 40-23 44-10 55v992q0 27-10 50t-27 40-41 28-50 10H256V0h1536zM640 128v384h256V128H640zm1024 800q0-31-9-54t-24-44-31-41-31-45-23-58-10-78V128h-512v512H768v128H640V640H512V128H384v1792h384v-128h128v128h768V928zm128-800h-128v480q0 24 4 42t13 33 20 29 27 32q15-17 26-31t20-30 13-33 5-42V128zM640 896h128v128H640V896zm0 256h128v128H640v-128zm0 256h128v128H640v-128zm128 256v128H640v-128h128zm0-768V768h128v128H768zm0 256v-128h128v128H768zm0 256v-128h128v128H768zm0 256v-128h128v128H768z"})),t.AudioIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M1792 1408q0 62-29 109t-76 80-104 50-111 17q-54 0-111-17t-103-49-76-80-30-110q0-61 29-109t76-80 104-50 111-17q51 0 100 12t92 39V226L768 450v1214q0 62-29 109t-76 80-104 50-111 17q-54 0-111-17t-103-49-76-80-30-110q0-61 29-109t76-80 104-50 111-17q51 0 100 12t92 39V350L1792 62v1346z"})),t.BlankIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M549 0h1243v1755l-293 293H256V293L549 0zm1115 1701V128H603L384 347v1573h1061l219-219z"})),t.ExcelIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M2048 475v1445q0 27-10 50t-27 40-41 28-50 10H640q-27 0-50-10t-40-27-28-41-10-50v-256H115q-24 0-44-9t-37-25-25-36-9-45V627q0-24 9-44t25-37 36-25 45-9h397V128q0-27 10-50t27-40 41-28 50-10h933q26 0 49 9t42 28l347 347q18 18 27 41t10 50zm-384-256v165h165l-165-165zM261 1424h189q2-4 12-23t25-45 29-55 29-53 23-41 10-17q27 59 60 118t65 116h187l-209-339 205-333H707q-31 57-60 114t-63 112q-29-57-57-113t-57-113H279l199 335-217 337zm379 496h1280V512h-256q-27 0-50-10t-40-27-28-41-10-50V128H640v384h397q24 0 44 9t37 25 25 36 9 45v922q0 24-9 44t-25 37-36 25-45 9H640v256zm640-1024V768h512v128h-512zm0 256v-128h512v128h-512zm0 256v-128h512v128h-512z"})),t.ImageIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M256 1920h1536v128H128V0h1115l549 549v91h-640V128H256v1792zM1280 512h293l-293-293v293zm768 256v1024H640V768h1408zM768 896v421l320-319 416 416 160-160 256 256V896H768zm987 768h139l-230-230-69 70 160 160zm-987 0h805l-485-486-320 321v165zm960-512q-26 0-45-19t-19-45q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19z"})),t.OneNoteIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M1963 128q35 0 60 25t25 60v1622q0 35-25 60t-60 25H597q-35 0-60-25t-25-60v-299H85q-35 0-60-25t-25-60V597q0-35 25-60t60-25h427V213q0-35 25-60t60-25h1366zM389 939l242 420h152V689H635v429L402 689H241v670h148V939zm1531 853v-256h-256v256h256zm0-384v-256h-256v256h256zm0-384V768h-256v256h256zm0-384V256H640v256h299q35 0 60 25t25 60v854q0 35-25 60t-60 25H640v256h896V640h384z"})),t.PDFIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M1920 1664h-128v384H128v-384H0V640h128V0h1243l421 421v219h128v1024zM1408 384h165l-165-165v165zM256 640h1408V512h-384V128H256v512zm1408 1024H256v256h1408v-256zm128-896H128v768h1664V768zM448 896q40 0 75 15t61 41 41 61 15 75q0 40-15 75t-41 61-61 41-75 15h-64v128H256V896h192zm0 256q26 0 45-19t19-45q0-26-19-45t-45-19h-64v128h64zm448-256q53 0 99 20t82 55 55 81 20 100q0 53-20 99t-55 82-81 55-100 20H768V896h128zm0 384q27 0 50-10t40-27 28-41 10-50q0-27-10-50t-27-40-41-28-50-10v256zm384-384h320v128h-192v128h192v128h-192v128h-128V896z"})),t.PowerpointIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M2048 475v1445q0 27-10 50t-27 40-41 28-50 10H640q-27 0-50-10t-40-27-28-41-10-50v-256H115q-24 0-44-9t-37-25-25-36-9-45V627q0-24 9-44t25-37 36-25 45-9h397V128q0-27 10-50t27-40 41-28 50-10h933q26 0 49 9t42 28l347 347q18 18 27 41t10 50zm-384-256v165h165l-165-165zM368 752v672h150v-226h100q52 0 97-15t78-46 53-72 20-97q0-56-17-97t-50-67-76-39-97-13H368zm1552 1168V512h-256q-27 0-50-10t-40-27-28-41-10-50V128H640v384h397q24 0 44 9t37 25 25 36 9 45v922q0 24-9 44t-25 37-36 25-45 9H640v256h1280zM1536 640q79 0 149 30t122 82 83 123 30 149h-384V640zm-128 128v384h384q0 80-30 149t-82 122-123 83-149 30q-33 0-65-6t-63-18V792q31-11 63-17t65-7zm-804 300h-86V883h90q47 0 74 20t27 70q0 52-28 73t-77 22z"})),t.VideoIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M0 256h2048v1408H0V256zm256 1280v-128H128v128h128zm0-256v-128H128v128h128zm0-256V896H128v128h128zm0-256V640H128v128h128zm0-256V384H128v128h128zm1408 786V384H384v823l411-549 741 878-329-558 137-137 320 457zm256 238v-128h-128v128h128zm0-256v-128h-128v128h128zm0-256V896h-128v128h128zm0-256V640h-128v128h128zm0-256V384h-128v128h128z"})),t.VisioIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M2048 475v1445q0 27-10 50t-27 40-41 28-50 10H640q-27 0-50-10t-40-27-28-41-10-50v-256H115q-24 0-44-9t-37-25-25-36-9-45V627q0-24 9-44t25-37 36-25 45-9h397V128q0-27 10-50t27-40 41-28 50-10h933q26 0 49 9t42 28l347 347q18 18 27 41t10 50zm-384-256v165h165l-165-165zM493 1424h163l255-672H745l-147 427q-5 16-10 31t-11 31q-41-123-82-244t-84-245H241l248 662 4 10zm147 496h1280V512h-256q-27 0-50-10t-40-27-28-41-10-50V128H640v384h397q24 0 44 9t37 25 25 36 9 45v922q0 24-9 44t-25 37-36 25-45 9H640v256zm960-1280l192 192-128 128v448h-256v128h-128v-384h128v128h128V960l-128-128 192-192z"})),t.WordIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048",width:n.Constants.AttachmentIconStyle.iconSize,height:n.Constants.AttachmentIconStyle.iconSize},React.createElement("path",{d:"M2048 475v1445q0 27-10 50t-27 40-41 28-50 10H640q-27 0-50-10t-40-27-28-41-10-50v-256H115q-24 0-44-9t-37-25-25-36-9-45V627q0-24 9-44t25-37 36-25 45-9h397V128q0-27 10-50t27-40 41-28 50-10h933q26 0 49 9t42 28l347 347q18 18 27 41t10 50zm-384-256v165h165l-165-165zM320 1424h161q2-8 9-43t18-83 21-103 22-101 16-76 8-31l7 30q7 30 17 77t23 100 23 103 19 84 10 43h160l148-672H834l-80 438-100-438H502l-96 440-86-440H170l150 672zm320 496h1280V512h-256q-27 0-50-10t-40-27-28-41-10-50V128H640v384h397q24 0 44 9t37 25 25 36 9 45v922q0 24-9 44t-25 37-36 25-45 9H640v256zm640-1024V768h512v128h-512zm0 256v-128h512v128h-512zm0 256v-128h512v128h-512z"})),t.FileAttachmentIconMap={aac:t.AudioIcon,aiff:t.AudioIcon,alac:t.AudioIcon,avchd:t.VideoIcon,avi:t.VideoIcon,bmp:t.ImageIcon,doc:t.WordIcon,docx:t.WordIcon,flac:t.AudioIcon,flv:t.VideoIcon,gif:t.ImageIcon,jiff:t.ImageIcon,jpeg:t.ImageIcon,jpg:t.ImageIcon,mpe:t.VideoIcon,mpeg:t.VideoIcon,mpg:t.VideoIcon,mpv:t.VideoIcon,mp2:t.AudioIcon,mp3:t.AudioIcon,mp4:t.VideoIcon,m4p:t.VideoIcon,m4v:t.VideoIcon,mov:t.VideoIcon,one:t.OneNoteIcon,pcm:t.AudioIcon,pdf:t.PDFIcon,png:t.ImageIcon,ppt:t.PowerpointIcon,pptx:t.PowerpointIcon,qt:t.VideoIcon,rar:t.ArchiveIcon,swf:t.VideoIcon,tar:t.ArchiveIcon,"tar.gz":t.ArchiveIcon,tgz:t.ArchiveIcon,txt:t.BlankIcon,vsd:t.VisioIcon,vsdx:t.VisioIcon,wav:t.AudioIcon,webm:t.VideoIcon,wma:t.AudioIcon,wmv:t.VideoIcon,xls:t.ExcelIcon,xlsx:t.ExcelIcon,zip:t.ArchiveIcon,zipx:t.ArchiveIcon,"7z":t.ArchiveIcon},t}();n.FileAttachmentIconManager=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.logChatWidgetLoadTime=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.WebChatLoaded,ElapsedTimeInMilliseconds:t})},t.logPrechatWidgetLoadTime=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.PrechatWidgetLoaded,ElapsedTimeInMilliseconds:t})},t.logPostchatWidgetLoadTime=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.PostchatWidgetLoaded,ElapsedTimeInMilliseconds:t})},t.logIncomingProactiveChatLoadTime=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.IncomingProactiveChatScreenLoaded,ElapsedTimeInMilliseconds:t})},t.logProactiveChatCloseTimeAfterReject=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.ProactiveChatRejected,ElapsedTimeInMilliseconds:t})},t.logProactiveChatCloseTimeAfterTimeout=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.ProactiveChatInvitationTimedOut,ElapsedTimeInMilliseconds:t})},t}();n.LogHelper=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var e=function(){function n(){}return n.Script="script",n.Scripts="/scripts/",n.WebChatVersionScripts="/WebChatControl/scripts/",n.Lib="/lib/",n.Head="head",n.Body="body",n.Meta="meta",n.Viewport="viewport",n.ViewportMetaContent="width=device-width, initial-scale=1.0, maximum-scale=1",n.HostName="hostname",n.SRC="src",n.ID="id",n.Html="html",n.Iframe="iframe",n.ALLOW="allow",n.AllowFullScreen="allowfullscreen",n.WebKitAllowFullScreen="webkitallowfullscreen",n.MozillaAllowFullScreen="mozallowfullscreen",n.DataLcwVersion="data-lcw-version",n.ScriptSelector="script#",n.MicrosoftOmnichannelLCWidget="Microsoft_Omnichannel_LCWidget",n.JavascriptFlag="text/javascript",n.InitializerScriptDownloadTriggeredFlag="isOmniChannelBootstrapperWebChatDownloadTriggered",n.InitializerScriptPath="LiveChatWidgetScripts.min.js",n.LibsScriptPath="LiveChatWidgetLibs.min.js",n.MicrosoftOmnichannelLCWidgetChatIframePageId="Microsoft_Omnichannel_LCWidget_Chat_Iframe_Window",n.MicrosoftOmnichannelLCWidgetChatIframePageStyleId="Microsoft_Omnichannel_LCWidget_Chat_Iframe_Style",n.AllowValues="microphone *; camera *; geolocation *; autoplay;",n.DataAppId="data-app-id",n.DataOrgUrl="data-org-url",n.DataOrgId="data-org-id",n.ReconnectId="oc.reconnectid",n.DisableTelemetry="data-disable-telemetry",n.OpenChatInPopOutWindow="data-open-in-window",n.SuggestedActionLayout="data-suggested-action-layout",n.HideMinimizeButton="data-hide-minimize-button",n.EnableCustomCloseButtonText="data-custom-close-button-text",n.URLDelimiter="&",n.EndURLSeparator="?",n.ChatHTMLPath="/htmls/chat.html",n.Equal="=",n.Class="class",n.Style="style",n.Link="link",n.Href="href",n.Rel="rel",n.StyleSheet="stylesheet",n.Type="type",n.TextCss="text/css",n.Title="title",n.LiveChatWidgetHideChatButton="data-hide-chat-button",n.RenderOnMobileDevice="data-render-mobile",n.WidgetFontFamily="data-font-family-override",n.WidgetThemeColor="data-color-override",n.SDK="SDK",n.Return="return",n.SPACE=" ",n.Microsoft="Microsoft",n.Dynamic365="Dynamic365",n.Portal="Portal",n.User="User",n.ScriptBootstrapperPath="scripts/LiveChatBootstrapper.js",n.FrameStyleCssPath="WebChatControl/styles/LiveChatWidgetFrame.css",n.FrameAutofillStyleCssPath="WebChatControl/styles/LCWAutofillFrame.min.css",n.EnableAutofill="data-enable-lcw-autofill",n.BypassCache="data-bypass-cache",n.PopoutTarget="Omnichannel Chat",n.PopoutTab="popOutTab",n.Undefined="undefined",n.ContactId="contactId",n.EnableNewLineMarkdownSupport="data-enable-newline",n.EnableMakrdownMessageFormatting="data-enable-markdown",n}(),t,i,r,u,f,o;n.BootstrapperConstants=e;t=function(){function n(){}return n.Transparent="transparent",n.BackgroundColor="background-color",n.FrameBorder="frameBorder",n.AllowTransparency="allowTransparency",n.BorderWidth="border-width",n.ZIndex="z-index",n.Position="position",n.Right="right",n.Bottom="bottom",n.None="none",n}();n.StyleConstants=t;i=function(){function n(){}return n.FrameBorderWidth="0px",n.AllowTransparency=!0,n.IFramePosition="fixed",n.IFrameBackgroundColor="transparent",n.IFrameZIndex="999999",n}();n.DefaultCssValues=i;r=function(){function n(){}return n.message="message",n.keydown="keydown",n.setContextProvider="setContextProvider",n.getContextProvider="getContextProvider",n.removeContextProvider="removeContextProvider",n.setAuthTokenProvider="setAuthTokenProvider",n.getAuthTokenProvider="getAuthTokenProvider",n.removeAuthTokenProvider="removeAuthTokenProvider",n.getContactInfoRequest="getContactInfoRequest",n.getContactInfoResponse="getContactInfoResponse",n.LcwReady="lcw:ready",n.getAgentAvailabilityFinished="lcw:getAgentAvailability",n.LcwStartChat="lcw:startChat",n.LcwCloseChat="lcw:closeChat",n.lcwMinimizeChat="lcw:onMinimize",n.lcwOnMaximize="lcw:onMaximize",n.lcwOnClose="lcw:onClose",n.lcwOnPopoutClose="lcw:onPopoutClose",n.lcwOnMessageReceived="lcw:onMessageReceived",n.lcwOnPopoutMessageReceived="lcw:onPopoutMessageReceived",n.lcwOnMessageSent="lcw:onMessageSent",n.lcwOnPopoutMessageSent="lcw:onPopoutMessageSent",n.LcwThreadUpdate="lcw:threadUpdate",n.LcwChatQueued="lcw:chatQueued",n.LcwChatRetrieved="lcw:chatRetrieved",n.LcwError="lcw:error",n.startChat="startChat",n.startPopoutChat="startPopoutChat",n.startPopoutChatResponse="startPopoutChatResponse",n.closePopoutChatMessage="closePopoutChatMessage",n.closeChat="closeChat",n.getAgentAvailability="getAgentAvailability",n.startProactiveChat="startProactiveChat",n.CustomEvent="CustomEvent",n.LcwChangeTitle="changeTitle",n.audioEnded="ended",n.audioPlayError="error",n.LogTelemetry="logTelemetry",n}();n.EventConstants=r;u=function(){function n(){}return n.resizeMSLcwIframe="resizeMSLcwIframe",n.authTokenRequest="authTokenRequest",n.authTokenResponse="authTokenResponse",n.initContextParamsRequest="initContextParamsRequest",n.initContextParamsResponse="initContextParamsResponse",n.portalContactIdRequest="portalContactIdRequest",n.portalContactIdResponse="portalContactIdResponse",n.closePopoutChatMessage="closePopoutChatMessage",n.removeKeyboardEventHandler="removeKeyboardEventHandler",n.repositionMSLcwIframe="repositionMSLcwIframe",n.webChatPanel="web_chat_panel",n.ocAutofillFrame="oc_autofill_iframe",n.bottomLeft="BottomLeft",n.bottomRight="BottomRight",n.hideIframe="hide_iframe",n.proactiveChatPanel="proactive_chat_panel",n.startChatButton="start_chat_button",n.defaultClassName=[n.webChatPanel,n.hideIframe],n.handleControlSlash="handleControlSlash",n.KEY_SLASH=191,n.iFrameTitle="Microsoft Omnichannel Live Chat Widget",n.inAppClassName="inApp",n.redirectPageRequest="redirectPageRequest",n}();n.IFrameBootstrapperValues=u;f=function(){function n(){}return n.IframeEventListenerError="IframeEventListenerError",n.AuthClientMethodException="AuthClientMethodException",n.StartChatMethodException="StartChatMethodException",n.CloseChatMethodException="CloseChatMethodException",n.StartProactiveChatMethodException="StartProactiveChatMethodException",n.SetContextProviderMethodException="SetContextProviderMethodException",n.SetAuthProviderMethodException="SetAuthProviderMethodException",n.RemoveContextProviderMethodException="RemoveContextProviderMethodException",n.RemoveAuthTokenProviderMethodException="RemoveAuthTokenProviderMethodException",n.GetAgentAvailability="GetAgentAvailability",n}();n.BootstrapperTelemetryConstants=f,function(n){n.INFO="INFO";n.DEBUG="DEBUG";n.WARN="WARN";n.ERROR="ERROR"}(o=n.BootstrapperLogLevel||(n.BootstrapperLogLevel={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(t){var i;(function(t){var i=function(){function i(n){t.Loader.webChat=window[t.Constants.WebChat];t.Loader.react=window[t.Constants.React];this.config=n}return i.prototype.createWebChat=function(n){return __awaiter(this,void 0,void 0,function(){var i,r,u;return __generator(this,function(f){switch(f.label){case 0:return(i=t.BrowserInfo.isIe(),!i)?[3,2]:(r=this.onAppend,u=[document.head],[4,this.bootstrapChat.bind(this,n)]);case 1:return r.apply(this,u.concat([f.sent()])),this.getPolyfills(),[3,4];case 2:return[4,this.bootstrapChat(n)];case 3:f.sent();f.label=4;case 4:return[2]}})})},i.prototype.onAppend=function(n,i){var r=new MutationObserver(function(n){n.forEach(function(n){if(n.addedNodes[0].attributes[0].nodeValue.indexOf(t.Constants.WebChatIEPolyfillsScript)>-1)var r=setInterval(function(){String.prototype.includes&&(clearInterval(r),i())},200)})});r.observe(n,{childList:!0})},i.prototype.generatePolyfillsURL=function(){return t.Constants.WebChatIEPolyfillsScriptFullPath},i.prototype.bootstrapChat=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.createContainer(),this.initializeStyleSet(),this.createRuntimeStyle(),this.initMiddlewares(),this.initStores(),[4,n.initChatAdapter()];case 1:return t.sent(),this.renderWebChat(),[2]}})})},i.prototype.getPolyfills=function(){var t=document.createElement("script");t.setAttribute(n.Omnichannel.LiveChatWidget.BootstrapperConstants.SRC,this.generatePolyfillsURL());document.head.appendChild(t)},i.prototype.createContainer=function(){var i=document.getElementById(t.HtmlIdNames.webChatRoot),n=document.createElement(t.Constants.HTMLConstants.div);n.id=t.HtmlIdNames.webChatRootDiv;i.appendChild(n)},i.prototype.createRuntimeStyle=function(){var n,i;try{document&&(n=document.createElement(t.HtmlAttributeNames.style),n&&(n.innerHTML=t.Bootstrapper.enableAutofill?this.getReceivedMessageStyle().concat(this.getSuggestedActionStyle()).concat(this.getBubbleWidthStyle()):this.getReceivedMessageStyle().concat(this.getSuggestedActionStyle()),n.setAttribute(t.HtmlAttributeNames.type,t.HtmlAttributeNames.csstext),i=document.getElementsByTagName(t.HtmlAttributeNames.head),i&&i[0]&&i[0].appendChild(n)))}catch(r){console.error("Failed to attach runtime styling: ",r)}},i.prototype.getReceivedMessageStyle=function(){var n=t.Util.isNullOrEmptyString(t.ConfigurationManager.WebChatStyles.receivedMesageBackground)?t.Bootstrapper.lcConfig.bubbleColor:t.ConfigurationManager.WebChatStyles.receivedMesageBackground,i=t.Util.isNullOrEmptyString(t.ConfigurationManager.WebChatStyles.receivedMesageTextColor)?this.defaultWebChatStyleOptionsParams.receivedMesageTextColor:t.ConfigurationManager.WebChatStyles.receivedMesageTextColor;return".ms_lcw_webchat_received_message>div.webchat__stacked-layout>div.webchat__stacked-layout__main>div.webchat__stacked-layout__content>div.webchat__stacked-layout__message-row>[class^=webchat]:not(.webchat__bubble--from-user)>.webchat__bubble__content{color:"+i+";background-color:"+n+"}"},i.prototype.getSuggestedActionStyle=function(){return t.Bootstrapper.suggestedActionLayout==="stacked"?"#web-chat-root-div>div>div[role=form][class^=css]>div[role=status]>div[class^=css]>div[class^=css]>button{border-color:"+t.Bootstrapper.lcConfig.bubbleColor+";color:"+t.Bootstrapper.lcConfig.bubbleColor+"}":"#web-chat-root-div>div>div[role=form][class^=css]>div[role=status]>div[class^=css]>div[class^=css]>div[class^=css]>ul>li>div>button{border-color:"+t.Bootstrapper.lcConfig.bubbleColor+";color:"+t.Bootstrapper.lcConfig.bubbleColor+"}"},i.prototype.getBubbleWidthStyle=function(){return".webchat__stacked-layout > div.webchat__stacked-layout__main > div.webchat__stacked-layout__content div.webchat__bubble{max-width:85%}"},i.prototype.initializeStyleSet=function(n){n===void 0&&(n=!1);this.defaultWebChatStyleOptionsParams={backgroundColor:"#F7F7F9",receivedMesageBackground:this.config.bubbleColor,bubbleBackground:"White",bubbleBorderRadius:4,bubbleBorderWidth:0,bubbleFromUserBackground:t.HtmlCssConstants.webChatUserBubbleDefaultColor,bubbleFromUserBorderRadius:4,bubbleFromUserBorderWidth:1,bubbleFromUserTextColor:"Black",bubbleImageHeight:240,bubbleMaxWidth:250,bubbleMinHeight:34,bubbleMinWidth:20,receivedMesageTextColor:"White",bubbleTextColor:"Black",sendBoxMaxHeight:96,typingAnimationDuration:3500,sendBoxBackground:"White",hideUploadButton:!this.config.canUploadFile,hideSendBox:n,sendBoxTextWrap:!0,botAvatarBackgroundColor:"#2266E3",botAvatarInitials:"CU",avatarSize:"auto",showAvatarInGroup:!0};t.Bootstrapper.suggestedActionLayout&&(this.defaultWebChatStyleOptionsParams.suggestedActionLayout=t.Bootstrapper.suggestedActionLayout,t.Bootstrapper.suggestedActionLayout==="stacked"&&(this.defaultWebChatStyleOptionsParams.suggestedActionsStackedHeight=125,this.defaultWebChatStyleOptionsParams.suggestedActionsStackedOverflow="scroll"));this.styleOptions=t.ConfigurationManager.ShouldOverrideWebChatStyles?__assign({},this.defaultWebChatStyleOptionsParams,t.ConfigurationManager.WebChatStyles):this.defaultWebChatStyleOptionsParams},i.prototype.initMiddlewares=function(){this.activityMiddleware=t.createActivityMiddleware();this.activityStatusMiddleware=t.createActivityStatusMiddleware();this.attachmentMiddleware=t.createAttachmentMiddleware();this.avatarMiddleware=t.createAvatarMiddleware();this.groupActivityMiddleware=t.createGroupActivityMiddleware();this.typingIndicatorMiddleware=t.createTypingIndicatorMiddleware();this.webChatTelemetry=t.createWebChatTelemetry()},i.prototype.initStores=function(){var n=t.StoreFactory.getInstance();n.setWebChat(t.Loader.webChat);t.Loader.store=n.createWebChatStore()},i.createMarkdown=function(){t.Loader.MarkdownItForInline=window[t.Constants.MarkdownItForInline];t.Loader.MarkdownIt=new window[t.Constants.MarkdownIt](t.FeaturesManager.shouldEnableMarkdownMessageFormatting()?t.Constants.Default:t.Constants.Zero,{html:!0,linkify:!0,breaks:t.FeaturesManager.shouldEnableNewLineMarkdownSupport()||t.FeaturesManager.shouldEnableMarkdownMessageFormatting()});t.Loader.MarkdownIt.use(t.Loader.MarkdownItForInline,"url_new_win","link_open",function(n,i){var u=n[i].attrIndex(t.Constants.Target),r;~u?n[i].attrs[u][1]=t.Constants.Blank:n[i].attrPush([t.Constants.Target,t.Constants.Blank]);r=n[i].attrIndex(t.Constants.TargetRelationship);~r?n[i].attrs[r][1]=t.Constants.TargetRelationshipAttributes:n[i].attrPush([t.Constants.TargetRelationship,t.Constants.TargetRelationshipAttributes])});t.FeaturesManager.shouldEnableMarkdownMessageFormatting()?t.Loader.MarkdownIt.use(window[t.Constants.SlackMarkdownIt].default):t.Loader.MarkdownIt.enable(["entity","linkify","html_inline","newline"])},i.renderMarkDown=function(n){return t.Loader.MarkdownIt&&t.Loader.MarkdownItForInline||i.createMarkdown(),t.FeaturesManager.shouldEnableMarkdownMessageFormatting()?(n=t.MarkdownUtil.decodeHtmlCharacters(n),n=t.Loader.MarkdownIt.render(n)):n=t.Loader.MarkdownIt.renderInline(n),n.trim()},i.prototype.internetConnectionChangeHandler=function(){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){switch(i.label){case 0:return[4,t.ConnectivityManager.isInternetConnected()];case 1:return n=i.sent(),n?t.NotificationHandler.notifySuccess(t.NotificationScenarios.InternetConnection,t.Loader.Locale.BANNER_INTERNET_BACK_ONLINE):t.NotificationHandler.notifyError(t.NotificationScenarios.InternetConnection,t.Loader.Locale.BANNER_NO_INTERNET_CONNECTION),[2]}})})},i.prototype.rerenderWebChat=function(n){this.initializeStyleSet(n);this.renderWebChat()},i.prototype.handleSendButtonClick=function(n){t.WebChatControlsUtils.isMaxCharacterLimitExceed()&&n.stopImmediatePropagation()},i.prototype.handleKeyDownEvent=function(n){n.keyCode===t.Constants.KeyCodes.KEY_ENTER&&t.WebChatControlsUtils.isMaxCharacterLimitExceed()&&n.preventDefault()},i.prototype.changeLanguageCodeFormat=function(n){return n.slice(0,-2)+n.slice(-2).toUpperCase()},i.prototype.renderWebChat=function(){var n=this;t.Loader.webChat.renderWebChat({activityMiddleware:this.activityMiddleware,activityStatusMiddleware:this.activityStatusMiddleware,attachmentMiddleware:this.attachmentMiddleware,avatarMiddleware:this.avatarMiddleware,groupActivitiesMiddleware:this.groupActivityMiddleware,directLine:t.Loader.ChatAdapter,locale:this.changeLanguageCodeFormat(t.Loader.liveChatConfig.chatWidgetLocale),sendTypingIndicator:!0,styleOptions:this.styleOptions,store:t.Loader.store,renderMarkdown:i.renderMarkDown,typingIndicatorMiddleware:this.typingIndicatorMiddleware,username:t.Constants.CustomerDisplayName,userID:t.Loader.currentConversation.userId,onTelemetry:this.webChatTelemetry},document.getElementById(t.HtmlIdNames.webChatRootDiv));t.WebChatControlsUtils.addEventHandler("click",function(t){return n.handleSendButtonClick(t)},"."+t.HtmlClassNames.webChat,t.WebChatControlsUtils.getSendButtonSelector());t.WebChatControlsUtils.addEventHandler("keydown",function(t){return n.handleKeyDownEvent(t)},"."+t.HtmlClassNames.webChat,t.WebChatControlsUtils.getSendBoxSelector());window.addEventListener("online",function(){return n.internetConnectionChangeHandler()},!1);window.addEventListener("offline",function(){return n.internetConnectionChangeHandler()},!1)},i}();t.WebChat=i})(i=t.LiveChatWidget||(t.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.render=function(){var t=this.props.actionBarActive?n.HtmlClassNames.actionBarActive:n.HtmlClassNames.actionBarInactive,i=this.props.headerActive?n.HtmlClassNames.headerActive:n.HtmlClassNames.headerInactive;return React.createElement("div",{className:n.HtmlClassNames.webChat+" "+t+"-"+i,id:n.HtmlIdNames.webChatRoot,role:n.HtmlAttributeNames.region})},i}(React.Component);n.WebChatRoot=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t="([\\d,.]+)",i;n.UNKNOWN_VERSION="U";i=function(){function i(){}return i.userAgentContainsString=function(n){return this.userAgent.indexOf(n)>-1},i.isChrome=function(){return this.userAgentContainsString(n.BrowserVendor.CHROME)&&!this.userAgentContainsString(n.BrowserVendor.EDGE)&&!this.userAgentContainsString(n.BrowserVendor.EDGE_CHROMIUM)},i.isIe=function(){return this.userAgentContainsString("Trident")},i.isEdge=function(){return this.userAgentContainsString(n.BrowserVendor.EDGE)||this.userAgentContainsString(n.BrowserVendor.EDGE_CHROMIUM)},i.isChromiumEdge=function(){return this.userAgentContainsString(n.BrowserVendor.EDGE_CHROMIUM)&&!this.userAgentContainsString(n.BrowserVendor.EDGE)},i.isOpera=function(){return this.userAgentContainsString("OPR/")},i.getBrowserName=function(){return this.isOpera()?n.BrowserVendor.OPERA:this.isEdge()?n.BrowserVendor.EDGE:this.userAgentContainsString(n.BrowserVendor.CHROME)?n.BrowserVendor.CHROME:this.userAgentContainsString(n.BrowserVendor.FIREFOX)?n.BrowserVendor.FIREFOX:this.userAgentContainsString(n.BrowserVendor.SAFARI)?n.BrowserVendor.SAFARI:this.isIe()?n.BrowserVendor.IE:n.BrowserVendor.UNKNOWN},i.getUserAgent=function(){return this.userAgent},i.getBrowserVersion=function(){var i=this,r=function(){var r,u=i.getUserAgent(),f=u.match(new RegExp(n.BrowserVendor.IE+" "+t));return f?f[1]:(r=u.match(new RegExp("rv:"+t)),r)?r[1]:undefined},u=function(r){var u;return(r===n.BrowserVendor.SAFARI&&(r="Version"),u=i.getUserAgent().match(new RegExp(r+"/"+t)),u)?u[1]:n.UNKNOWN_VERSION};return this.isIe()?r():u(this.getBrowserName())},i.userAgent=window.navigator.userAgent,i}();n.BrowserInfo=i})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getDeviceType=function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?n.DeviceType.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?n.DeviceType.Tablet:n.DeviceType.Desktop},t}();n.DeviceInfo=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getLocationInfo=function(){return new Promise(function(i){var r,u;navigator.geolocation?(u=t.getLocation(),u.then(function(n){i(n)})):(console.error("Location is not supported"),r=new n.Location,r.latitude="",r.longitude="",i(r))})},t.getLocation=function(){return new Promise(function(t){function u(u){i.latitude=u.coords.latitude.toString();i.longitude=u.coords.longitude.toString();n.TelemetryClient.info({Event:n.TelemetryEvent.LocationDetectionSuccess,ElapsedTimeInMilliseconds:r.milliSecondsElapsed});t(i)}function f(u){i.latitude="";i.longitude="";n.TelemetryClient.info({Event:n.TelemetryEvent.LocationDetectionFailed,ElapsedTimeInMilliseconds:r.milliSecondsElapsed,ExceptionDetails:u});t(i)}var i=new n.Location,r=n.Util.timer();navigator.geolocation.getCurrentPosition(u,f)})},t.requestLocationDetection=function(){return n.Loader.liveChatConfig.requestVisitorLocation},t}();n.LocationInfo=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getOsType=function(){var t=window.navigator.userAgent;return t.match(/windows\sphone\s\d+\.\d+/i)?n.OperatingSystem.WINDOWS_PHONE:t.match(/ arm;/i)?n.OperatingSystem.WINDOWS_RT:t.match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?n.OperatingSystem.IOS:t.match(/android/i)?n.OperatingSystem.ANDROID:t.match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?n.OperatingSystem.LINUX:t.match(/(macintosh|mac os x)/i)?n.OperatingSystem.MACOSX:t.match(/(windows|win32)/i)?n.OperatingSystem.WINDOWS:n.OperatingSystem.UNKNOWN},t}();n.OSInfo=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.shouldRenderWelcomeWidget=function(){return n.Loader.currentConversation&&n.Loader.currentConversation.sessionInitErrorCode===n.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour},t.isSurveyValid=function(t){return t&&t.body?t.body.some(function(t){if(t.type&&t.type.indexOf(n.HtmlAttributeNames.input)==0)return!0}):!1},t.isValidSurveyScript=function(t){var i,r,u;return t&&(i=document.createElement(n.Constants.HTMLConstants.div),i.innerHTML=t,r=i.getElementsByTagName(n.BootstrapperConstants.Script),u=i.getElementsByTagName(n.BootstrapperConstants.Link),!n.Util.isNullOrUndefined(r)&&!n.Util.isNullOrUndefined(u)&&r.length>0&&u.length>0)?!0:!1},t.validateIfSessionInitIsStartedOrComplete=function(t){return!n.Util.isNullOrUndefined(t)&&t.sessionInitState!==n.SessionInitState.SessionInitNotStarted&&t.portalContactId===n.Loader.initContext.portalcontactid},t.focusOnElement=function(n){var t=document.getElementById(n);!t||t.focus()},t.emptyWebChatRoot=function(){$j("#"+n.HtmlIdNames.webChatRoot).empty()},t.getTimestampHourMinute=function(n){var u,i,t=new Date(n),r=new Date;return isNaN(t.getTime())?"":(t.getFullYear()!==r.getFullYear()&&(u="numeric",i="2-digit"),(t.getMonth()!==r.getMonth()||t.getDate()!==r.getDate())&&(i="2-digit"),t.toLocaleTimeString(navigator.language,{year:u,month:i,day:i,hour:"numeric",minute:"2-digit"}))},t.setBubbleColorFromTimestamp=function(t,i){var u,r;if(!n.Util.isNullOrUndefined(t))for(u=t.getElementsByTagName("*"),r=0;r<u.length;r++)if(u[r].className===n.HtmlClassNames.webChatBubbleContent){u[r].style.backgroundColor=i;break}},t.addScrollToPreChatDropdown=function(t){var i=document.getElementsByClassName(t)[0];n.Util.isNullOrUndefined(i)||(i.setAttribute(n.Constants.HTMLConstants.selectOnMouseDown,"if(this.options.length>"+n.Constants.HTMLConstants.preChatMaxDropdownSize+"){this.size="+n.Constants.HTMLConstants.preChatMaxDropdownSize+";}"),i.setAttribute(n.Constants.HTMLConstants.selectOnChange,"this.size=0;"),i.setAttribute(n.Constants.HTMLConstants.selectOnBlur,"this.size=0;"))},t.addElementsForCheckBoxInput=function(t){var r,i;return t&&(r=t.getAllInputs(),r&&r.length>0&&(i=r[0],i&&i.title&&i.title.startsWith(n.HtmlEscapeCharacters.asterisk)&&i.renderedElement&&i.renderedElement.firstElementChild))?(i.renderedElement.firstElementChild.setAttribute(n.HtmlAttributeNames.ariaLabel,i.title.replace(n.HtmlEscapeCharacters.asterisk,"*")),i.renderedElement.firstElementChild.setAttribute(n.HtmlAttributeNames.ariaRequired,n.HtmlAttributeNames.true),!0):!1},t.preventFocusToMoveOutOfElement=function(t){var r=document.getElementById(t);if(r!=null){var i=Array.prototype.slice.call(r.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')),u=i[0],f=i[i.length-1];u.onkeydown=function(t){t.shiftKey&&t.keyCode===n.Constants.KeyCodes.KEY_TAB&&(t.preventDefault(),f.focus())};f.onkeydown=function(t){t.keyCode!==n.Constants.KeyCodes.KEY_TAB||t.shiftKey||(t.preventDefault(),u.focus())}}},t.getIconText=function(n){if(n){var t=n.split(/\s/).reduce(function(n,t){return n+t.slice(0,1)},"");return t.length>1?t.substring(0,2).toUpperCase():n.substring(0,2).toUpperCase()}return""},t.getGUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})},t.getAriaAttributes=function(n){var t={};return Object.keys(n).filter(function(n){return/(^aria-\w+$|^role$)/.test(n)}).forEach(function(i){t[i]=n[i]}),t},t.changeTitle=function(t){n.Util.raiseCustomEvent(n.LCWEvents.LCWChangeTitle,t)},t.playAudioNotifications=function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWPlayAudioNotification)},t.decodeUtf8EncodedString=function(n){for(var i=atob(n),r=new Uint8Array(i.length),t=0;t<i.length;t++)r[t]=i.charCodeAt(t);return new TextDecoder("utf-8").decode(r)},t.escapeHtml=function(n){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(n).replace(/[<>"'\/]/g,function(n){return t[n]})},t.getChatButtonStyle=function(t){return n.Bootstrapper.renderOnMobileDevice?{backgroundColor:t,border:"1px solid "+t}:{}},t.getChatIconSource=function(t){return n.Bootstrapper.renderOnMobileDevice?n.ScriptPaths.InAppChatIconPath:t},t.isHistoryMessage=function(t){return t.channelData.tags&&t.channelData.tags.includes(n.Constants.HistoryMessageTag)},t.isFromList=function(n){return n.channelData.fromList},t.isSystemMessage=function(t){return t.channelData.tags&&t.channelData.tags.includes(n.Constants.SystemMessageTag)},t.getHtmlClassNameForUnreadMessages=function(t){return t>n.Constants.UnreadMessagesNotificationConstants.maxValue?n.HtmlClassNames.unreadMessagesNotificationBubbleTruncated:n.HtmlClassNames.unreadMessagesNotificationBubble},t.getUnreadMessagesCount=function(t,i){return t>n.Constants.UnreadMessagesNotificationConstants.maxValue?i:t},t.getQueueAvailabilityErrorResponse=function(n,t){return{ErrorMessage:n,Details:t}},t}();n.Utility=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.getAlertHeaderMessage=function(t){var i;switch(t){case n.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour:i=n.Bootstrapper.LiveChatConfiguration.outsideOperatingHoursTitle||n.Loader.Locale.WIDGET_USE_OUTSIDE_BUSINESS_HOUR_ERROR_TITLE||"Were currently offline."}return i},t.getAlertSubHeaderMessage=function(t){var i;switch(t){case n.OmnichannelErrorCodes.WidgetUseOutsideOperatingHour:i=n.Bootstrapper.LiveChatConfiguration.outsideOperatingHoursSubtitle||n.Loader.Locale.WIDGET_USE_OUTSIDE_BUSINESS_HOUR_ERROR_SUB_TITLE||"Please try again during our business hours."}return i},t}();n.AlertMessages=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n.Message="message";n.Typing="typing";n.Event="event"})(t=n.AdapterActivityType||(n.AdapterActivityType={}))})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={}));
/* LiveChatLoader.min.js:end */


/* LiveChatClientSdk.min.js:start */
var Microsoft;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(){}return n.SDKNamespace="Microsoft.Omnichannel.LiveChatWidget",n.SDK="SDK",n.setContextProvider="setContextProvider",n.getContextProvider="getContextProvider",n.removeContextProvider="removeContextProvider",n.setAuthTokenProvider="setAuthTokenProvider",n.getAuthTokenProvider="getAuthTokenProvider",n.removeAuthTokenProvider="removeAuthTokenProvider",n.startChat="startChat",n.startPopoutChat="startPopoutChat",n.closeChat="closeChat",n.startProactiveChat="startProactiveChat",n.portalContactInfoNamespace="Microsoft.Dynamic365.Portal.User",n.LogTelemetry="logTelemetry",n.getContactInfoResponse="getContactInfoResponse",n.getAgentAvailability="getAgentAvailability",n.customContextLimit=100,n}();n.SDKConstants=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))})(Microsoft||(Microsoft={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){this.initializeSdkObject()}return t.prototype.getContextProvider=function(){return n.TelemetryClient.info({Event:n.TelemetryEvent.GetContextProviderSDKCall}),n.Loader.contextProvider},t.prototype.setContextProvider=function(t){var r,i;if(n.Loader.liveChatConfig.authClientFunction!==undefined&&console.warn("Use of custom context with authenticated chat is deprecated. The chat might not go through."),n.TelemetryClient.info({Event:n.TelemetryEvent.SetContextProviderSDKCall}),typeof t!="function"){i=new Error("Context provider should be a function");n.TelemetryClient.error({Event:n.TelemetryEvent.ContextProviderException,ExceptionDetails:i});throw i;}if(t&&Object.keys(t()).length>n.SDKConstants.customContextLimit){r=Object.keys(t()).length;i=new Error("Tried to set "+r+" custom contexts which exceeds the limit. The current limit is "+n.SDKConstants.customContextLimit+".");n.TelemetryClient.error({Event:n.TelemetryEvent.ContextProviderException,ExceptionDetails:i});n.LCWErrorTypes.raiseErrorEvent(n.LCWErrorCode.LCW_CONTEXTPROVIDER_METHOD_FAIL,i);throw i;}n.Loader.contextProvider=t},t.prototype.removeContextProvider=function(){n.TelemetryClient.info({Event:n.TelemetryEvent.RemoveContextProviderSDKCall});n.Loader.contextProvider=null},t.prototype.getAuthTokenProvider=function(){return n.TelemetryClient.info({Event:n.TelemetryEvent.GetAuthTokenProviderSDKCall}),n.Loader.authTokenProvider},t.prototype.setAuthTokenProvider=function(t){if(n.TelemetryClient.info({Event:n.TelemetryEvent.SetAuthTokenProviderSDKCall}),typeof t!="function"){var i=new Error("Auth token provider should be a function");n.TelemetryClient.error({Event:n.TelemetryEvent.AuthClientProviderException,ExceptionDetails:i});throw i;}n.Loader.authTokenProvider=t},t.prototype.removeAuthTokenProvider=function(){n.TelemetryClient.info({Event:n.TelemetryEvent.RemoveAuthTokenProviderSDKCall});n.Loader.authTokenProvider=null},t.prototype.startChat=function(t){n.TelemetryClient.info({Event:n.TelemetryEvent.StartChatSDKCall});(!t||n.Util.isNullOrUndefined(t.inNewWindow))&&(t={inNewWindow:null});n.ChatRootReact.handleChatButtonClick(t.inNewWindow,!0);this.raiseLcwStartChatEvent()},t.prototype.closeChat=function(){n.TelemetryClient.info({Event:n.TelemetryEvent.EndChatSDKCall});n.ChatRootReact.closeSession();this.raiseLcwCloseChatEvent()},t.prototype.startProactiveChat=function(t,i,r){if(!n.Loader.liveChatConfig.isProactiveChatEnabled){var u=new Error("Proactive chat is not enabled for the widget");n.TelemetryClient.error({Event:n.TelemetryEvent.ProactiveChatNotEnabled,ExceptionDetails:u});throw u;}n.TelemetryClient.info({Event:n.TelemetryEvent.StartProactiveChatSDKCall});n.ChatRootReact.startProactiveChat(i,r,t,!0)},t.prototype.getAgentAvailability=function(){var t=this;n.Loader.getAgentAvailability().then(function(n){t.raiseGetQueueAvailabilityFinishedEvent(n)}).catch(function(n){t.raiseGetQueueAvailabilityFinishedEvent(n)})},t.prototype.initializeSdkObject=function(){t.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK]=this;this.raiseLcwReadyEvent()},t.createSdkNameSpaceObject=function(n,t){var u,i,f,e,r;if(n&&(u=n.split("."),u))for(i=0,f=u;i<f.length;i++)e=f[i],r=e.trim(),t[r]=t[r]||{},t=t[r];return t},t.prototype.raiseGetQueueAvailabilityFinishedEvent=function(t){var i=this;n.Util.isNullOrUndefined(n.Loader.loaderPromise)?setTimeout(function(){return i.raiseGetQueueAvailabilityFinishedEvent()},n.ConfigurationManager.LoaderPromiseStateCheckInterval):n.Loader.loaderPromise.then(function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWOnGetQueueAvailabilityEvent,t)})},t.prototype.raiseLcwReadyEvent=function(){var t=this;n.Util.isNullOrUndefined(n.Loader.loaderPromise)?setTimeout(function(){return t.raiseLcwReadyEvent()},n.ConfigurationManager.LoaderPromiseStateCheckInterval):n.Loader.loaderPromise.then(function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWReadyEvent)})},t.prototype.raiseLcwStartChatEvent=function(){var t=this;n.Util.isNullOrUndefined(n.Loader.loaderPromise)?setTimeout(function(){return t.raiseLcwStartChatEvent()},n.ConfigurationManager.LoaderPromiseStateCheckInterval):n.Loader.loaderPromise.then(function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWStartChatEvent)})},t.prototype.raiseLcwCloseChatEvent=function(){var t=this;n.Util.isNullOrUndefined(n.Loader.loaderPromise)?setTimeout(function(){return t.raiseLcwCloseChatEvent()},n.ConfigurationManager.LoaderPromiseStateCheckInterval):n.Loader.loaderPromise.then(function(){n.Util.raiseCustomEvent(n.LCWEvents.LCWCloseChatEvent)})},t}();n.ClientSdk=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(){new Microsoft.Omnichannel.LiveChatWidget.ClientSdk}("docReady",window),function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.createEventDelegation=function(){var i=this;window.addEventListener("message",function(r){var u,f,e,o,s,h;if(r.data)try{u=r.data;f=u.messageName;switch(f){case n.SDKConstants.setContextProvider:e=u.contextVariables;o=function(){return e};n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].setContextProvider(o);break;case n.SDKConstants.removeContextProvider:n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].removeContextProvider();break;case n.SDKConstants.setAuthTokenProvider:i.authTokenCache=u.jwtToken;s=function(n){n(t.authTokenCache)};n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].setAuthTokenProvider(s);break;case n.SDKConstants.removeAuthTokenProvider:n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].removeAuthTokenProvider();i.authTokenCache&&(i.authTokenCache=undefined);break;case n.SDKConstants.startChat:n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].startChat(u);break;case n.SDKConstants.closeChat:n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].closeChat();break;case n.SDKConstants.getAgentAvailability:n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].getAgentAvailability();break;case n.SDKConstants.startProactiveChat:var c=u.notificationConfig,l=u.enablePreChat,a=u.inNewWindow;n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.SDKNamespace,window)[n.SDKConstants.SDK].startProactiveChat(c,l,a);break;case n.SDKConstants.getContactInfoResponse:h=u.contactInfo;n.ClientSdk.createSdkNameSpaceObject(n.SDKConstants.portalContactInfoNamespace,window);window[n.BootstrapperConstants.Microsoft][n.BootstrapperConstants.Dynamic365][n.BootstrapperConstants.Portal][n.BootstrapperConstants.User]=h;break;case n.SDKConstants.LogTelemetry:n.TelemetryClient.log(u.logLevel,{event:u.event,exceptionDetails:u.exceptionDetails})}}catch(v){console.error("Failed to process message from parent:",v)}})},t}();n.ClientSdkEventHandler=t})(t=n.LiveChatWidget||(n.LiveChatWidget={}))})(t=n.Omnichannel||(n.Omnichannel={}))}(Microsoft||(Microsoft={})),function(){Microsoft.Omnichannel.LiveChatWidget.ClientSdkEventHandler.createEventDelegation()}();
/* LiveChatClientSdk.min.js:end */


